"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.REMOTE_CACHE_ROOT = void 0;
require("source-map-support/register");
var _helpers = require("../helpers.js");
var _teen_process = require("teen_process");
var _logger = _interopRequireDefault(require("../logger.js"));
var _path = _interopRequireDefault(require("path"));
var _lodash = _interopRequireDefault(require("lodash"));
var _asyncbox = require("asyncbox");
var _support = require("@appium/support");
var _semver = _interopRequireDefault(require("semver"));
var _os = _interopRequireDefault(require("os"));
var _lruCache = _interopRequireDefault(require("lru-cache"));
var _adbkitApkreader = _interopRequireDefault(require("adbkit-apkreader"));
const apkUtilsMethods = {};
apkUtilsMethods.APP_INSTALL_STATE = {
  UNKNOWN: 'unknown',
  NOT_INSTALLED: 'notInstalled',
  NEWER_VERSION_INSTALLED: 'newerVersionInstalled',
  SAME_VERSION_INSTALLED: 'sameVersionInstalled',
  OLDER_VERSION_INSTALLED: 'olderVersionInstalled'
};
const REMOTE_CACHE_ROOT = '/data/local/tmp/appium_cache';
exports.REMOTE_CACHE_ROOT = REMOTE_CACHE_ROOT;
const RESOLVER_ACTIVITY_NAME = 'android/com.android.internal.app.ResolverActivity';
apkUtilsMethods.isAppInstalled = async function isAppInstalled(pkg) {
  _logger.default.debug(`Getting install status for ${pkg}`);
  const installedPattern = new RegExp(`^\\s*Package\\s+\\[${_lodash.default.escapeRegExp(pkg)}\\][^:]+:$`, 'm');
  try {
    const stdout = await this.shell(['dumpsys', 'package', pkg]);
    const isInstalled = installedPattern.test(stdout);
    _logger.default.debug(`'${pkg}' is${!isInstalled ? ' not' : ''} installed`);
    return isInstalled;
  } catch (e) {
    throw new Error(`Error finding if '${pkg}' is installed. Original error: ${e.message}`);
  }
};
apkUtilsMethods.startUri = async function startUri(uri, pkg, opts = {}) {
  const {
    waitForLaunch = true
  } = opts;
  if (!uri || !pkg) {
    throw new Error('URI and package arguments are required');
  }
  const args = ['am', 'start'];
  if (waitForLaunch) {
    args.push('-W');
  }
  args.push('-a', 'android.intent.action.VIEW', '-d', (0, _helpers.escapeShellArg)(uri), pkg);
  try {
    const res = await this.shell(args);
    if (res.toLowerCase().includes('unable to resolve intent')) {
      throw new Error(res);
    }
  } catch (e) {
    throw new Error(`Error attempting to start URI. Original error: ${e}`);
  }
};
apkUtilsMethods.startApp = async function startApp(startAppOptions = {}) {
  if (!startAppOptions.pkg || !(startAppOptions.activity || startAppOptions.action)) {
    throw new Error('pkg, and activity or intent action, are required to start an application');
  }
  startAppOptions = _lodash.default.clone(startAppOptions);
  if (startAppOptions.activity) {
    startAppOptions.activity = startAppOptions.activity.replace('$', '\\$');
  }
  _lodash.default.defaults(startAppOptions, {
    waitPkg: startAppOptions.pkg,
    waitForLaunch: true,
    waitActivity: false,
    retry: true,
    stopApp: true
  });
  startAppOptions.waitPkg = startAppOptions.waitPkg || startAppOptions.pkg;
  const apiLevel = await this.getApiLevel();
  const cmd = (0, _helpers.buildStartCmd)(startAppOptions, apiLevel);
  const intentName = `${startAppOptions.action}${startAppOptions.optionalIntentArguments ? ' ' + startAppOptions.optionalIntentArguments : ''}`;
  try {
    const shellOpts = {};
    if (_lodash.default.isInteger(startAppOptions.waitDuration) && startAppOptions.waitDuration >= 0) {
      shellOpts.timeout = startAppOptions.waitDuration;
    }
    const stdout = await this.shell(cmd, shellOpts);
    if (stdout.includes('Error: Activity class') && stdout.includes('does not exist')) {
      if (startAppOptions.retry && !startAppOptions.activity.startsWith('.')) {
        _logger.default.debug(`We tried to start an activity that doesn't exist, ` + `retrying with '.${startAppOptions.activity}' activity name`);
        startAppOptions.activity = `.${startAppOptions.activity}`;
        startAppOptions.retry = false;
        return await this.startApp(startAppOptions);
      }
      throw new Error(`Activity name '${startAppOptions.activity}' used to start the app doesn't ` + `exist or cannot be launched! Make sure it exists and is a launchable activity`);
    } else if (stdout.includes('Error: Intent does not match any activities') || stdout.includes('Error: Activity not started, unable to resolve Intent')) {
      throw new Error(`Activity for intent '${intentName}' used to start the app doesn't ` + `exist or cannot be launched! Make sure it exists and is a launchable activity`);
    } else if (stdout.includes('java.lang.SecurityException')) {
      throw new Error(`The permission to start '${startAppOptions.activity}' activity has been denied.` + `Make sure the activity/package names are correct.`);
    }
    if (startAppOptions.waitActivity) {
      await this.waitForActivity(startAppOptions.waitPkg, startAppOptions.waitActivity, startAppOptions.waitDuration);
    }
    return stdout;
  } catch (e) {
    const appDescriptor = startAppOptions.pkg || intentName;
    throw new Error(`Cannot start the '${appDescriptor}' application. ` + `Consider checking the driver's troubleshooting documentation. ` + `Original error: ${e.message}`);
  }
};
apkUtilsMethods.dumpWindows = async function dumpWindows() {
  const apiLevel = await this.getApiLevel();
  const dumpsysArg = apiLevel >= 29 ? 'displays' : 'windows';
  const cmd = ['dumpsys', 'window', dumpsysArg];
  return await this.shell(cmd);
};
apkUtilsMethods.getFocusedPackageAndActivity = async function getFocusedPackageAndActivity() {
  _logger.default.debug('Getting focused package and activity');
  let stdout;
  try {
    stdout = await this.dumpWindows();
  } catch (e) {
    throw new Error(`Could not retrieve the currently focused package and activity. Original error: ${e.message}`);
  }
  const nullFocusedAppRe = /^\s*mFocusedApp=null/m;
  const focusedAppRe = new RegExp('^\\s*mFocusedApp.+Record\\{.*\\s([^\\s\\/\\}]+)\\/([^\\s\\/\\}\\,]+)\\,?(\\s[^\\s\\/\\}]+)*\\}', 'mg');
  const nullCurrentFocusRe = /^\s*mCurrentFocus=null/m;
  const currentFocusAppRe = new RegExp('^\\s*mCurrentFocus.+\\{.+\\s([^\\s\\/]+)\\/([^\\s]+)\\b', 'mg');
  const focusedAppCandidates = [];
  const currentFocusAppCandidates = [];
  for (const [candidates, pattern] of [[focusedAppCandidates, focusedAppRe], [currentFocusAppCandidates, currentFocusAppRe]]) {
    let match;
    while (match = pattern.exec(stdout)) {
      candidates.push({
        appPackage: match[1].trim(),
        appActivity: match[2].trim()
      });
    }
  }
  if (focusedAppCandidates.length > 1 && currentFocusAppCandidates.length > 0) {
    return _lodash.default.intersectionWith(focusedAppCandidates, currentFocusAppCandidates, _lodash.default.isEqual)[0] ?? focusedAppCandidates[0];
  }
  if (focusedAppCandidates.length > 0 || currentFocusAppCandidates.length > 0) {
    return focusedAppCandidates[0] ?? currentFocusAppCandidates[0];
  }
  for (const pattern of [nullFocusedAppRe, nullCurrentFocusRe]) {
    if (pattern.exec(stdout)) {
      return {
        appPackage: null,
        appActivity: null
      };
    }
  }
  _logger.default.debug(stdout);
  throw new Error('Could not retrieve the currently focused package and activity');
};
apkUtilsMethods.waitForActivityOrNot = async function waitForActivityOrNot(pkg, activity, waitForStop, waitMs = 20000) {
  if (!pkg || !activity) {
    throw new Error('Package and activity required.');
  }
  _logger.default.debug(`Waiting up to ${waitMs}ms for activity matching pkg: '${pkg}' and ` + `activity: '${activity}' to${waitForStop ? ' not' : ''} be focused`);
  const splitNames = names => names.split(',').map(name => name.trim());
  const allPackages = splitNames(pkg);
  const allActivities = splitNames(activity);
  const possibleActivityNames = [];
  for (const oneActivity of allActivities) {
    if (oneActivity.startsWith('.')) {
      for (const currentPkg of allPackages) {
        possibleActivityNames.push(`${currentPkg}${oneActivity}`.replace(/\.+/g, '.'));
      }
    } else {
      possibleActivityNames.push(oneActivity);
      possibleActivityNames.push(`${pkg}.${oneActivity}`);
    }
  }
  _logger.default.debug(`Possible activities, to be checked: ${possibleActivityNames.map(name => `'${name}'`).join(', ')}`);
  const possibleActivityPatterns = possibleActivityNames.map(actName => new RegExp(`^${actName.replace(/\./g, '\\.').replace(/\*/g, '.*?').replace(/\$/g, '\\$')}$`));
  const conditionFunc = async () => {
    let appPackage;
    let appActivity;
    try {
      ({
        appPackage,
        appActivity
      } = await this.getFocusedPackageAndActivity());
    } catch (e) {
      _logger.default.debug(e.message);
      return false;
    }
    if (appActivity && appPackage) {
      const fullyQualifiedActivity = appActivity.startsWith('.') ? `${appPackage}${appActivity}` : appActivity;
      _logger.default.debug(`Found package: '${appPackage}' and fully qualified activity name : '${fullyQualifiedActivity}'`);
      const isActivityFound = _lodash.default.includes(allPackages, appPackage) && possibleActivityPatterns.some(p => p.test(fullyQualifiedActivity));
      if (!waitForStop && isActivityFound || waitForStop && !isActivityFound) {
        return true;
      }
    }
    _logger.default.debug('Incorrect package and activity. Retrying.');
    return false;
  };
  try {
    await (0, _asyncbox.waitForCondition)(conditionFunc, {
      waitMs: parseInt(waitMs, 10),
      intervalMs: 500
    });
  } catch (e) {
    throw new Error(`${possibleActivityNames.map(name => `'${name}'`).join(' or ')} never ${waitForStop ? 'stopped' : 'started'}. ` + `Consider checking the driver's troubleshooting documentation.`);
  }
};
apkUtilsMethods.waitForActivity = async function waitForActivity(pkg, act, waitMs = 20000) {
  await this.waitForActivityOrNot(pkg, act, false, waitMs);
};
apkUtilsMethods.waitForNotActivity = async function waitForNotActivity(pkg, act, waitMs = 20000) {
  await this.waitForActivityOrNot(pkg, act, true, waitMs);
};
apkUtilsMethods.uninstallApk = async function uninstallApk(pkg, options = {}) {
  _logger.default.debug(`Uninstalling ${pkg}`);
  if (!(await this.isAppInstalled(pkg))) {
    _logger.default.info(`${pkg} was not uninstalled, because it was not present on the device`);
    return false;
  }
  const cmd = ['uninstall'];
  if (options.keepData) {
    cmd.push('-k');
  }
  cmd.push(pkg);
  let stdout;
  try {
    await this.forceStop(pkg);
    stdout = (await this.adbExec(cmd, {
      timeout: options.timeout
    })).trim();
  } catch (e) {
    throw new Error(`Unable to uninstall APK. Original error: ${e.message}`);
  }
  _logger.default.debug(`'adb ${cmd.join(' ')}' command output: ${stdout}`);
  if (stdout.includes('Success')) {
    _logger.default.info(`${pkg} was successfully uninstalled`);
    return true;
  }
  _logger.default.info(`${pkg} was not uninstalled`);
  return false;
};
apkUtilsMethods.installFromDevicePath = async function installFromDevicePath(apkPathOnDevice, opts = {}) {
  let stdout = await this.shell(['pm', 'install', '-r', apkPathOnDevice], opts);
  if (stdout.indexOf('Failure') !== -1) {
    throw new Error(`Remote install failed: ${stdout}`);
  }
};
apkUtilsMethods.cacheApk = async function cacheApk(apkPath, options = {}) {
  const appHash = await _support.fs.hash(apkPath);
  const remotePath = _path.default.posix.join(REMOTE_CACHE_ROOT, `${appHash}.apk`);
  const remoteCachedFiles = [];
  try {
    const errorMarker = '_ERROR_';
    let lsOutput = null;
    if (this._areExtendedLsOptionsSupported === true || !_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
      lsOutput = await this.shell([`ls -t -1 ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
    }
    if (!_lodash.default.isString(lsOutput) || lsOutput.includes(errorMarker) && !lsOutput.includes(REMOTE_CACHE_ROOT)) {
      if (!_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
        _logger.default.debug('The current Android API does not support extended ls options. ' + 'Defaulting to no-options call');
      }
      lsOutput = await this.shell([`ls ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
      this._areExtendedLsOptionsSupported = false;
    } else {
      this._areExtendedLsOptionsSupported = true;
    }
    if (lsOutput.includes(errorMarker)) {
      throw new Error(lsOutput.substring(0, lsOutput.indexOf(errorMarker)));
    }
    remoteCachedFiles.push(...lsOutput.split('\n').map(x => x.trim()).filter(Boolean));
  } catch (e) {
    _logger.default.debug(`Got an error '${e.message.trim()}' while getting the list of files in the cache. ` + `Assuming the cache does not exist yet`);
    await this.shell(['mkdir', '-p', REMOTE_CACHE_ROOT]);
  }
  _logger.default.debug(`The count of applications in the cache: ${remoteCachedFiles.length}`);
  const toHash = remotePath => _path.default.posix.parse(remotePath).name;
  if (remoteCachedFiles.some(x => toHash(x) === appHash)) {
    _logger.default.info(`The application at '${apkPath}' is already cached to '${remotePath}'`);
    this.shell(['touch', '-am', remotePath]).catch(() => {});
  } else {
    _logger.default.info(`Caching the application at '${apkPath}' to '${remotePath}'`);
    const timer = new _support.timing.Timer().start();
    await this.push(apkPath, remotePath, {
      timeout: options.timeout
    });
    const {
      size
    } = await _support.fs.stat(apkPath);
    _logger.default.info(`The upload of '${_path.default.basename(apkPath)}' (${_support.util.toReadableSizeString(size)}) ` + `took ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);
  }
  if (!this.remoteAppsCache) {
    this.remoteAppsCache = new _lruCache.default({
      max: this.remoteAppsCacheLimit
    });
  }
  _lodash.default.difference([...this.remoteAppsCache.keys()], remoteCachedFiles.map(toHash)).forEach(hash => this.remoteAppsCache.del(hash));
  this.remoteAppsCache.set(appHash, remotePath);
  const entriesToCleanup = remoteCachedFiles.map(x => _path.default.posix.join(REMOTE_CACHE_ROOT, x)).filter(x => !this.remoteAppsCache.has(toHash(x))).slice(this.remoteAppsCacheLimit - [...this.remoteAppsCache.keys()].length);
  if (!_lodash.default.isEmpty(entriesToCleanup)) {
    try {
      await this.shell(['rm', '-f', ...entriesToCleanup]);
      _logger.default.debug(`Deleted ${entriesToCleanup.length} expired application cache entries`);
    } catch (e) {
      _logger.default.warn(`Cannot delete ${entriesToCleanup.length} expired application cache entries. ` + `Original error: ${e.message}`);
    }
  }
  return remotePath;
};
apkUtilsMethods.install = async function install(appPath, options = {}) {
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    return await this.installApks(appPath, options);
  }
  options = _lodash.default.cloneDeep(options);
  _lodash.default.defaults(options, {
    replace: true,
    timeout: this.adbExecTimeout === _helpers.DEFAULT_ADB_EXEC_TIMEOUT ? _helpers.APK_INSTALL_TIMEOUT : this.adbExecTimeout,
    timeoutCapName: 'androidInstallTimeout'
  });
  const installArgs = (0, _helpers.buildInstallArgs)(await this.getApiLevel(), options);
  if (options.noIncremental && (await this.isIncrementalInstallSupported())) {
    installArgs.push('--no-incremental');
  }
  const installOpts = {
    timeout: options.timeout,
    timeoutCapName: options.timeoutCapName
  };
  const installCmd = ['install', ...installArgs, appPath];
  let performAppInstall = async () => await this.adbExec(installCmd, installOpts);
  let shouldCacheApp = this.remoteAppsCacheLimit > 0;
  if (shouldCacheApp) {
    shouldCacheApp = !(await this.isStreamedInstallSupported());
    if (!shouldCacheApp) {
      _logger.default.info(`The application at '${appPath}' will not be cached, because the device under test has ` + `confirmed the support of streamed installs`);
    }
  }
  if (shouldCacheApp) {
    const clearCache = async () => {
      _logger.default.info(`Clearing the cache at '${REMOTE_CACHE_ROOT}'`);
      await this.shell(['rm', '-rf', `${REMOTE_CACHE_ROOT}/*`]);
    };
    const cacheApp = async () => await this.cacheApk(appPath, {
      timeout: options.timeout
    });
    try {
      const cachedAppPath = await cacheApp();
      performAppInstall = async () => {
        const pmInstallCmdByRemotePath = remotePath => ['pm', 'install', ...installArgs, remotePath];
        const output = await this.shell(pmInstallCmdByRemotePath(cachedAppPath), installOpts);
        if (/\bINSTALL_FAILED_INSUFFICIENT_STORAGE\b/.test(output)) {
          _logger.default.warn(`There was a failure while installing '${appPath}' ` + `because of the insufficient device storage space`);
          await clearCache();
          _logger.default.info(`Consider decreasing the maximum amount of cached apps ` + `(currently ${this.remoteAppsCacheLimit}) to avoid such issues in the future`);
          const newCachedAppPath = await cacheApp();
          return await this.shell(pmInstallCmdByRemotePath(newCachedAppPath), installOpts);
        }
        return output;
      };
    } catch (e) {
      _logger.default.debug(e);
      _logger.default.warn(`There was a failure while caching '${appPath}': ${e.message}`);
      _logger.default.warn('Falling back to the default installation procedure');
      await clearCache();
    }
  }
  try {
    const timer = new _support.timing.Timer().start();
    const output = await performAppInstall();
    _logger.default.info(`The installation of '${_path.default.basename(appPath)}' took ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);
    const truncatedOutput = !_lodash.default.isString(output) || output.length <= 300 ? output : `${output.substr(0, 150)}...${output.substr(output.length - 150)}`;
    _logger.default.debug(`Install command stdout: ${truncatedOutput}`);
    if (/\[INSTALL[A-Z_]+FAILED[A-Z_]+\]/.test(output)) {
      if (this.isTestPackageOnlyError(output)) {
        const msg = `Set 'allowTestPackages' capability to true in order to allow test packages installation.`;
        _logger.default.warn(msg);
        throw new Error(`${output}\n${msg}`);
      }
      throw new Error(output);
    }
  } catch (err) {
    if (!err.message.includes('INSTALL_FAILED_ALREADY_EXISTS')) {
      throw err;
    }
    _logger.default.debug(`Application '${appPath}' already installed. Continuing.`);
  }
};
apkUtilsMethods.getApplicationInstallState = async function getApplicationInstallState(appPath, pkg = null) {
  let apkInfo = null;
  if (!pkg) {
    apkInfo = await this.getApkInfo(appPath);
    pkg = apkInfo.name;
  }
  if (!pkg) {
    _logger.default.warn(`Cannot read the package name of '${appPath}'`);
    return this.APP_INSTALL_STATE.UNKNOWN;
  }
  if (!(await this.isAppInstalled(pkg))) {
    _logger.default.debug(`App '${appPath}' is not installed`);
    return this.APP_INSTALL_STATE.NOT_INSTALLED;
  }
  const {
    versionCode: pkgVersionCode,
    versionName: pkgVersionNameStr
  } = await this.getPackageInfo(pkg);
  const pkgVersionName = _semver.default.valid(_semver.default.coerce(pkgVersionNameStr));
  if (!apkInfo) {
    apkInfo = await this.getApkInfo(appPath);
  }
  const {
    versionCode: apkVersionCode,
    versionName: apkVersionNameStr
  } = apkInfo;
  const apkVersionName = _semver.default.valid(_semver.default.coerce(apkVersionNameStr));
  if (!_lodash.default.isInteger(apkVersionCode) || !_lodash.default.isInteger(pkgVersionCode)) {
    _logger.default.warn(`Cannot read version codes of '${appPath}' and/or '${pkg}'`);
    if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
      _logger.default.warn(`Cannot read version names of '${appPath}' and/or '${pkg}'`);
      return this.APP_INSTALL_STATE.UNKNOWN;
    }
  }
  if (_lodash.default.isInteger(apkVersionCode) && _lodash.default.isInteger(pkgVersionCode)) {
    if (pkgVersionCode > apkVersionCode) {
      _logger.default.debug(`The version code of the installed '${pkg}' is greater than the application version code (${pkgVersionCode} > ${apkVersionCode})`);
      return this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED;
    }
    if (pkgVersionCode === apkVersionCode) {
      if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
        _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);
        return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
      }
      if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
        _logger.default.debug(`The version name of the installed '${pkg}' is equal to application version name (${pkgVersionCode} === ${apkVersionCode})`);
        return this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
      }
    }
  } else if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
    _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);
    return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
  }
  _logger.default.debug(`The installed '${pkg}' package is older than '${appPath}' (${pkgVersionCode} < ${apkVersionCode} or '${pkgVersionName}' < '${apkVersionName}')'`);
  return this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED;
};
apkUtilsMethods.installOrUpgrade = async function installOrUpgrade(appPath, pkg = null, options = {}) {
  if (!pkg) {
    const apkInfo = await this.getApkInfo(appPath);
    pkg = apkInfo.name;
  }
  const {
    enforceCurrentBuild
  } = options;
  const appState = await this.getApplicationInstallState(appPath, pkg);
  let wasUninstalled = false;
  const uninstallPackage = async () => {
    if (!(await this.uninstallApk(pkg))) {
      throw new Error(`'${pkg}' package cannot be uninstalled`);
    }
    wasUninstalled = true;
  };
  switch (appState) {
    case this.APP_INSTALL_STATE.NOT_INSTALLED:
      _logger.default.debug(`Installing '${appPath}'`);
      await this.install(appPath, Object.assign({}, options, {
        replace: false
      }));
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED:
      if (enforceCurrentBuild) {
        _logger.default.info(`Downgrading '${pkg}' as requested`);
        await uninstallPackage();
        break;
      }
      _logger.default.debug(`There is no need to downgrade '${pkg}'`);
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED:
      if (enforceCurrentBuild) {
        break;
      }
      _logger.default.debug(`There is no need to install/upgrade '${appPath}'`);
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED:
      _logger.default.debug(`Executing upgrade of '${appPath}'`);
      break;
    default:
      _logger.default.debug(`The current install state of '${appPath}' is unknown. Installing anyway`);
      break;
  }
  try {
    await this.install(appPath, Object.assign({}, options, {
      replace: true
    }));
  } catch (err) {
    _logger.default.warn(`Cannot install/upgrade '${pkg}' because of '${err.message}'. Trying full reinstall`);
    await uninstallPackage();
    await this.install(appPath, Object.assign({}, options, {
      replace: false
    }));
  }
  return {
    appState,
    wasUninstalled
  };
};
apkUtilsMethods.extractStringsFromApk = async function extractStringsFromApk(appPath, language, out) {
  _logger.default.debug(`Extracting strings from for language: ${language || 'default'}`);
  const originalAppPath = appPath;
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractLanguageApk(appPath, language);
  }
  let apkStrings = {};
  let configMarker;
  try {
    await this.initAapt();
    configMarker = await (0, _helpers.formatConfigMarker)(async () => {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt, ['d', 'configurations', appPath]);
      return _lodash.default.uniq(stdout.split(_os.default.EOL));
    }, language, '(default)');
    const {
      stdout
    } = await (0, _teen_process.exec)(this.binaries.aapt, ['d', '--values', 'resources', appPath]);
    apkStrings = (0, _helpers.parseAaptStrings)(stdout, configMarker);
  } catch (e) {
    _logger.default.debug('Cannot extract resources using aapt. Trying aapt2. ' + `Original error: ${e.stderr || e.message}`);
    await this.initAapt2();
    configMarker = await (0, _helpers.formatConfigMarker)(async () => {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt2, ['d', 'configurations', appPath]);
      return _lodash.default.uniq(stdout.split(_os.default.EOL));
    }, language, '');
    try {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt2, ['d', 'resources', appPath]);
      apkStrings = (0, _helpers.parseAapt2Strings)(stdout, configMarker);
    } catch (e) {
      throw new Error(`Cannot extract resources from '${originalAppPath}'. ` + `Original error: ${e.message}`);
    }
  }
  if (_lodash.default.isEmpty(apkStrings)) {
    _logger.default.warn(`No strings have been found in '${originalAppPath}' resources ` + `for '${configMarker || 'default'}' configuration`);
  } else {
    _logger.default.info(`Successfully extracted ${_lodash.default.keys(apkStrings).length} strings from ` + `'${originalAppPath}' resources for '${configMarker || 'default'}' configuration`);
  }
  const localPath = _path.default.resolve(out, 'strings.json');
  await (0, _support.mkdirp)(out);
  await _support.fs.writeFile(localPath, JSON.stringify(apkStrings, null, 2), 'utf-8');
  return {
    apkStrings,
    localPath
  };
};
apkUtilsMethods.getDeviceLanguage = async function getDeviceLanguage() {
  let language;
  if ((await this.getApiLevel()) < 23) {
    language = await this.getDeviceSysLanguage();
    if (!language) {
      language = await this.getDeviceProductLanguage();
    }
  } else {
    language = (await this.getDeviceLocale()).split('-')[0];
  }
  return language;
};
apkUtilsMethods.getDeviceCountry = async function getDeviceCountry() {
  let country = await this.getDeviceSysCountry();
  if (!country) {
    country = await this.getDeviceProductCountry();
  }
  return country;
};
apkUtilsMethods.getDeviceLocale = async function getDeviceLocale() {
  let locale = await this.getDeviceSysLocale();
  if (!locale) {
    locale = await this.getDeviceProductLocale();
  }
  return locale;
};
apkUtilsMethods.setDeviceLocale = async function setDeviceLocale(locale) {
  const validateLocale = new RegExp(/[a-zA-Z]+-[a-zA-Z0-9]+/);
  if (!validateLocale.test(locale)) {
    _logger.default.warn(`setDeviceLocale requires the following format: en-US or ja-JP`);
    return;
  }
  let split_locale = locale.split('-');
  await this.setDeviceLanguageCountry(split_locale[0], split_locale[1]);
};
apkUtilsMethods.ensureCurrentLocale = async function ensureCurrentLocale(language, country, script = null) {
  const hasLanguage = _lodash.default.isString(language);
  const hasCountry = _lodash.default.isString(country);
  if (!hasLanguage && !hasCountry) {
    _logger.default.warn('ensureCurrentLocale requires language or country');
    return false;
  }
  language = (language || '').toLowerCase();
  country = (country || '').toLowerCase();
  const apiLevel = await this.getApiLevel();
  return await (0, _asyncbox.retryInterval)(5, 1000, async () => {
    try {
      if (apiLevel < 23) {
        let curLanguage, curCountry;
        if (hasLanguage) {
          curLanguage = (await this.getDeviceLanguage()).toLowerCase();
          if (!hasCountry && language === curLanguage) {
            return true;
          }
        }
        if (hasCountry) {
          curCountry = (await this.getDeviceCountry()).toLowerCase();
          if (!hasLanguage && country === curCountry) {
            return true;
          }
        }
        if (language === curLanguage && country === curCountry) {
          return true;
        }
      } else {
        const curLocale = (await this.getDeviceLocale()).toLowerCase();
        const localeCode = script ? `${language}-${script.toLowerCase()}-${country}` : `${language}-${country}`;
        if (localeCode === curLocale) {
          _logger.default.debug(`Requested locale is equal to current locale: '${curLocale}'`);
          return true;
        }
      }
      return false;
    } catch (err) {
      _logger.default.error(`Unable to check device localization: ${err.message}`);
      try {
        await this.reconnect();
      } catch (ign) {
        await this.restartAdb();
      }
      throw err;
    }
  });
};
apkUtilsMethods.setDeviceLanguageCountry = async function setDeviceLanguageCountry(language, country, script = null) {
  let hasLanguage = language && _lodash.default.isString(language);
  let hasCountry = country && _lodash.default.isString(country);
  if (!hasLanguage || !hasCountry) {
    _logger.default.warn(`setDeviceLanguageCountry requires language and country at least`);
    _logger.default.warn(`Got language: '${language}' and country: '${country}'`);
    return;
  }
  let apiLevel = await this.getApiLevel();
  language = (language || '').toLowerCase();
  country = (country || '').toUpperCase();
  if (apiLevel < 23) {
    let curLanguage = (await this.getDeviceLanguage()).toLowerCase();
    let curCountry = (await this.getDeviceCountry()).toUpperCase();
    if (language !== curLanguage || country !== curCountry) {
      await this.setDeviceSysLocaleViaSettingApp(language, country);
    }
  } else {
    let curLocale = await this.getDeviceLocale();
    const localeCode = script ? `${language}-${script}-${country}` : `${language}-${country}`;
    _logger.default.debug(`Current locale: '${curLocale}'; requested locale: '${localeCode}'`);
    if (localeCode.toLowerCase() !== curLocale.toLowerCase()) {
      await this.setDeviceSysLocaleViaSettingApp(language, country, script);
    }
  }
};
apkUtilsMethods.getApkInfo = async function getApkInfo(appPath) {
  if (!(await _support.fs.exists(appPath))) {
    throw new Error(`The file at path ${appPath} does not exist or is not accessible`);
  }
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractBaseApk(appPath);
  }
  try {
    const apkReader = await _adbkitApkreader.default.open(appPath);
    const manifest = await apkReader.readManifest();
    const {
      pkg,
      versionName,
      versionCode
    } = (0, _helpers.parseManifest)(manifest);
    return {
      name: pkg,
      versionCode,
      versionName
    };
  } catch (e) {
    _logger.default.warn(`Error '${e.message}' while getting badging info`);
  }
  return {};
};
apkUtilsMethods.getPackageInfo = async function getPackageInfo(pkg) {
  _logger.default.debug(`Getting package info for '${pkg}'`);
  let result = {
    name: pkg
  };
  try {
    const stdout = await this.shell(['dumpsys', 'package', pkg]);
    const versionNameMatch = new RegExp(/versionName=([\d+.]+)/).exec(stdout);
    if (versionNameMatch) {
      result.versionName = versionNameMatch[1];
    }
    const versionCodeMatch = new RegExp(/versionCode=(\d+)/).exec(stdout);
    if (versionCodeMatch) {
      result.versionCode = parseInt(versionCodeMatch[1], 10);
    }
    return result;
  } catch (err) {
    _logger.default.warn(`Error '${err.message}' while dumping package info`);
  }
  return result;
};
apkUtilsMethods.pullApk = async function pullApk(pkg, tmpDir) {
  const stdout = _lodash.default.trim(await this.shell(['pm', 'path', pkg]));
  const packageMarker = 'package:';
  if (!_lodash.default.startsWith(stdout, packageMarker)) {
    throw new Error(`Cannot pull the .apk package for '${pkg}'. Original error: ${stdout}`);
  }
  const remotePath = stdout.replace(packageMarker, '');
  const tmpApp = _path.default.resolve(tmpDir, `${pkg}.apk`);
  await this.pull(remotePath, tmpApp);
  _logger.default.debug(`Pulled app for package '${pkg}' to '${tmpApp}'`);
  return tmpApp;
};
apkUtilsMethods.activateApp = async function activateApp(appId) {
  _logger.default.debug(`Activating '${appId}'`);
  const apiLevel = await this.getApiLevel();
  if (apiLevel < 24) {
    const cmd = ['monkey', '-p', appId, '-c', 'android.intent.category.LAUNCHER', '1'];
    let output = '';
    try {
      output = await this.shell(cmd);
      _logger.default.debug(`Command stdout: ${output}`);
    } catch (e) {
      _logger.default.errorAndThrow(`Cannot activate '${appId}'. Original error: ${e.message}`);
    }
    if (output.includes('monkey aborted')) {
      _logger.default.errorAndThrow(`Cannot activate '${appId}'. Are you sure it is installed?`);
    }
    return;
  }
  let activityName = await this.resolveLaunchableActivity(appId);
  if (activityName === RESOLVER_ACTIVITY_NAME) {
    _logger.default.debug(`The launchable activity name of '${appId}' was resolved to '${activityName}'. ` + `Switching the resolver to not use cmd`);
    activityName = await this.resolveLaunchableActivity(appId, {
      preferCmd: false
    });
  }
  const stdout = await this.shell(['am', apiLevel < 26 ? 'start' : 'start-activity', '-a', 'android.intent.action.MAIN', '-c', 'android.intent.category.LAUNCHER', '-f', '0x10200000', '-n', activityName]);
  _logger.default.debug(stdout);
  if (/^error:/mi.test(stdout)) {
    throw new Error(`Cannot activate '${appId}'. Original error: ${stdout}`);
  }
};
var _default = apkUtilsMethods;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJhcGtVdGlsc01ldGhvZHMiLCJBUFBfSU5TVEFMTF9TVEFURSIsIlVOS05PV04iLCJOT1RfSU5TVEFMTEVEIiwiTkVXRVJfVkVSU0lPTl9JTlNUQUxMRUQiLCJTQU1FX1ZFUlNJT05fSU5TVEFMTEVEIiwiT0xERVJfVkVSU0lPTl9JTlNUQUxMRUQiLCJSRU1PVEVfQ0FDSEVfUk9PVCIsIlJFU09MVkVSX0FDVElWSVRZX05BTUUiLCJpc0FwcEluc3RhbGxlZCIsInBrZyIsImxvZyIsImRlYnVnIiwiaW5zdGFsbGVkUGF0dGVybiIsIlJlZ0V4cCIsIl8iLCJlc2NhcGVSZWdFeHAiLCJzdGRvdXQiLCJzaGVsbCIsImlzSW5zdGFsbGVkIiwidGVzdCIsImUiLCJFcnJvciIsIm1lc3NhZ2UiLCJzdGFydFVyaSIsInVyaSIsIm9wdHMiLCJ3YWl0Rm9yTGF1bmNoIiwiYXJncyIsInB1c2giLCJlc2NhcGVTaGVsbEFyZyIsInJlcyIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJzdGFydEFwcCIsInN0YXJ0QXBwT3B0aW9ucyIsImFjdGl2aXR5IiwiYWN0aW9uIiwiY2xvbmUiLCJyZXBsYWNlIiwiZGVmYXVsdHMiLCJ3YWl0UGtnIiwid2FpdEFjdGl2aXR5IiwicmV0cnkiLCJzdG9wQXBwIiwiYXBpTGV2ZWwiLCJnZXRBcGlMZXZlbCIsImNtZCIsImJ1aWxkU3RhcnRDbWQiLCJpbnRlbnROYW1lIiwib3B0aW9uYWxJbnRlbnRBcmd1bWVudHMiLCJzaGVsbE9wdHMiLCJpc0ludGVnZXIiLCJ3YWl0RHVyYXRpb24iLCJ0aW1lb3V0Iiwic3RhcnRzV2l0aCIsIndhaXRGb3JBY3Rpdml0eSIsImFwcERlc2NyaXB0b3IiLCJkdW1wV2luZG93cyIsImR1bXBzeXNBcmciLCJnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5IiwibnVsbEZvY3VzZWRBcHBSZSIsImZvY3VzZWRBcHBSZSIsIm51bGxDdXJyZW50Rm9jdXNSZSIsImN1cnJlbnRGb2N1c0FwcFJlIiwiZm9jdXNlZEFwcENhbmRpZGF0ZXMiLCJjdXJyZW50Rm9jdXNBcHBDYW5kaWRhdGVzIiwiY2FuZGlkYXRlcyIsInBhdHRlcm4iLCJtYXRjaCIsImV4ZWMiLCJhcHBQYWNrYWdlIiwidHJpbSIsImFwcEFjdGl2aXR5IiwibGVuZ3RoIiwiaW50ZXJzZWN0aW9uV2l0aCIsImlzRXF1YWwiLCJ3YWl0Rm9yQWN0aXZpdHlPck5vdCIsIndhaXRGb3JTdG9wIiwid2FpdE1zIiwic3BsaXROYW1lcyIsIm5hbWVzIiwic3BsaXQiLCJtYXAiLCJuYW1lIiwiYWxsUGFja2FnZXMiLCJhbGxBY3Rpdml0aWVzIiwicG9zc2libGVBY3Rpdml0eU5hbWVzIiwib25lQWN0aXZpdHkiLCJjdXJyZW50UGtnIiwiam9pbiIsInBvc3NpYmxlQWN0aXZpdHlQYXR0ZXJucyIsImFjdE5hbWUiLCJjb25kaXRpb25GdW5jIiwiZnVsbHlRdWFsaWZpZWRBY3Rpdml0eSIsImlzQWN0aXZpdHlGb3VuZCIsInNvbWUiLCJwIiwid2FpdEZvckNvbmRpdGlvbiIsInBhcnNlSW50IiwiaW50ZXJ2YWxNcyIsImFjdCIsIndhaXRGb3JOb3RBY3Rpdml0eSIsInVuaW5zdGFsbEFwayIsIm9wdGlvbnMiLCJpbmZvIiwia2VlcERhdGEiLCJmb3JjZVN0b3AiLCJhZGJFeGVjIiwiaW5zdGFsbEZyb21EZXZpY2VQYXRoIiwiYXBrUGF0aE9uRGV2aWNlIiwiaW5kZXhPZiIsImNhY2hlQXBrIiwiYXBrUGF0aCIsImFwcEhhc2giLCJmcyIsImhhc2giLCJyZW1vdGVQYXRoIiwicGF0aCIsInBvc2l4IiwicmVtb3RlQ2FjaGVkRmlsZXMiLCJlcnJvck1hcmtlciIsImxzT3V0cHV0IiwiX2FyZUV4dGVuZGVkTHNPcHRpb25zU3VwcG9ydGVkIiwiaXNCb29sZWFuIiwiaXNTdHJpbmciLCJzdWJzdHJpbmciLCJ4IiwiZmlsdGVyIiwiQm9vbGVhbiIsInRvSGFzaCIsInBhcnNlIiwiY2F0Y2giLCJ0aW1lciIsInRpbWluZyIsIlRpbWVyIiwic3RhcnQiLCJzaXplIiwic3RhdCIsImJhc2VuYW1lIiwidXRpbCIsInRvUmVhZGFibGVTaXplU3RyaW5nIiwiZ2V0RHVyYXRpb24iLCJhc01pbGxpU2Vjb25kcyIsInRvRml4ZWQiLCJyZW1vdGVBcHBzQ2FjaGUiLCJMUlUiLCJtYXgiLCJyZW1vdGVBcHBzQ2FjaGVMaW1pdCIsImRpZmZlcmVuY2UiLCJrZXlzIiwiZm9yRWFjaCIsImRlbCIsInNldCIsImVudHJpZXNUb0NsZWFudXAiLCJoYXMiLCJzbGljZSIsImlzRW1wdHkiLCJ3YXJuIiwiaW5zdGFsbCIsImFwcFBhdGgiLCJlbmRzV2l0aCIsIkFQS1NfRVhURU5TSU9OIiwiaW5zdGFsbEFwa3MiLCJjbG9uZURlZXAiLCJhZGJFeGVjVGltZW91dCIsIkRFRkFVTFRfQURCX0VYRUNfVElNRU9VVCIsIkFQS19JTlNUQUxMX1RJTUVPVVQiLCJ0aW1lb3V0Q2FwTmFtZSIsImluc3RhbGxBcmdzIiwiYnVpbGRJbnN0YWxsQXJncyIsIm5vSW5jcmVtZW50YWwiLCJpc0luY3JlbWVudGFsSW5zdGFsbFN1cHBvcnRlZCIsImluc3RhbGxPcHRzIiwiaW5zdGFsbENtZCIsInBlcmZvcm1BcHBJbnN0YWxsIiwic2hvdWxkQ2FjaGVBcHAiLCJpc1N0cmVhbWVkSW5zdGFsbFN1cHBvcnRlZCIsImNsZWFyQ2FjaGUiLCJjYWNoZUFwcCIsImNhY2hlZEFwcFBhdGgiLCJwbUluc3RhbGxDbWRCeVJlbW90ZVBhdGgiLCJvdXRwdXQiLCJuZXdDYWNoZWRBcHBQYXRoIiwidHJ1bmNhdGVkT3V0cHV0Iiwic3Vic3RyIiwiaXNUZXN0UGFja2FnZU9ubHlFcnJvciIsIm1zZyIsImVyciIsImdldEFwcGxpY2F0aW9uSW5zdGFsbFN0YXRlIiwiYXBrSW5mbyIsImdldEFwa0luZm8iLCJ2ZXJzaW9uQ29kZSIsInBrZ1ZlcnNpb25Db2RlIiwidmVyc2lvbk5hbWUiLCJwa2dWZXJzaW9uTmFtZVN0ciIsImdldFBhY2thZ2VJbmZvIiwicGtnVmVyc2lvbk5hbWUiLCJzZW12ZXIiLCJ2YWxpZCIsImNvZXJjZSIsImFwa1ZlcnNpb25Db2RlIiwiYXBrVmVyc2lvbk5hbWVTdHIiLCJhcGtWZXJzaW9uTmFtZSIsInNhdGlzZmllcyIsImluc3RhbGxPclVwZ3JhZGUiLCJlbmZvcmNlQ3VycmVudEJ1aWxkIiwiYXBwU3RhdGUiLCJ3YXNVbmluc3RhbGxlZCIsInVuaW5zdGFsbFBhY2thZ2UiLCJPYmplY3QiLCJhc3NpZ24iLCJleHRyYWN0U3RyaW5nc0Zyb21BcGsiLCJsYW5ndWFnZSIsIm91dCIsIm9yaWdpbmFsQXBwUGF0aCIsImV4dHJhY3RMYW5ndWFnZUFwayIsImFwa1N0cmluZ3MiLCJjb25maWdNYXJrZXIiLCJpbml0QWFwdCIsImZvcm1hdENvbmZpZ01hcmtlciIsImJpbmFyaWVzIiwiYWFwdCIsInVuaXEiLCJvcyIsIkVPTCIsInBhcnNlQWFwdFN0cmluZ3MiLCJzdGRlcnIiLCJpbml0QWFwdDIiLCJhYXB0MiIsInBhcnNlQWFwdDJTdHJpbmdzIiwibG9jYWxQYXRoIiwicmVzb2x2ZSIsIm1rZGlycCIsIndyaXRlRmlsZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJnZXREZXZpY2VMYW5ndWFnZSIsImdldERldmljZVN5c0xhbmd1YWdlIiwiZ2V0RGV2aWNlUHJvZHVjdExhbmd1YWdlIiwiZ2V0RGV2aWNlTG9jYWxlIiwiZ2V0RGV2aWNlQ291bnRyeSIsImNvdW50cnkiLCJnZXREZXZpY2VTeXNDb3VudHJ5IiwiZ2V0RGV2aWNlUHJvZHVjdENvdW50cnkiLCJsb2NhbGUiLCJnZXREZXZpY2VTeXNMb2NhbGUiLCJnZXREZXZpY2VQcm9kdWN0TG9jYWxlIiwic2V0RGV2aWNlTG9jYWxlIiwidmFsaWRhdGVMb2NhbGUiLCJzcGxpdF9sb2NhbGUiLCJzZXREZXZpY2VMYW5ndWFnZUNvdW50cnkiLCJlbnN1cmVDdXJyZW50TG9jYWxlIiwic2NyaXB0IiwiaGFzTGFuZ3VhZ2UiLCJoYXNDb3VudHJ5IiwicmV0cnlJbnRlcnZhbCIsImN1ckxhbmd1YWdlIiwiY3VyQ291bnRyeSIsImN1ckxvY2FsZSIsImxvY2FsZUNvZGUiLCJlcnJvciIsInJlY29ubmVjdCIsImlnbiIsInJlc3RhcnRBZGIiLCJ0b1VwcGVyQ2FzZSIsInNldERldmljZVN5c0xvY2FsZVZpYVNldHRpbmdBcHAiLCJleGlzdHMiLCJleHRyYWN0QmFzZUFwayIsImFwa1JlYWRlciIsIkFwa1JlYWRlciIsIm9wZW4iLCJtYW5pZmVzdCIsInJlYWRNYW5pZmVzdCIsInBhcnNlTWFuaWZlc3QiLCJyZXN1bHQiLCJ2ZXJzaW9uTmFtZU1hdGNoIiwidmVyc2lvbkNvZGVNYXRjaCIsInB1bGxBcGsiLCJ0bXBEaXIiLCJwYWNrYWdlTWFya2VyIiwidG1wQXBwIiwicHVsbCIsImFjdGl2YXRlQXBwIiwiYXBwSWQiLCJlcnJvckFuZFRocm93IiwiYWN0aXZpdHlOYW1lIiwicmVzb2x2ZUxhdW5jaGFibGVBY3Rpdml0eSIsInByZWZlckNtZCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi90b29scy9hcGstdXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgYnVpbGRTdGFydENtZCwgQVBLU19FWFRFTlNJT04sIGJ1aWxkSW5zdGFsbEFyZ3MsXG4gIEFQS19JTlNUQUxMX1RJTUVPVVQsIERFRkFVTFRfQURCX0VYRUNfVElNRU9VVCxcbiAgcGFyc2VNYW5pZmVzdCwgcGFyc2VBYXB0U3RyaW5ncywgcGFyc2VBYXB0MlN0cmluZ3MsIGZvcm1hdENvbmZpZ01hcmtlcixcbiAgZXNjYXBlU2hlbGxBcmcsXG59IGZyb20gJy4uL2hlbHBlcnMuanMnO1xuaW1wb3J0IHsgZXhlYyB9IGZyb20gJ3RlZW5fcHJvY2Vzcyc7XG5pbXBvcnQgbG9nIGZyb20gJy4uL2xvZ2dlci5qcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyByZXRyeUludGVydmFsLCB3YWl0Rm9yQ29uZGl0aW9uIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IHsgZnMsIHV0aWwsIG1rZGlycCwgdGltaW5nIH0gZnJvbSAnQGFwcGl1bS9zdXBwb3J0JztcbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcbmltcG9ydCBvcyBmcm9tICdvcyc7XG5pbXBvcnQgTFJVIGZyb20gJ2xydS1jYWNoZSc7XG5pbXBvcnQgQXBrUmVhZGVyIGZyb20gJ2FkYmtpdC1hcGtyZWFkZXInO1xuXG5jb25zdCBhcGtVdGlsc01ldGhvZHMgPSB7fTtcblxuYXBrVXRpbHNNZXRob2RzLkFQUF9JTlNUQUxMX1NUQVRFID0ge1xuICBVTktOT1dOOiAndW5rbm93bicsXG4gIE5PVF9JTlNUQUxMRUQ6ICdub3RJbnN0YWxsZWQnLFxuICBORVdFUl9WRVJTSU9OX0lOU1RBTExFRDogJ25ld2VyVmVyc2lvbkluc3RhbGxlZCcsXG4gIFNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ6ICdzYW1lVmVyc2lvbkluc3RhbGxlZCcsXG4gIE9MREVSX1ZFUlNJT05fSU5TVEFMTEVEOiAnb2xkZXJWZXJzaW9uSW5zdGFsbGVkJyxcbn07XG5jb25zdCBSRU1PVEVfQ0FDSEVfUk9PVCA9ICcvZGF0YS9sb2NhbC90bXAvYXBwaXVtX2NhY2hlJztcbmNvbnN0IFJFU09MVkVSX0FDVElWSVRZX05BTUUgPSAnYW5kcm9pZC9jb20uYW5kcm9pZC5pbnRlcm5hbC5hcHAuUmVzb2x2ZXJBY3Rpdml0eSc7XG5cblxuLyoqXG4gKiBDaGVjayB3aGV0aGVyIHRoZSBwYXJ0aWN1bGFyIHBhY2thZ2UgaXMgcHJlc2VudCBvbiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIGNoZWNrLlxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgcGFja2FnZSBpcyBpbnN0YWxsZWQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGRldGVjdGluZyBhcHBsaWNhdGlvbiBzdGF0ZVxuICovXG5hcGtVdGlsc01ldGhvZHMuaXNBcHBJbnN0YWxsZWQgPSBhc3luYyBmdW5jdGlvbiBpc0FwcEluc3RhbGxlZCAocGtnKSB7XG4gIGxvZy5kZWJ1ZyhgR2V0dGluZyBpbnN0YWxsIHN0YXR1cyBmb3IgJHtwa2d9YCk7XG4gIGNvbnN0IGluc3RhbGxlZFBhdHRlcm4gPSBuZXcgUmVnRXhwKGBeXFxcXHMqUGFja2FnZVxcXFxzK1xcXFxbJHtfLmVzY2FwZVJlZ0V4cChwa2cpfVxcXFxdW146XSs6JGAsICdtJyk7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3Rkb3V0ID0gYXdhaXQgdGhpcy5zaGVsbChbJ2R1bXBzeXMnLCAncGFja2FnZScsIHBrZ10pO1xuICAgIGNvbnN0IGlzSW5zdGFsbGVkID0gaW5zdGFsbGVkUGF0dGVybi50ZXN0KHN0ZG91dCk7XG4gICAgbG9nLmRlYnVnKGAnJHtwa2d9JyBpcyR7IWlzSW5zdGFsbGVkID8gJyBub3QnIDogJyd9IGluc3RhbGxlZGApO1xuICAgIHJldHVybiBpc0luc3RhbGxlZDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZmluZGluZyBpZiAnJHtwa2d9JyBpcyBpbnN0YWxsZWQuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBTdGFydFVyaU9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IHdhaXRGb3JMYXVuY2ggW3RydWVdIC0gaWYgYGZhbHNlYCB0aGVuIGFkYiB3b24ndCB3YWl0XG4gKiBmb3IgdGhlIHN0YXJ0ZWQgYWN0aXZpdHkgdG8gcmV0dXJuIHRoZSBjb250cm9sXG4gKi9cblxuLyoqXG4gKiBTdGFydCB0aGUgcGFydGljdWxhciBVUkkgb24gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmkgLSBUaGUgbmFtZSBvZiBVUkkgdG8gc3RhcnQuXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gc3RhcnQgdGhlIFVSSSB3aXRoLlxuICogQHBhcmFtIHtTdGFydFVyaU9wdGlvbnN9IG9wdHNcbiAqL1xuYXBrVXRpbHNNZXRob2RzLnN0YXJ0VXJpID0gYXN5bmMgZnVuY3Rpb24gc3RhcnRVcmkgKHVyaSwgcGtnLCBvcHRzID0ge30pIHtcbiAgY29uc3Qge1xuICAgIHdhaXRGb3JMYXVuY2ggPSB0cnVlLFxuICB9ID0gb3B0cztcblxuICBpZiAoIXVyaSB8fCAhcGtnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVUkkgYW5kIHBhY2thZ2UgYXJndW1lbnRzIGFyZSByZXF1aXJlZCcpO1xuICB9XG5cbiAgY29uc3QgYXJncyA9IFsnYW0nLCAnc3RhcnQnXTtcbiAgaWYgKHdhaXRGb3JMYXVuY2gpIHtcbiAgICBhcmdzLnB1c2goJy1XJyk7XG4gIH1cbiAgYXJncy5wdXNoKCctYScsICdhbmRyb2lkLmludGVudC5hY3Rpb24uVklFVycsXG4gICAgJy1kJywgZXNjYXBlU2hlbGxBcmcodXJpKSxcbiAgICBwa2cpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zaGVsbChhcmdzKTtcbiAgICBpZiAocmVzLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3VuYWJsZSB0byByZXNvbHZlIGludGVudCcpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IocmVzKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGF0dGVtcHRpbmcgdG8gc3RhcnQgVVJJLiBPcmlnaW5hbCBlcnJvcjogJHtlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFN0YXJ0QXBwT3B0aW9uc1xuICogQHByb3BlcnR5IHshc3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgYXBwbGljYXRpb24gcGFja2FnZVxuICogQHByb3BlcnR5IHs/c3RyaW5nfSBhY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBtYWluIGFwcGxpY2F0aW9uIGFjdGl2aXR5LlxuICogVGhpcyBvciBhY3Rpb24gaXMgcmVxdWlyZWQgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBsYXVuY2ggYW4gYXBwLlxuICogQHByb3BlcnR5IHs/c3RyaW5nfSBhY3Rpb24gLSBUaGUgbmFtZSBvZiB0aGUgaW50ZW50IGFjdGlvbiB0aGF0IHdpbGwgbGF1bmNoIHRoZSByZXF1aXJlZCBhcHAuXG4gKiBUaGlzIG9yIGFjdGl2aXR5IGlzIHJlcXVpcmVkIGluIG9yZGVyIHRvIGJlIGFibGUgdG8gbGF1bmNoIGFuIGFwcC5cbiAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IHJldHJ5IFt0cnVlXSAtIElmIHRoaXMgcHJvcGVydHkgaXMgc2V0IHRvIGB0cnVlYFxuICogYW5kIHRoZSBhY3Rpdml0eSBuYW1lIGRvZXMgbm90IHN0YXJ0IHdpdGggJy4nIHRoZW4gdGhlIG1ldGhvZFxuICogd2lsbCB0cnkgdG8gYWRkIHRoZSBtaXNzaW5nIGRvdCBhbmQgc3RhcnQgdGhlIGFjdGl2aXR5IG9uY2UgbW9yZVxuICogaWYgdGhlIGZpcnN0IHN0YXJ0dXAgdHJ5IGZhaWxzLlxuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gc3RvcEFwcCBbdHJ1ZV0gLSBTZXQgaXQgdG8gYHRydWVgIGluIG9yZGVyIHRvIGZvcmNlZnVsbHlcbiAqIHN0b3AgdGhlIGFjdGl2aXR5IGlmIGl0IGlzIGFscmVhZHkgcnVubmluZy5cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gd2FpdFBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIHdhaXQgdG8gb25cbiAqIHN0YXJ0dXAgKHRoaXMgb25seSBtYWtlcyBzZW5zZSBpZiB0aGlzIG5hbWUgaXMgZGlmZmVyZW50IGZyb20gdGhlIG9uZSwgd2hpY2ggaXMgc2V0IGFzIGBwa2dgKVxuICogQHByb3BlcnR5IHs/c3RyaW5nfSB3YWl0QWN0aXZpdHkgLSBUaGUgbmFtZSBvZiB0aGUgYWN0aXZpdHkgdG8gd2FpdCB0byBvblxuICogc3RhcnR1cCAodGhpcyBvbmx5IG1ha2VzIHNlbnNlIGlmIHRoaXMgbmFtZSBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgb25lLCB3aGljaCBpcyBzZXQgYXMgYGFjdGl2aXR5YClcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gd2FpdER1cmF0aW9uIC0gVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCB0aGVcbiAqIGB3YWl0QWN0aXZpdHlgIGlzIGZvY3VzZWRcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ3xudW1iZXJ9IHVzZXIgLSBUaGUgbnVtYmVyIG9mIHRoZSB1c2VyIHByb2ZpbGUgdG8gc3RhcnRcbiAqIHRoZSBnaXZlbiBhY3Rpdml0eSB3aXRoLiBUaGUgZGVmYXVsdCBPUyB1c2VyIHByb2ZpbGUgKHVzdWFsbHkgemVybykgaXMgdXNlZFxuICogd2hlbiB0aGlzIHByb3BlcnR5IGlzIHVuc2V0XG4gKiBAcHJvcGVydHkgez9ib29sZWFufSB3YWl0Rm9yTGF1bmNoIFt0cnVlXSAtIGlmIGBmYWxzZWAgdGhlbiBhZGIgd29uJ3Qgd2FpdFxuICogZm9yIHRoZSBzdGFydGVkIGFjdGl2aXR5IHRvIHJldHVybiB0aGUgY29udHJvbFxuICovXG5cbi8qKlxuICogU3RhcnQgdGhlIHBhcnRpY3VsYXIgcGFja2FnZS9hY3Rpdml0eSBvbiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtTdGFydEFwcE9wdGlvbnN9IHN0YXJ0QXBwT3B0aW9ucyBbe31dIC0gU3RhcnR1cCBvcHRpb25zIG1hcHBpbmcuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBvdXRwdXQgb2YgdGhlIGNvcnJlc3BvbmRpbmcgYWRiIGNvbW1hbmQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgZXhlY3V0aW5nIHRoZSBhY3Rpdml0eVxuICovXG5hcGtVdGlsc01ldGhvZHMuc3RhcnRBcHAgPSBhc3luYyBmdW5jdGlvbiBzdGFydEFwcCAoc3RhcnRBcHBPcHRpb25zID0ge30pIHtcbiAgaWYgKCFzdGFydEFwcE9wdGlvbnMucGtnIHx8ICEoc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5IHx8IHN0YXJ0QXBwT3B0aW9ucy5hY3Rpb24pKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwa2csIGFuZCBhY3Rpdml0eSBvciBpbnRlbnQgYWN0aW9uLCBhcmUgcmVxdWlyZWQgdG8gc3RhcnQgYW4gYXBwbGljYXRpb24nKTtcbiAgfVxuXG4gIHN0YXJ0QXBwT3B0aW9ucyA9IF8uY2xvbmUoc3RhcnRBcHBPcHRpb25zKTtcbiAgaWYgKHN0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eSkge1xuICAgIHN0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eSA9IHN0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eS5yZXBsYWNlKCckJywgJ1xcXFwkJyk7XG4gIH1cbiAgLy8gaW5pdGlhbGl6aW5nIGRlZmF1bHRzXG4gIF8uZGVmYXVsdHMoc3RhcnRBcHBPcHRpb25zLCB7XG4gICAgd2FpdFBrZzogc3RhcnRBcHBPcHRpb25zLnBrZyxcbiAgICB3YWl0Rm9yTGF1bmNoOiB0cnVlLFxuICAgIHdhaXRBY3Rpdml0eTogZmFsc2UsXG4gICAgcmV0cnk6IHRydWUsXG4gICAgc3RvcEFwcDogdHJ1ZVxuICB9KTtcbiAgLy8gcHJldmVudGluZyBudWxsIHdhaXRwa2dcbiAgc3RhcnRBcHBPcHRpb25zLndhaXRQa2cgPSBzdGFydEFwcE9wdGlvbnMud2FpdFBrZyB8fCBzdGFydEFwcE9wdGlvbnMucGtnO1xuXG4gIGNvbnN0IGFwaUxldmVsID0gYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpO1xuICBjb25zdCBjbWQgPSBidWlsZFN0YXJ0Q21kKHN0YXJ0QXBwT3B0aW9ucywgYXBpTGV2ZWwpO1xuICBjb25zdCBpbnRlbnROYW1lID0gYCR7c3RhcnRBcHBPcHRpb25zLmFjdGlvbn0ke3N0YXJ0QXBwT3B0aW9ucy5vcHRpb25hbEludGVudEFyZ3VtZW50cyA/ICcgJyArIHN0YXJ0QXBwT3B0aW9ucy5vcHRpb25hbEludGVudEFyZ3VtZW50cyA6ICcnfWA7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2hlbGxPcHRzID0ge307XG4gICAgaWYgKF8uaXNJbnRlZ2VyKHN0YXJ0QXBwT3B0aW9ucy53YWl0RHVyYXRpb24pICYmIHN0YXJ0QXBwT3B0aW9ucy53YWl0RHVyYXRpb24gPj0gMCkge1xuICAgICAgc2hlbGxPcHRzLnRpbWVvdXQgPSBzdGFydEFwcE9wdGlvbnMud2FpdER1cmF0aW9uO1xuICAgIH1cbiAgICBjb25zdCBzdGRvdXQgPSBhd2FpdCB0aGlzLnNoZWxsKGNtZCwgc2hlbGxPcHRzKTtcbiAgICBpZiAoc3Rkb3V0LmluY2x1ZGVzKCdFcnJvcjogQWN0aXZpdHkgY2xhc3MnKSAmJiBzdGRvdXQuaW5jbHVkZXMoJ2RvZXMgbm90IGV4aXN0JykpIHtcbiAgICAgIGlmIChzdGFydEFwcE9wdGlvbnMucmV0cnkgJiYgIXN0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eS5zdGFydHNXaXRoKCcuJykpIHtcbiAgICAgICAgbG9nLmRlYnVnKGBXZSB0cmllZCB0byBzdGFydCBhbiBhY3Rpdml0eSB0aGF0IGRvZXNuJ3QgZXhpc3QsIGAgK1xuICAgICAgICAgICAgICAgICAgYHJldHJ5aW5nIHdpdGggJy4ke3N0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eX0nIGFjdGl2aXR5IG5hbWVgKTtcbiAgICAgICAgc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5ID0gYC4ke3N0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eX1gO1xuICAgICAgICBzdGFydEFwcE9wdGlvbnMucmV0cnkgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuc3RhcnRBcHAoc3RhcnRBcHBPcHRpb25zKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihgQWN0aXZpdHkgbmFtZSAnJHtzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHl9JyB1c2VkIHRvIHN0YXJ0IHRoZSBhcHAgZG9lc24ndCBgICtcbiAgICAgICAgICAgICAgICAgICAgICBgZXhpc3Qgb3IgY2Fubm90IGJlIGxhdW5jaGVkISBNYWtlIHN1cmUgaXQgZXhpc3RzIGFuZCBpcyBhIGxhdW5jaGFibGUgYWN0aXZpdHlgKTtcbiAgICB9IGVsc2UgaWYgKHN0ZG91dC5pbmNsdWRlcygnRXJyb3I6IEludGVudCBkb2VzIG5vdCBtYXRjaCBhbnkgYWN0aXZpdGllcycpIHx8IHN0ZG91dC5pbmNsdWRlcygnRXJyb3I6IEFjdGl2aXR5IG5vdCBzdGFydGVkLCB1bmFibGUgdG8gcmVzb2x2ZSBJbnRlbnQnKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY3Rpdml0eSBmb3IgaW50ZW50ICcke2ludGVudE5hbWV9JyB1c2VkIHRvIHN0YXJ0IHRoZSBhcHAgZG9lc24ndCBgICtcbiAgICAgICAgICAgICAgICAgICAgICBgZXhpc3Qgb3IgY2Fubm90IGJlIGxhdW5jaGVkISBNYWtlIHN1cmUgaXQgZXhpc3RzIGFuZCBpcyBhIGxhdW5jaGFibGUgYWN0aXZpdHlgKTtcbiAgICB9IGVsc2UgaWYgKHN0ZG91dC5pbmNsdWRlcygnamF2YS5sYW5nLlNlY3VyaXR5RXhjZXB0aW9uJykpIHtcbiAgICAgIC8vIGlmIHRoZSBhcHAgaXMgZGlzYWJsZWQgb24gYSByZWFsIGRldmljZSBpdCB3aWxsIHRocm93IGEgc2VjdXJpdHkgZXhjZXB0aW9uXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBwZXJtaXNzaW9uIHRvIHN0YXJ0ICcke3N0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eX0nIGFjdGl2aXR5IGhhcyBiZWVuIGRlbmllZC5gICtcbiAgICAgICAgICAgICAgICAgICAgICBgTWFrZSBzdXJlIHRoZSBhY3Rpdml0eS9wYWNrYWdlIG5hbWVzIGFyZSBjb3JyZWN0LmApO1xuICAgIH1cbiAgICBpZiAoc3RhcnRBcHBPcHRpb25zLndhaXRBY3Rpdml0eSkge1xuICAgICAgYXdhaXQgdGhpcy53YWl0Rm9yQWN0aXZpdHkoc3RhcnRBcHBPcHRpb25zLndhaXRQa2csIHN0YXJ0QXBwT3B0aW9ucy53YWl0QWN0aXZpdHksIHN0YXJ0QXBwT3B0aW9ucy53YWl0RHVyYXRpb24pO1xuICAgIH1cbiAgICByZXR1cm4gc3Rkb3V0O1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc3QgYXBwRGVzY3JpcHRvciA9IHN0YXJ0QXBwT3B0aW9ucy5wa2cgfHwgaW50ZW50TmFtZTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBzdGFydCB0aGUgJyR7YXBwRGVzY3JpcHRvcn0nIGFwcGxpY2F0aW9uLiBgICtcbiAgICAgIGBDb25zaWRlciBjaGVja2luZyB0aGUgZHJpdmVyJ3MgdHJvdWJsZXNob290aW5nIGRvY3VtZW50YXRpb24uIGAgK1xuICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBIZWxwZXIgbWV0aG9kIHRvIGNhbGwgYGFkYiBkdW1wc3lzIHdpbmRvdyB3aW5kb3dzL2Rpc3BsYXlzYFxuICovXG5hcGtVdGlsc01ldGhvZHMuZHVtcFdpbmRvd3MgPSBhc3luYyBmdW5jdGlvbiBkdW1wV2luZG93cyAoKSB7XG4gIGNvbnN0IGFwaUxldmVsID0gYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpO1xuXG4gIC8vIFdpdGggdmVyc2lvbiAyOSwgQW5kcm9pZCBjaGFuZ2VkIHRoZSBkdW1wc3lzIHN5bnRheFxuICBjb25zdCBkdW1wc3lzQXJnID0gYXBpTGV2ZWwgPj0gMjkgPyAnZGlzcGxheXMnIDogJ3dpbmRvd3MnO1xuICBjb25zdCBjbWQgPSBbJ2R1bXBzeXMnLCAnd2luZG93JywgZHVtcHN5c0FyZ107XG5cbiAgcmV0dXJuIGF3YWl0IHRoaXMuc2hlbGwoY21kKTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUGFja2FnZUFjdGl2aXR5SW5mb1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBhcHBQYWNrYWdlIC0gVGhlIG5hbWUgb2YgYXBwbGljYXRpb24gcGFja2FnZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBleGFtcGxlICdjb20uYWNtZS5hcHAnLlxuICogQHByb3BlcnR5IHs/c3RyaW5nfSBhcHBBY3Rpdml0eSAtIFRoZSBuYW1lIG9mIG1haW4gYXBwbGljYXRpb24gYWN0aXZpdHkuXG4gKi9cblxuLyoqXG4gKiBHZXQgdGhlIG5hbWUgb2YgY3VycmVudGx5IGZvY3VzZWQgcGFja2FnZSBhbmQgYWN0aXZpdHkuXG4gKlxuICogQHJldHVybiB7UGFja2FnZUFjdGl2aXR5SW5mb30gVGhlIG1hcHBpbmcsIHdoZXJlIHByb3BlcnR5IG5hbWVzIGFyZSAnYXBwUGFja2FnZScgYW5kICdhcHBBY3Rpdml0eScuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgcGFyc2luZyB0aGUgZGF0YS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldEZvY3VzZWRQYWNrYWdlQW5kQWN0aXZpdHkgPSBhc3luYyBmdW5jdGlvbiBnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5ICgpIHtcbiAgbG9nLmRlYnVnKCdHZXR0aW5nIGZvY3VzZWQgcGFja2FnZSBhbmQgYWN0aXZpdHknKTtcbiAgbGV0IHN0ZG91dDtcbiAgdHJ5IHtcbiAgICBzdGRvdXQgPSBhd2FpdCB0aGlzLmR1bXBXaW5kb3dzKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgQ291bGQgbm90IHJldHJpZXZlIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBwYWNrYWdlIGFuZCBhY3Rpdml0eS4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWBcbiAgICApO1xuICB9XG5cbiAgY29uc3QgbnVsbEZvY3VzZWRBcHBSZSA9IC9eXFxzKm1Gb2N1c2VkQXBwPW51bGwvbTtcbiAgLy8gaHR0cHM6Ly9yZWdleDEwMS5jb20vci94Wjh2RjcvMVxuICBjb25zdCBmb2N1c2VkQXBwUmUgPSBuZXcgUmVnRXhwKFxuICAgICdeXFxcXHMqbUZvY3VzZWRBcHAuK1JlY29yZFxcXFx7LipcXFxccyhbXlxcXFxzXFxcXC9cXFxcfV0rKVxcXFwvKFteXFxcXHNcXFxcL1xcXFx9XFxcXCxdKylcXFxcLD8oXFxcXHNbXlxcXFxzXFxcXC9cXFxcfV0rKSpcXFxcfScsXG4gICAgJ21nJ1xuICApO1xuICBjb25zdCBudWxsQ3VycmVudEZvY3VzUmUgPSAvXlxccyptQ3VycmVudEZvY3VzPW51bGwvbTtcbiAgY29uc3QgY3VycmVudEZvY3VzQXBwUmUgPSBuZXcgUmVnRXhwKCdeXFxcXHMqbUN1cnJlbnRGb2N1cy4rXFxcXHsuK1xcXFxzKFteXFxcXHNcXFxcL10rKVxcXFwvKFteXFxcXHNdKylcXFxcYicsICdtZycpO1xuXG4gIGNvbnN0IGZvY3VzZWRBcHBDYW5kaWRhdGVzID0gW107XG4gIGNvbnN0IGN1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXMgPSBbXTtcbiAgZm9yIChjb25zdCBbY2FuZGlkYXRlcywgcGF0dGVybl0gb2YgW1xuICAgIFtmb2N1c2VkQXBwQ2FuZGlkYXRlcywgZm9jdXNlZEFwcFJlXSxcbiAgICBbY3VycmVudEZvY3VzQXBwQ2FuZGlkYXRlcywgY3VycmVudEZvY3VzQXBwUmVdXG4gIF0pIHtcbiAgICBsZXQgbWF0Y2g7XG4gICAgd2hpbGUgKChtYXRjaCA9IHBhdHRlcm4uZXhlYyhzdGRvdXQpKSkge1xuICAgICAgY2FuZGlkYXRlcy5wdXNoKHtcbiAgICAgICAgYXBwUGFja2FnZTogbWF0Y2hbMV0udHJpbSgpLFxuICAgICAgICBhcHBBY3Rpdml0eTogbWF0Y2hbMl0udHJpbSgpXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgaWYgKGZvY3VzZWRBcHBDYW5kaWRhdGVzLmxlbmd0aCA+IDEgJiYgY3VycmVudEZvY3VzQXBwQ2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzE3MTA2XG4gICAgcmV0dXJuIF8uaW50ZXJzZWN0aW9uV2l0aChmb2N1c2VkQXBwQ2FuZGlkYXRlcywgY3VycmVudEZvY3VzQXBwQ2FuZGlkYXRlcywgXy5pc0VxdWFsKVswXVxuICAgICAgPz8gZm9jdXNlZEFwcENhbmRpZGF0ZXNbMF07XG4gIH1cbiAgaWYgKGZvY3VzZWRBcHBDYW5kaWRhdGVzLmxlbmd0aCA+IDAgfHwgY3VycmVudEZvY3VzQXBwQ2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIGZvY3VzZWRBcHBDYW5kaWRhdGVzWzBdID8/IGN1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXNbMF07XG4gIH1cblxuICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgW251bGxGb2N1c2VkQXBwUmUsIG51bGxDdXJyZW50Rm9jdXNSZV0pIHtcbiAgICBpZiAocGF0dGVybi5leGVjKHN0ZG91dCkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFwcFBhY2thZ2U6IG51bGwsXG4gICAgICAgIGFwcEFjdGl2aXR5OiBudWxsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGxvZy5kZWJ1ZyhzdGRvdXQpO1xuICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCByZXRyaWV2ZSB0aGUgY3VycmVudGx5IGZvY3VzZWQgcGFja2FnZSBhbmQgYWN0aXZpdHknKTtcbn07XG5cbi8qKlxuICogV2FpdCBmb3IgdGhlIGdpdmVuIGFjdGl2aXR5IHRvIGJlIGZvY3VzZWQvbm9uLWZvY3VzZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtzdHJpbmd9IGFjdGl2aXR5IC0gVGhlIG5hbWUgb2YgdGhlIGFjdGl2aXR5LCBiZWxvbmdpbmcgdG8gdGhhdCBwYWNrYWdlLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gd2FpdCBmb3IuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHdhaXRGb3JTdG9wIC0gV2hldGhlciB0byB3YWl0IHVudGlsIHRoZSBhY3Rpdml0eSBpcyBmb2N1c2VkICh0cnVlKVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yIGlzIG5vdCBmb2N1c2VkIChmYWxzZSkuXG4gKiBAcGFyYW0ge251bWJlcn0gd2FpdE1zIFsyMDAwMF0gLSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIHRpbWVvdXQgb2NjdXJzLlxuICogQHRocm93cyB7ZXJyb3J9IElmIHRpbWVvdXQgaGFwcGVucy5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLndhaXRGb3JBY3Rpdml0eU9yTm90ID0gYXN5bmMgZnVuY3Rpb24gd2FpdEZvckFjdGl2aXR5T3JOb3QgKHBrZywgYWN0aXZpdHksIHdhaXRGb3JTdG9wLCB3YWl0TXMgPSAyMDAwMCkge1xuICBpZiAoIXBrZyB8fCAhYWN0aXZpdHkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1BhY2thZ2UgYW5kIGFjdGl2aXR5IHJlcXVpcmVkLicpO1xuICB9XG4gIGxvZy5kZWJ1ZyhgV2FpdGluZyB1cCB0byAke3dhaXRNc31tcyBmb3IgYWN0aXZpdHkgbWF0Y2hpbmcgcGtnOiAnJHtwa2d9JyBhbmQgYCArXG4gICAgICAgICAgICBgYWN0aXZpdHk6ICcke2FjdGl2aXR5fScgdG8ke3dhaXRGb3JTdG9wID8gJyBub3QnIDogJyd9IGJlIGZvY3VzZWRgKTtcblxuICBjb25zdCBzcGxpdE5hbWVzID0gKG5hbWVzKSA9PiBuYW1lcy5zcGxpdCgnLCcpLm1hcCgobmFtZSkgPT4gbmFtZS50cmltKCkpO1xuICBjb25zdCBhbGxQYWNrYWdlcyA9IHNwbGl0TmFtZXMocGtnKTtcbiAgY29uc3QgYWxsQWN0aXZpdGllcyA9IHNwbGl0TmFtZXMoYWN0aXZpdHkpO1xuXG4gIGNvbnN0IHBvc3NpYmxlQWN0aXZpdHlOYW1lcyA9IFtdO1xuICBmb3IgKGNvbnN0IG9uZUFjdGl2aXR5IG9mIGFsbEFjdGl2aXRpZXMpIHtcbiAgICBpZiAob25lQWN0aXZpdHkuc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAvLyBhZGQgdGhlIHBhY2thZ2UgbmFtZSBpZiBhY3Rpdml0eSBpcyBub3QgZnVsbCBxdWFsaWZpZWRcbiAgICAgIGZvciAoY29uc3QgY3VycmVudFBrZyBvZiBhbGxQYWNrYWdlcykge1xuICAgICAgICBwb3NzaWJsZUFjdGl2aXR5TmFtZXMucHVzaChgJHtjdXJyZW50UGtnfSR7b25lQWN0aXZpdHl9YC5yZXBsYWNlKC9cXC4rL2csICcuJykpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBhY2NlcHQgZnVsbHkgcXVhbGlmaWVkIGFjdGl2aXR5IG5hbWUuXG4gICAgICBwb3NzaWJsZUFjdGl2aXR5TmFtZXMucHVzaChvbmVBY3Rpdml0eSk7XG4gICAgICBwb3NzaWJsZUFjdGl2aXR5TmFtZXMucHVzaChgJHtwa2d9LiR7b25lQWN0aXZpdHl9YCk7XG4gICAgfVxuICB9XG4gIGxvZy5kZWJ1ZyhgUG9zc2libGUgYWN0aXZpdGllcywgdG8gYmUgY2hlY2tlZDogJHtwb3NzaWJsZUFjdGl2aXR5TmFtZXMubWFwKChuYW1lKSA9PiBgJyR7bmFtZX0nYCkuam9pbignLCAnKX1gKTtcblxuICBjb25zdCBwb3NzaWJsZUFjdGl2aXR5UGF0dGVybnMgPSBwb3NzaWJsZUFjdGl2aXR5TmFtZXMubWFwKFxuICAgIChhY3ROYW1lKSA9PiBuZXcgUmVnRXhwKGBeJHthY3ROYW1lLnJlcGxhY2UoL1xcLi9nLCAnXFxcXC4nKS5yZXBsYWNlKC9cXCovZywgJy4qPycpLnJlcGxhY2UoL1xcJC9nLCAnXFxcXCQnKX0kYClcbiAgKTtcblxuICBjb25zdCBjb25kaXRpb25GdW5jID0gYXN5bmMgKCkgPT4ge1xuICAgIGxldCBhcHBQYWNrYWdlO1xuICAgIGxldCBhcHBBY3Rpdml0eTtcbiAgICB0cnkge1xuICAgICAgKHthcHBQYWNrYWdlLCBhcHBBY3Rpdml0eX0gPSBhd2FpdCB0aGlzLmdldEZvY3VzZWRQYWNrYWdlQW5kQWN0aXZpdHkoKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLmRlYnVnKGUubWVzc2FnZSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChhcHBBY3Rpdml0eSAmJiBhcHBQYWNrYWdlKSB7XG4gICAgICBjb25zdCBmdWxseVF1YWxpZmllZEFjdGl2aXR5ID0gYXBwQWN0aXZpdHkuc3RhcnRzV2l0aCgnLicpID8gYCR7YXBwUGFja2FnZX0ke2FwcEFjdGl2aXR5fWAgOiBhcHBBY3Rpdml0eTtcbiAgICAgIGxvZy5kZWJ1ZyhgRm91bmQgcGFja2FnZTogJyR7YXBwUGFja2FnZX0nIGFuZCBmdWxseSBxdWFsaWZpZWQgYWN0aXZpdHkgbmFtZSA6ICcke2Z1bGx5UXVhbGlmaWVkQWN0aXZpdHl9J2ApO1xuICAgICAgY29uc3QgaXNBY3Rpdml0eUZvdW5kID0gXy5pbmNsdWRlcyhhbGxQYWNrYWdlcywgYXBwUGFja2FnZSlcbiAgICAgICAgJiYgcG9zc2libGVBY3Rpdml0eVBhdHRlcm5zLnNvbWUoKHApID0+IHAudGVzdChmdWxseVF1YWxpZmllZEFjdGl2aXR5KSk7XG4gICAgICBpZiAoKCF3YWl0Rm9yU3RvcCAmJiBpc0FjdGl2aXR5Rm91bmQpIHx8ICh3YWl0Rm9yU3RvcCAmJiAhaXNBY3Rpdml0eUZvdW5kKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgbG9nLmRlYnVnKCdJbmNvcnJlY3QgcGFja2FnZSBhbmQgYWN0aXZpdHkuIFJldHJ5aW5nLicpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICB0cnkge1xuICAgIGF3YWl0IHdhaXRGb3JDb25kaXRpb24oY29uZGl0aW9uRnVuYywge1xuICAgICAgd2FpdE1zOiBwYXJzZUludCh3YWl0TXMsIDEwKSxcbiAgICAgIGludGVydmFsTXM6IDUwMCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtwb3NzaWJsZUFjdGl2aXR5TmFtZXMubWFwKChuYW1lKSA9PiBgJyR7bmFtZX0nYCkuam9pbignIG9yICcpfSBuZXZlciAke3dhaXRGb3JTdG9wID8gJ3N0b3BwZWQnIDogJ3N0YXJ0ZWQnfS4gYCArXG4gICAgICBgQ29uc2lkZXIgY2hlY2tpbmcgdGhlIGRyaXZlcidzIHRyb3VibGVzaG9vdGluZyBkb2N1bWVudGF0aW9uLmApO1xuICB9XG59O1xuXG4vKipcbiAqIFdhaXQgZm9yIHRoZSBnaXZlbiBhY3Rpdml0eSB0byBiZSBmb2N1c2VkXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtzdHJpbmd9IGFjdGl2aXR5IC0gVGhlIG5hbWUgb2YgdGhlIGFjdGl2aXR5LCBiZWxvbmdpbmcgdG8gdGhhdCBwYWNrYWdlLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gd2FpdCBmb3IuXG4gKiBAcGFyYW0ge251bWJlcn0gd2FpdE1zIFsyMDAwMF0gLSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIHRpbWVvdXQgb2NjdXJzLlxuICogQHRocm93cyB7ZXJyb3J9IElmIHRpbWVvdXQgaGFwcGVucy5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLndhaXRGb3JBY3Rpdml0eSA9IGFzeW5jIGZ1bmN0aW9uIHdhaXRGb3JBY3Rpdml0eSAocGtnLCBhY3QsIHdhaXRNcyA9IDIwMDAwKSB7XG4gIGF3YWl0IHRoaXMud2FpdEZvckFjdGl2aXR5T3JOb3QocGtnLCBhY3QsIGZhbHNlLCB3YWl0TXMpO1xufTtcblxuLyoqXG4gKiBXYWl0IGZvciB0aGUgZ2l2ZW4gYWN0aXZpdHkgdG8gYmUgbm9uLWZvY3VzZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtzdHJpbmd9IGFjdGl2aXR5IC0gVGhlIG5hbWUgb2YgdGhlIGFjdGl2aXR5LCBiZWxvbmdpbmcgdG8gdGhhdCBwYWNrYWdlLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gd2FpdCBmb3IuXG4gKiBAcGFyYW0ge251bWJlcn0gd2FpdE1zIFsyMDAwMF0gLSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIHRpbWVvdXQgb2NjdXJzLlxuICogQHRocm93cyB7ZXJyb3J9IElmIHRpbWVvdXQgaGFwcGVucy5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLndhaXRGb3JOb3RBY3Rpdml0eSA9IGFzeW5jIGZ1bmN0aW9uIHdhaXRGb3JOb3RBY3Rpdml0eSAocGtnLCBhY3QsIHdhaXRNcyA9IDIwMDAwKSB7XG4gIGF3YWl0IHRoaXMud2FpdEZvckFjdGl2aXR5T3JOb3QocGtnLCBhY3QsIHRydWUsIHdhaXRNcyk7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFVuaW5zdGFsbE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB0aW1lb3V0IFthZGJFeGVjVGltZW91dF0gLSBUaGUgY291bnQgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdW50aWwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwIGlzIHVuaW5zdGFsbGVkLlxuICogQHByb3BlcnR5IHtib29sZWFufSBrZWVwRGF0YSBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8ga2VlcCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uIGRhdGEgYW5kIGNhY2hlIGZvbGRlcnMgYWZ0ZXIgdW5pbnN0YWxsLlxuICovXG5cbi8qKlxuICogVW5pbnN0YWxsIHRoZSBnaXZlbiBwYWNrYWdlIGZyb20gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byBiZSB1bmluc3RhbGxlZC5cbiAqIEBwYXJhbSB7P1VuaW5zdGFsbE9wdGlvbnN9IG9wdGlvbnMgLSBUaGUgc2V0IG9mIHVuaW5zdGFsbCBvcHRpb25zLlxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgcGFja2FnZSB3YXMgZm91bmQgb24gdGhlIGRldmljZSBhbmRcbiAqICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NmdWxseSB1bmluc3RhbGxlZC5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLnVuaW5zdGFsbEFwayA9IGFzeW5jIGZ1bmN0aW9uIHVuaW5zdGFsbEFwayAocGtnLCBvcHRpb25zID0ge30pIHtcbiAgbG9nLmRlYnVnKGBVbmluc3RhbGxpbmcgJHtwa2d9YCk7XG4gIGlmICghYXdhaXQgdGhpcy5pc0FwcEluc3RhbGxlZChwa2cpKSB7XG4gICAgbG9nLmluZm8oYCR7cGtnfSB3YXMgbm90IHVuaW5zdGFsbGVkLCBiZWNhdXNlIGl0IHdhcyBub3QgcHJlc2VudCBvbiB0aGUgZGV2aWNlYCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgY21kID0gWyd1bmluc3RhbGwnXTtcbiAgaWYgKG9wdGlvbnMua2VlcERhdGEpIHtcbiAgICBjbWQucHVzaCgnLWsnKTtcbiAgfVxuICBjbWQucHVzaChwa2cpO1xuXG4gIGxldCBzdGRvdXQ7XG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5mb3JjZVN0b3AocGtnKTtcbiAgICBzdGRvdXQgPSAoYXdhaXQgdGhpcy5hZGJFeGVjKGNtZCwge3RpbWVvdXQ6IG9wdGlvbnMudGltZW91dH0pKS50cmltKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVuYWJsZSB0byB1bmluc3RhbGwgQVBLLiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbiAgbG9nLmRlYnVnKGAnYWRiICR7Y21kLmpvaW4oJyAnKX0nIGNvbW1hbmQgb3V0cHV0OiAke3N0ZG91dH1gKTtcbiAgaWYgKHN0ZG91dC5pbmNsdWRlcygnU3VjY2VzcycpKSB7XG4gICAgbG9nLmluZm8oYCR7cGtnfSB3YXMgc3VjY2Vzc2Z1bGx5IHVuaW5zdGFsbGVkYCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgbG9nLmluZm8oYCR7cGtnfSB3YXMgbm90IHVuaW5zdGFsbGVkYCk7XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbi8qKlxuICogSW5zdGFsbCB0aGUgcGFja2FnZSBhZnRlciBpdCB3YXMgcHVzaGVkIHRvIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBrUGF0aE9uRGV2aWNlIC0gVGhlIGZ1bGwgcGF0aCB0byB0aGUgcGFja2FnZSBvbiB0aGUgZGV2aWNlIGZpbGUgc3lzdGVtLlxuICogQHBhcmFtIHtvYmplY3R9IG9wdHMgW3t9XSAtIEFkZGl0aW9uYWwgZXhlYyBvcHRpb25zLiBTZWUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vbm9kZS10ZWVuX3Byb2Nlc3N9XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG1vcmUgZGV0YWlscyBvbiB0aGlzIHBhcmFtZXRlci5cbiAqIEB0aHJvd3Mge2Vycm9yfSBJZiB0aGVyZSB3YXMgYSBmYWlsdXJlIGR1cmluZyBhcHBsaWNhdGlvbiBpbnN0YWxsLlxuICovXG5hcGtVdGlsc01ldGhvZHMuaW5zdGFsbEZyb21EZXZpY2VQYXRoID0gYXN5bmMgZnVuY3Rpb24gaW5zdGFsbEZyb21EZXZpY2VQYXRoIChhcGtQYXRoT25EZXZpY2UsIG9wdHMgPSB7fSkge1xuICBsZXQgc3Rkb3V0ID0gYXdhaXQgdGhpcy5zaGVsbChbJ3BtJywgJ2luc3RhbGwnLCAnLXInLCBhcGtQYXRoT25EZXZpY2VdLCBvcHRzKTtcbiAgaWYgKHN0ZG91dC5pbmRleE9mKCdGYWlsdXJlJykgIT09IC0xKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBSZW1vdGUgaW5zdGFsbCBmYWlsZWQ6ICR7c3Rkb3V0fWApO1xuICB9XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IENhY2hpbmdPcHRpb25zXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHRpbWVvdXQgW2FkYkV4ZWNUaW1lb3V0XSAtIFRoZSBjb3VudCBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwIGlzIHVwbG9hZGVkIHRvIHRoZSByZW1vdGUgbG9jYXRpb24uXG4gKi9cblxuLyoqXG4gKiBDYWNoZXMgdGhlIGdpdmVuIEFQSyBhdCBhIHJlbW90ZSBsb2NhdGlvbiB0byBzcGVlZCB1cCBmdXJ0aGVyIEFQSyBkZXBsb3ltZW50cy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBrUGF0aCAtIEZ1bGwgcGF0aCB0byB0aGUgYXBrIG9uIHRoZSBsb2NhbCBGU1xuICogQHBhcmFtIHs/Q2FjaGluZ09wdGlvbnN9IG9wdGlvbnMgLSBDYWNoaW5nIG9wdGlvbnNcbiAqIEByZXR1cm5zIHtzdHJpbmd9IC0gRnVsbCBwYXRoIHRvIHRoZSBjYWNoZWQgYXBrIG9uIHRoZSByZW1vdGUgZmlsZSBzeXN0ZW1cbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGVyZSB3YXMgYSBmYWlsdXJlIHdoaWxlIGNhY2hpbmcgdGhlIGFwcFxuICovXG5hcGtVdGlsc01ldGhvZHMuY2FjaGVBcGsgPSBhc3luYyBmdW5jdGlvbiBjYWNoZUFwayAoYXBrUGF0aCwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IGFwcEhhc2ggPSBhd2FpdCBmcy5oYXNoKGFwa1BhdGgpO1xuICBjb25zdCByZW1vdGVQYXRoID0gcGF0aC5wb3NpeC5qb2luKFJFTU9URV9DQUNIRV9ST09ULCBgJHthcHBIYXNofS5hcGtgKTtcbiAgY29uc3QgcmVtb3RlQ2FjaGVkRmlsZXMgPSBbXTtcbiAgLy8gR2V0IGN1cnJlbnQgY29udGVudHMgb2YgdGhlIHJlbW90ZSBjYWNoZSBvciBjcmVhdGUgaXQgZm9yIHRoZSBmaXJzdCB0aW1lXG4gIHRyeSB7XG4gICAgY29uc3QgZXJyb3JNYXJrZXIgPSAnX0VSUk9SXyc7XG4gICAgbGV0IGxzT3V0cHV0ID0gbnVsbDtcbiAgICBpZiAodGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQgPT09IHRydWUgfHwgIV8uaXNCb29sZWFuKHRoaXMuX2FyZUV4dGVuZGVkTHNPcHRpb25zU3VwcG9ydGVkKSkge1xuICAgICAgbHNPdXRwdXQgPSBhd2FpdCB0aGlzLnNoZWxsKFtgbHMgLXQgLTEgJHtSRU1PVEVfQ0FDSEVfUk9PVH0gMj4mMSB8fCBlY2hvICR7ZXJyb3JNYXJrZXJ9YF0pO1xuICAgIH1cbiAgICBpZiAoIV8uaXNTdHJpbmcobHNPdXRwdXQpIHx8IChsc091dHB1dC5pbmNsdWRlcyhlcnJvck1hcmtlcikgJiYgIWxzT3V0cHV0LmluY2x1ZGVzKFJFTU9URV9DQUNIRV9ST09UKSkpIHtcbiAgICAgIGlmICghXy5pc0Jvb2xlYW4odGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQpKSB7XG4gICAgICAgIGxvZy5kZWJ1ZygnVGhlIGN1cnJlbnQgQW5kcm9pZCBBUEkgZG9lcyBub3Qgc3VwcG9ydCBleHRlbmRlZCBscyBvcHRpb25zLiAnICtcbiAgICAgICAgICAnRGVmYXVsdGluZyB0byBuby1vcHRpb25zIGNhbGwnKTtcbiAgICAgIH1cbiAgICAgIGxzT3V0cHV0ID0gYXdhaXQgdGhpcy5zaGVsbChbYGxzICR7UkVNT1RFX0NBQ0hFX1JPT1R9IDI+JjEgfHwgZWNobyAke2Vycm9yTWFya2VyfWBdKTtcbiAgICAgIHRoaXMuX2FyZUV4dGVuZGVkTHNPcHRpb25zU3VwcG9ydGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2FyZUV4dGVuZGVkTHNPcHRpb25zU3VwcG9ydGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGxzT3V0cHV0LmluY2x1ZGVzKGVycm9yTWFya2VyKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGxzT3V0cHV0LnN1YnN0cmluZygwLCBsc091dHB1dC5pbmRleE9mKGVycm9yTWFya2VyKSkpO1xuICAgIH1cbiAgICByZW1vdGVDYWNoZWRGaWxlcy5wdXNoKC4uLihcbiAgICAgIGxzT3V0cHV0LnNwbGl0KCdcXG4nKVxuICAgICAgICAubWFwKCh4KSA9PiB4LnRyaW0oKSlcbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICkpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nLmRlYnVnKGBHb3QgYW4gZXJyb3IgJyR7ZS5tZXNzYWdlLnRyaW0oKX0nIHdoaWxlIGdldHRpbmcgdGhlIGxpc3Qgb2YgZmlsZXMgaW4gdGhlIGNhY2hlLiBgICtcbiAgICAgIGBBc3N1bWluZyB0aGUgY2FjaGUgZG9lcyBub3QgZXhpc3QgeWV0YCk7XG4gICAgYXdhaXQgdGhpcy5zaGVsbChbJ21rZGlyJywgJy1wJywgUkVNT1RFX0NBQ0hFX1JPT1RdKTtcbiAgfVxuICBsb2cuZGVidWcoYFRoZSBjb3VudCBvZiBhcHBsaWNhdGlvbnMgaW4gdGhlIGNhY2hlOiAke3JlbW90ZUNhY2hlZEZpbGVzLmxlbmd0aH1gKTtcbiAgY29uc3QgdG9IYXNoID0gKHJlbW90ZVBhdGgpID0+IHBhdGgucG9zaXgucGFyc2UocmVtb3RlUGF0aCkubmFtZTtcbiAgLy8gUHVzaCB0aGUgYXBrIHRvIHRoZSByZW1vdGUgY2FjaGUgaWYgbmVlZGVkXG4gIGlmIChyZW1vdGVDYWNoZWRGaWxlcy5zb21lKCh4KSA9PiB0b0hhc2goeCkgPT09IGFwcEhhc2gpKSB7XG4gICAgbG9nLmluZm8oYFRoZSBhcHBsaWNhdGlvbiBhdCAnJHthcGtQYXRofScgaXMgYWxyZWFkeSBjYWNoZWQgdG8gJyR7cmVtb3RlUGF0aH0nYCk7XG4gICAgLy8gVXBkYXRlIHRoZSBhcHBsaWNhdGlvbiB0aW1lc3RhbXAgYXN5bmNocm9ub3VzbHkgaW4gb3JkZXIgdG8gYnVtcCBpdHMgcG9zaXRpb25cbiAgICAvLyBpbiB0aGUgc29ydGVkIGxzIG91dHB1dFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcm9taXNlL3ByZWZlci1hd2FpdC10by10aGVuXG4gICAgdGhpcy5zaGVsbChbJ3RvdWNoJywgJy1hbScsIHJlbW90ZVBhdGhdKS5jYXRjaCgoKSA9PiB7fSk7XG4gIH0gZWxzZSB7XG4gICAgbG9nLmluZm8oYENhY2hpbmcgdGhlIGFwcGxpY2F0aW9uIGF0ICcke2Fwa1BhdGh9JyB0byAnJHtyZW1vdGVQYXRofSdgKTtcbiAgICBjb25zdCB0aW1lciA9IG5ldyB0aW1pbmcuVGltZXIoKS5zdGFydCgpO1xuICAgIGF3YWl0IHRoaXMucHVzaChhcGtQYXRoLCByZW1vdGVQYXRoLCB7dGltZW91dDogb3B0aW9ucy50aW1lb3V0fSk7XG4gICAgY29uc3Qge3NpemV9ID0gYXdhaXQgZnMuc3RhdChhcGtQYXRoKTtcbiAgICBsb2cuaW5mbyhgVGhlIHVwbG9hZCBvZiAnJHtwYXRoLmJhc2VuYW1lKGFwa1BhdGgpfScgKCR7dXRpbC50b1JlYWRhYmxlU2l6ZVN0cmluZyhzaXplKX0pIGAgK1xuICAgICAgYHRvb2sgJHt0aW1lci5nZXREdXJhdGlvbigpLmFzTWlsbGlTZWNvbmRzLnRvRml4ZWQoMCl9bXNgKTtcbiAgfVxuICBpZiAoIXRoaXMucmVtb3RlQXBwc0NhY2hlKSB7XG4gICAgdGhpcy5yZW1vdGVBcHBzQ2FjaGUgPSBuZXcgTFJVKHtcbiAgICAgIG1heDogdGhpcy5yZW1vdGVBcHBzQ2FjaGVMaW1pdCxcbiAgICB9KTtcbiAgfVxuICAvLyBDbGVhbnVwIHRoZSBpbnZhbGlkIGVudHJpZXMgZnJvbSB0aGUgY2FjaGVcbiAgXy5kaWZmZXJlbmNlKFsuLi50aGlzLnJlbW90ZUFwcHNDYWNoZS5rZXlzKCldLCByZW1vdGVDYWNoZWRGaWxlcy5tYXAodG9IYXNoKSlcbiAgICAuZm9yRWFjaCgoaGFzaCkgPT4gdGhpcy5yZW1vdGVBcHBzQ2FjaGUuZGVsKGhhc2gpKTtcbiAgLy8gQnVtcCB0aGUgY2FjaGUgcmVjb3JkIGZvciB0aGUgcmVjZW50bHkgY2FjaGVkIGl0ZW1cbiAgdGhpcy5yZW1vdGVBcHBzQ2FjaGUuc2V0KGFwcEhhc2gsIHJlbW90ZVBhdGgpO1xuICAvLyBJZiB0aGUgcmVtb3RlIGNhY2hlIGV4Y2VlZHMgdGhpcy5yZW1vdGVBcHBzQ2FjaGVMaW1pdCwgcmVtb3ZlIHRoZSBsZWFzdCByZWNlbnRseSB1c2VkIGVudHJpZXNcbiAgY29uc3QgZW50cmllc1RvQ2xlYW51cCA9IHJlbW90ZUNhY2hlZEZpbGVzXG4gICAgLm1hcCgoeCkgPT4gcGF0aC5wb3NpeC5qb2luKFJFTU9URV9DQUNIRV9ST09ULCB4KSlcbiAgICAuZmlsdGVyKCh4KSA9PiAhdGhpcy5yZW1vdGVBcHBzQ2FjaGUuaGFzKHRvSGFzaCh4KSkpXG4gICAgLnNsaWNlKHRoaXMucmVtb3RlQXBwc0NhY2hlTGltaXQgLSBbLi4udGhpcy5yZW1vdGVBcHBzQ2FjaGUua2V5cygpXS5sZW5ndGgpO1xuICBpZiAoIV8uaXNFbXB0eShlbnRyaWVzVG9DbGVhbnVwKSkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnNoZWxsKFsncm0nLCAnLWYnLCAuLi5lbnRyaWVzVG9DbGVhbnVwXSk7XG4gICAgICBsb2cuZGVidWcoYERlbGV0ZWQgJHtlbnRyaWVzVG9DbGVhbnVwLmxlbmd0aH0gZXhwaXJlZCBhcHBsaWNhdGlvbiBjYWNoZSBlbnRyaWVzYCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLndhcm4oYENhbm5vdCBkZWxldGUgJHtlbnRyaWVzVG9DbGVhbnVwLmxlbmd0aH0gZXhwaXJlZCBhcHBsaWNhdGlvbiBjYWNoZSBlbnRyaWVzLiBgICtcbiAgICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlbW90ZVBhdGg7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEluc3RhbGxPcHRpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gdGltZW91dCBbNjAwMDBdIC0gVGhlIGNvdW50IG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcCBpcyBpbnN0YWxsZWQuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdGltZW91dENhcE5hbWUgW2FuZHJvaWRJbnN0YWxsVGltZW91dF0gLSBUaGUgdGltZW91dCBvcHRpb24gbmFtZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnMgY2FuIGluY3JlYXNlIHRoZSB0aW1lb3V0LlxuICogQHByb3BlcnR5IHtib29sZWFufSBhbGxvd1Rlc3RQYWNrYWdlcyBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gYWxsb3cgdGVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFja2FnZXMgaW5zdGFsbGF0aW9uLlxuICogQHByb3BlcnR5IHtib29sZWFufSB1c2VTZGNhcmQgW2ZhbHNlXSAtIFNldCB0byB0cnVlIHRvIGluc3RhbGwgdGhlIGFwcCBvbiBzZGNhcmRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0ZWFkIG9mIHRoZSBkZXZpY2UgbWVtb3J5LlxuICogQHByb3BlcnR5IHtib29sZWFufSBncmFudFBlcm1pc3Npb25zIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBncmFudCBhbGwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zIHJlcXVlc3RlZCBpbiB0aGUgYXBwbGljYXRpb24ncyBtYW5pZmVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvbWF0aWNhbGx5IGFmdGVyIHRoZSBpbnN0YWxsYXRpb24gaXMgY29tcGxldGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVyIEFuZHJvaWQgNisuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHJlcGxhY2UgW3RydWVdIC0gU2V0IGl0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGFwcGxpY2F0aW9uIHRvIGJlIHVwZ3JhZGVkL3JlaW5zdGFsbGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXQgaXMgYWxyZWFkeSBwcmVzZW50IG9uIHRoZSBkZXZpY2UuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IG5vSW5jcmVtZW50YWwgW2ZhbHNlXSAtIEZvcmNlZnVsbHkgZGlzYWJsZXMgaW5jcmVtZW50YWwgaW5zdGFsbHMgaWYgc2V0IHRvIGB0cnVlYC5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVhZCBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS9wcmV2aWV3L2ZlYXR1cmVzI2luY3JlbWVudGFsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtb3JlIGRldGFpbHMuXG4gKi9cblxuLyoqXG4gKiBJbnN0YWxsIHRoZSBwYWNrYWdlIGZyb20gdGhlIGxvY2FsIGZpbGUgc3lzdGVtLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIC0gVGhlIGZ1bGwgcGF0aCB0byB0aGUgbG9jYWwgcGFja2FnZS5cbiAqIEBwYXJhbSB7P0luc3RhbGxPcHRpb25zfSBvcHRpb25zIC0gVGhlIHNldCBvZiBpbnN0YWxsYXRpb24gb3B0aW9ucy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBhbiB1bmV4cGVjdGVkIGVycm9yIGhhcHBlbnMgZHVyaW5nIGluc3RhbGwuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5pbnN0YWxsID0gYXN5bmMgZnVuY3Rpb24gaW5zdGFsbCAoYXBwUGF0aCwgb3B0aW9ucyA9IHt9KSB7XG4gIGlmIChhcHBQYXRoLmVuZHNXaXRoKEFQS1NfRVhURU5TSU9OKSkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmluc3RhbGxBcGtzKGFwcFBhdGgsIG9wdGlvbnMpO1xuICB9XG5cbiAgb3B0aW9ucyA9IF8uY2xvbmVEZWVwKG9wdGlvbnMpO1xuICBfLmRlZmF1bHRzKG9wdGlvbnMsIHtcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHRpbWVvdXQ6IHRoaXMuYWRiRXhlY1RpbWVvdXQgPT09IERFRkFVTFRfQURCX0VYRUNfVElNRU9VVCA/IEFQS19JTlNUQUxMX1RJTUVPVVQgOiB0aGlzLmFkYkV4ZWNUaW1lb3V0LFxuICAgIHRpbWVvdXRDYXBOYW1lOiAnYW5kcm9pZEluc3RhbGxUaW1lb3V0JyxcbiAgfSk7XG5cbiAgY29uc3QgaW5zdGFsbEFyZ3MgPSBidWlsZEluc3RhbGxBcmdzKGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKSwgb3B0aW9ucyk7XG4gIGlmIChvcHRpb25zLm5vSW5jcmVtZW50YWwgJiYgYXdhaXQgdGhpcy5pc0luY3JlbWVudGFsSW5zdGFsbFN1cHBvcnRlZCgpKSB7XG4gICAgLy8gQWRiIHRocm93cyBhbiBlcnJvciBpZiBpdCBkb2VzIG5vdCBrbm93IGFib3V0IGFuIGFyZyxcbiAgICAvLyB3aGljaCBpcyB0aGUgY2FzZSBoZXJlIGZvciBvbGRlciBhZGIgdmVyc2lvbnMuXG4gICAgaW5zdGFsbEFyZ3MucHVzaCgnLS1uby1pbmNyZW1lbnRhbCcpO1xuICB9XG4gIGNvbnN0IGluc3RhbGxPcHRzID0ge1xuICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dCxcbiAgICB0aW1lb3V0Q2FwTmFtZTogb3B0aW9ucy50aW1lb3V0Q2FwTmFtZSxcbiAgfTtcbiAgY29uc3QgaW5zdGFsbENtZCA9IFtcbiAgICAnaW5zdGFsbCcsXG4gICAgLi4uaW5zdGFsbEFyZ3MsXG4gICAgYXBwUGF0aCxcbiAgXTtcbiAgbGV0IHBlcmZvcm1BcHBJbnN0YWxsID0gYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5hZGJFeGVjKGluc3RhbGxDbWQsIGluc3RhbGxPcHRzKTtcbiAgLy8gdGhpcy5yZW1vdGVBcHBzQ2FjaGVMaW1pdCA8PSAwIG1lYW5zIG5vIGNhY2hpbmcgc2hvdWxkIGJlIGFwcGxpZWRcbiAgbGV0IHNob3VsZENhY2hlQXBwID0gdGhpcy5yZW1vdGVBcHBzQ2FjaGVMaW1pdCA+IDA7XG4gIGlmIChzaG91bGRDYWNoZUFwcCkge1xuICAgIHNob3VsZENhY2hlQXBwID0gIShhd2FpdCB0aGlzLmlzU3RyZWFtZWRJbnN0YWxsU3VwcG9ydGVkKCkpO1xuICAgIGlmICghc2hvdWxkQ2FjaGVBcHApIHtcbiAgICAgIGxvZy5pbmZvKGBUaGUgYXBwbGljYXRpb24gYXQgJyR7YXBwUGF0aH0nIHdpbGwgbm90IGJlIGNhY2hlZCwgYmVjYXVzZSB0aGUgZGV2aWNlIHVuZGVyIHRlc3QgaGFzIGAgK1xuICAgICAgICBgY29uZmlybWVkIHRoZSBzdXBwb3J0IG9mIHN0cmVhbWVkIGluc3RhbGxzYCk7XG4gICAgfVxuICB9XG4gIGlmIChzaG91bGRDYWNoZUFwcCkge1xuICAgIGNvbnN0IGNsZWFyQ2FjaGUgPSBhc3luYyAoKSA9PiB7XG4gICAgICBsb2cuaW5mbyhgQ2xlYXJpbmcgdGhlIGNhY2hlIGF0ICcke1JFTU9URV9DQUNIRV9ST09UfSdgKTtcbiAgICAgIGF3YWl0IHRoaXMuc2hlbGwoWydybScsICctcmYnLCBgJHtSRU1PVEVfQ0FDSEVfUk9PVH0vKmBdKTtcbiAgICB9O1xuICAgIGNvbnN0IGNhY2hlQXBwID0gYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5jYWNoZUFwayhhcHBQYXRoLCB7XG4gICAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXQsXG4gICAgfSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNhY2hlZEFwcFBhdGggPSBhd2FpdCBjYWNoZUFwcCgpO1xuICAgICAgcGVyZm9ybUFwcEluc3RhbGwgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBtSW5zdGFsbENtZEJ5UmVtb3RlUGF0aCA9IChyZW1vdGVQYXRoKSA9PiBbXG4gICAgICAgICAgJ3BtJywgJ2luc3RhbGwnLFxuICAgICAgICAgIC4uLmluc3RhbGxBcmdzLFxuICAgICAgICAgIHJlbW90ZVBhdGgsXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IG91dHB1dCA9IGF3YWl0IHRoaXMuc2hlbGwocG1JbnN0YWxsQ21kQnlSZW1vdGVQYXRoKGNhY2hlZEFwcFBhdGgpLCBpbnN0YWxsT3B0cyk7XG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtL2lzc3Vlcy8xMzk3MFxuICAgICAgICBpZiAoL1xcYklOU1RBTExfRkFJTEVEX0lOU1VGRklDSUVOVF9TVE9SQUdFXFxiLy50ZXN0KG91dHB1dCkpIHtcbiAgICAgICAgICBsb2cud2FybihgVGhlcmUgd2FzIGEgZmFpbHVyZSB3aGlsZSBpbnN0YWxsaW5nICcke2FwcFBhdGh9JyBgICtcbiAgICAgICAgICAgIGBiZWNhdXNlIG9mIHRoZSBpbnN1ZmZpY2llbnQgZGV2aWNlIHN0b3JhZ2Ugc3BhY2VgKTtcbiAgICAgICAgICBhd2FpdCBjbGVhckNhY2hlKCk7XG4gICAgICAgICAgbG9nLmluZm8oYENvbnNpZGVyIGRlY3JlYXNpbmcgdGhlIG1heGltdW0gYW1vdW50IG9mIGNhY2hlZCBhcHBzIGAgK1xuICAgICAgICAgICAgYChjdXJyZW50bHkgJHt0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0fSkgdG8gYXZvaWQgc3VjaCBpc3N1ZXMgaW4gdGhlIGZ1dHVyZWApO1xuICAgICAgICAgIGNvbnN0IG5ld0NhY2hlZEFwcFBhdGggPSBhd2FpdCBjYWNoZUFwcCgpO1xuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnNoZWxsKHBtSW5zdGFsbENtZEJ5UmVtb3RlUGF0aChuZXdDYWNoZWRBcHBQYXRoKSwgaW5zdGFsbE9wdHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5kZWJ1ZyhlKTtcbiAgICAgIGxvZy53YXJuKGBUaGVyZSB3YXMgYSBmYWlsdXJlIHdoaWxlIGNhY2hpbmcgJyR7YXBwUGF0aH0nOiAke2UubWVzc2FnZX1gKTtcbiAgICAgIGxvZy53YXJuKCdGYWxsaW5nIGJhY2sgdG8gdGhlIGRlZmF1bHQgaW5zdGFsbGF0aW9uIHByb2NlZHVyZScpO1xuICAgICAgYXdhaXQgY2xlYXJDYWNoZSgpO1xuICAgIH1cbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHRpbWVyID0gbmV3IHRpbWluZy5UaW1lcigpLnN0YXJ0KCk7XG4gICAgY29uc3Qgb3V0cHV0ID0gYXdhaXQgcGVyZm9ybUFwcEluc3RhbGwoKTtcbiAgICBsb2cuaW5mbyhgVGhlIGluc3RhbGxhdGlvbiBvZiAnJHtwYXRoLmJhc2VuYW1lKGFwcFBhdGgpfScgdG9vayAke3RpbWVyLmdldER1cmF0aW9uKCkuYXNNaWxsaVNlY29uZHMudG9GaXhlZCgwKX1tc2ApO1xuICAgIGNvbnN0IHRydW5jYXRlZE91dHB1dCA9ICghXy5pc1N0cmluZyhvdXRwdXQpIHx8IG91dHB1dC5sZW5ndGggPD0gMzAwKSA/XG4gICAgICBvdXRwdXQgOiBgJHtvdXRwdXQuc3Vic3RyKDAsIDE1MCl9Li4uJHtvdXRwdXQuc3Vic3RyKG91dHB1dC5sZW5ndGggLSAxNTApfWA7XG4gICAgbG9nLmRlYnVnKGBJbnN0YWxsIGNvbW1hbmQgc3Rkb3V0OiAke3RydW5jYXRlZE91dHB1dH1gKTtcbiAgICBpZiAoL1xcW0lOU1RBTExbQS1aX10rRkFJTEVEW0EtWl9dK1xcXS8udGVzdChvdXRwdXQpKSB7XG4gICAgICBpZiAodGhpcy5pc1Rlc3RQYWNrYWdlT25seUVycm9yKG91dHB1dCkpIHtcbiAgICAgICAgY29uc3QgbXNnID0gYFNldCAnYWxsb3dUZXN0UGFja2FnZXMnIGNhcGFiaWxpdHkgdG8gdHJ1ZSBpbiBvcmRlciB0byBhbGxvdyB0ZXN0IHBhY2thZ2VzIGluc3RhbGxhdGlvbi5gO1xuICAgICAgICBsb2cud2Fybihtc2cpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7b3V0cHV0fVxcbiR7bXNnfWApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKG91dHB1dCk7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyBvbiBzb21lIHN5c3RlbXMgdGhpcyB3aWxsIHRocm93IGFuIGVycm9yIGlmIHRoZSBhcHAgYWxyZWFkeVxuICAgIC8vIGV4aXN0c1xuICAgIGlmICghZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ0lOU1RBTExfRkFJTEVEX0FMUkVBRFlfRVhJU1RTJykpIHtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gICAgbG9nLmRlYnVnKGBBcHBsaWNhdGlvbiAnJHthcHBQYXRofScgYWxyZWFkeSBpbnN0YWxsZWQuIENvbnRpbnVpbmcuYCk7XG4gIH1cbn07XG5cbi8qKlxuICogUmV0cmlldmVzIHRoZSBjdXJyZW50IGluc3RhbGxhdGlvbiBzdGF0ZSBvZiB0aGUgcGFydGljdWxhciBhcHBsaWNhdGlvblxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIC0gRnVsbCBwYXRoIHRvIHRoZSBhcHBsaWNhdGlvblxuICogQHBhcmFtIHs/c3RyaW5nfSBwa2cgLSBQYWNrYWdlIGlkZW50aWZpZXIuIElmIG9taXR0ZWQgdGhlbiB0aGUgc2NyaXB0IHdpbGxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHRvIGV4dHJhY3QgaXQgb24gaXRzIG93blxuICogQHJldHVybnMge3N0cmluZ31dT25lIG9mIGBBUFBfSU5TVEFMTF9TVEFURWAgY29uc3RhbnRzXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXRBcHBsaWNhdGlvbkluc3RhbGxTdGF0ZSA9IGFzeW5jIGZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uSW5zdGFsbFN0YXRlIChhcHBQYXRoLCBwa2cgPSBudWxsKSB7XG4gIGxldCBhcGtJbmZvID0gbnVsbDtcbiAgaWYgKCFwa2cpIHtcbiAgICBhcGtJbmZvID0gYXdhaXQgdGhpcy5nZXRBcGtJbmZvKGFwcFBhdGgpO1xuICAgIHBrZyA9IGFwa0luZm8ubmFtZTtcbiAgfVxuICBpZiAoIXBrZykge1xuICAgIGxvZy53YXJuKGBDYW5ub3QgcmVhZCB0aGUgcGFja2FnZSBuYW1lIG9mICcke2FwcFBhdGh9J2ApO1xuICAgIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlVOS05PV047XG4gIH1cblxuICBpZiAoIWF3YWl0IHRoaXMuaXNBcHBJbnN0YWxsZWQocGtnKSkge1xuICAgIGxvZy5kZWJ1ZyhgQXBwICcke2FwcFBhdGh9JyBpcyBub3QgaW5zdGFsbGVkYCk7XG4gICAgcmV0dXJuIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuTk9UX0lOU1RBTExFRDtcbiAgfVxuXG4gIGNvbnN0IHt2ZXJzaW9uQ29kZTogcGtnVmVyc2lvbkNvZGUsIHZlcnNpb25OYW1lOiBwa2dWZXJzaW9uTmFtZVN0cn0gPSBhd2FpdCB0aGlzLmdldFBhY2thZ2VJbmZvKHBrZyk7XG4gIGNvbnN0IHBrZ1ZlcnNpb25OYW1lID0gc2VtdmVyLnZhbGlkKHNlbXZlci5jb2VyY2UocGtnVmVyc2lvbk5hbWVTdHIpKTtcbiAgaWYgKCFhcGtJbmZvKSB7XG4gICAgYXBrSW5mbyA9IGF3YWl0IHRoaXMuZ2V0QXBrSW5mbyhhcHBQYXRoKTtcbiAgfVxuICBjb25zdCB7dmVyc2lvbkNvZGU6IGFwa1ZlcnNpb25Db2RlLCB2ZXJzaW9uTmFtZTogYXBrVmVyc2lvbk5hbWVTdHJ9ID0gYXBrSW5mbztcbiAgY29uc3QgYXBrVmVyc2lvbk5hbWUgPSBzZW12ZXIudmFsaWQoc2VtdmVyLmNvZXJjZShhcGtWZXJzaW9uTmFtZVN0cikpO1xuXG4gIGlmICghXy5pc0ludGVnZXIoYXBrVmVyc2lvbkNvZGUpIHx8ICFfLmlzSW50ZWdlcihwa2dWZXJzaW9uQ29kZSkpIHtcbiAgICBsb2cud2FybihgQ2Fubm90IHJlYWQgdmVyc2lvbiBjb2RlcyBvZiAnJHthcHBQYXRofScgYW5kL29yICcke3BrZ30nYCk7XG4gICAgaWYgKCFfLmlzU3RyaW5nKGFwa1ZlcnNpb25OYW1lKSB8fCAhXy5pc1N0cmluZyhwa2dWZXJzaW9uTmFtZSkpIHtcbiAgICAgIGxvZy53YXJuKGBDYW5ub3QgcmVhZCB2ZXJzaW9uIG5hbWVzIG9mICcke2FwcFBhdGh9JyBhbmQvb3IgJyR7cGtnfSdgKTtcbiAgICAgIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlVOS05PV047XG4gICAgfVxuICB9XG4gIGlmIChfLmlzSW50ZWdlcihhcGtWZXJzaW9uQ29kZSkgJiYgXy5pc0ludGVnZXIocGtnVmVyc2lvbkNvZGUpKSB7XG4gICAgaWYgKHBrZ1ZlcnNpb25Db2RlID4gYXBrVmVyc2lvbkNvZGUpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgVGhlIHZlcnNpb24gY29kZSBvZiB0aGUgaW5zdGFsbGVkICcke3BrZ30nIGlzIGdyZWF0ZXIgdGhhbiB0aGUgYXBwbGljYXRpb24gdmVyc2lvbiBjb2RlICgke3BrZ1ZlcnNpb25Db2RlfSA+ICR7YXBrVmVyc2lvbkNvZGV9KWApO1xuICAgICAgcmV0dXJuIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuTkVXRVJfVkVSU0lPTl9JTlNUQUxMRUQ7XG4gICAgfVxuICAgIC8vIFZlcnNpb24gY29kZXMgbWlnaHQgbm90IGJlIG1haW50YWluZWQuIENoZWNrIHZlcnNpb24gbmFtZXMuXG4gICAgaWYgKHBrZ1ZlcnNpb25Db2RlID09PSBhcGtWZXJzaW9uQ29kZSkge1xuICAgICAgaWYgKF8uaXNTdHJpbmcoYXBrVmVyc2lvbk5hbWUpICYmIF8uaXNTdHJpbmcocGtnVmVyc2lvbk5hbWUpICYmIHNlbXZlci5zYXRpc2ZpZXMocGtnVmVyc2lvbk5hbWUsIGA+PSR7YXBrVmVyc2lvbk5hbWV9YCkpIHtcbiAgICAgICAgbG9nLmRlYnVnKGBUaGUgdmVyc2lvbiBuYW1lIG9mIHRoZSBpbnN0YWxsZWQgJyR7cGtnfScgaXMgZ3JlYXRlciBvciBlcXVhbCB0byB0aGUgYXBwbGljYXRpb24gdmVyc2lvbiBuYW1lICgnJHtwa2dWZXJzaW9uTmFtZX0nID49ICcke2Fwa1ZlcnNpb25OYW1lfScpYCk7XG4gICAgICAgIHJldHVybiBzZW12ZXIuc2F0aXNmaWVzKHBrZ1ZlcnNpb25OYW1lLCBgPiR7YXBrVmVyc2lvbk5hbWV9YClcbiAgICAgICAgICA/IHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuTkVXRVJfVkVSU0lPTl9JTlNUQUxMRURcbiAgICAgICAgICA6IHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuU0FNRV9WRVJTSU9OX0lOU1RBTExFRDtcbiAgICAgIH1cbiAgICAgIGlmICghXy5pc1N0cmluZyhhcGtWZXJzaW9uTmFtZSkgfHwgIV8uaXNTdHJpbmcocGtnVmVyc2lvbk5hbWUpKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgVGhlIHZlcnNpb24gbmFtZSBvZiB0aGUgaW5zdGFsbGVkICcke3BrZ30nIGlzIGVxdWFsIHRvIGFwcGxpY2F0aW9uIHZlcnNpb24gbmFtZSAoJHtwa2dWZXJzaW9uQ29kZX0gPT09ICR7YXBrVmVyc2lvbkNvZGV9KWApO1xuICAgICAgICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5TQU1FX1ZFUlNJT05fSU5TVEFMTEVEO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIGlmIChfLmlzU3RyaW5nKGFwa1ZlcnNpb25OYW1lKSAmJiBfLmlzU3RyaW5nKHBrZ1ZlcnNpb25OYW1lKSAmJiBzZW12ZXIuc2F0aXNmaWVzKHBrZ1ZlcnNpb25OYW1lLCBgPj0ke2Fwa1ZlcnNpb25OYW1lfWApKSB7XG4gICAgbG9nLmRlYnVnKGBUaGUgdmVyc2lvbiBuYW1lIG9mIHRoZSBpbnN0YWxsZWQgJyR7cGtnfScgaXMgZ3JlYXRlciBvciBlcXVhbCB0byB0aGUgYXBwbGljYXRpb24gdmVyc2lvbiBuYW1lICgnJHtwa2dWZXJzaW9uTmFtZX0nID49ICcke2Fwa1ZlcnNpb25OYW1lfScpYCk7XG4gICAgcmV0dXJuIHNlbXZlci5zYXRpc2ZpZXMocGtnVmVyc2lvbk5hbWUsIGA+JHthcGtWZXJzaW9uTmFtZX1gKVxuICAgICAgPyB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEXG4gICAgICA6IHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuU0FNRV9WRVJTSU9OX0lOU1RBTExFRDtcbiAgfVxuXG4gIGxvZy5kZWJ1ZyhgVGhlIGluc3RhbGxlZCAnJHtwa2d9JyBwYWNrYWdlIGlzIG9sZGVyIHRoYW4gJyR7YXBwUGF0aH0nICgke3BrZ1ZlcnNpb25Db2RlfSA8ICR7YXBrVmVyc2lvbkNvZGV9IG9yICcke3BrZ1ZlcnNpb25OYW1lfScgPCAnJHthcGtWZXJzaW9uTmFtZX0nKSdgKTtcbiAgcmV0dXJuIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuT0xERVJfVkVSU0lPTl9JTlNUQUxMRUQ7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEluc3RhbGxPclVwZ3JhZGVPcHRpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gdGltZW91dCBbNjAwMDBdIC0gVGhlIGNvdW50IG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcCBpcyBpbnN0YWxsZWQuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGFsbG93VGVzdFBhY2thZ2VzIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBhbGxvdyB0ZXN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWNrYWdlcyBpbnN0YWxsYXRpb24uXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHVzZVNkY2FyZCBbZmFsc2VdIC0gU2V0IHRvIHRydWUgdG8gaW5zdGFsbCB0aGUgYXBwIG9uIFNEQ2FyZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RlYWQgb2YgdGhlIGRldmljZSBtZW1vcnkuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGdyYW50UGVybWlzc2lvbnMgW2ZhbHNlXSAtIFNldCB0byB0cnVlIGluIG9yZGVyIHRvIGdyYW50IGFsbCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbnMgcmVxdWVzdGVkIGluIHRoZSBhcHBsaWNhdGlvbidzIG1hbmlmZXN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9tYXRpY2FsbHkgYWZ0ZXIgdGhlIGluc3RhbGxhdGlvbiBpcyBjb21wbGV0ZWRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5kZXIgQW5kcm9pZCA2Ky5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gZW5mb3JjZUN1cnJlbnRCdWlsZCBbZmFsc2VdIC0gU2V0IHRvIGB0cnVlYCBpbiBvcmRlciB0byBhbHdheXMgcHJlZmVyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBjdXJyZW50IGJ1aWxkIG92ZXIgYW55IGluc3RhbGxlZCBwYWNrYWdlcyBoYXZpbmdcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIHNhbWUgaWRlbnRpZmllclxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gSW5zdGFsbE9yVXBncmFkZVJlc3VsdFxuICogQHByb3BlcnR5IHtib29sZWFufSB3YXNVbmluc3RhbGxlZCAtIEVxdWFscyB0byBgdHJ1ZWAgaWYgdGhlIHRhcmdldCBhcHAgaGFzIGJlZW4gdW5pbnN0YWxsZWRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmUgYmVpbmcgaW5zdGFsbGVkXG4gKiBAcHJvcGVydHkge0FQUF9JTlNUQUxMX1NUQVRFfSBhcHBTdGF0ZSAtIE9uZSBvZiBgYWRiLkFQUF9JTlNUQUxMX1NUQVRFYCBzdGF0ZXMsIHdoaWNoIHJlZmxlY3RzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBzdGF0ZSBvZiB0aGUgYXBwbGljYXRpb24gYmVmb3JlIGJlaW5nIGluc3RhbGxlZC5cbiAqL1xuXG4vKipcbiAqIEluc3RhbGwgdGhlIHBhY2thZ2UgZnJvbSB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0gb3IgdXBncmFkZSBpdCBpZiBhbiBvbGRlclxuICogdmVyc2lvbiBvZiB0aGUgc2FtZSBwYWNrYWdlIGlzIGFscmVhZHkgaW5zdGFsbGVkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIC0gVGhlIGZ1bGwgcGF0aCB0byB0aGUgbG9jYWwgcGFja2FnZS5cbiAqIEBwYXJhbSB7P3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIGluc3RhbGxlZCBwYWNrYWdlLiBUaGUgbWV0aG9kIHdpbGxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgcGVyZm9ybSBmYXN0ZXIgaWYgaXQgaXMgc2V0LlxuICogQHBhcmFtIHs/SW5zdGFsbE9yVXBncmFkZU9wdGlvbnN9IG9wdGlvbnMgLSBTZXQgb2YgaW5zdGFsbCBvcHRpb25zLlxuICogQHRocm93cyB7RXJyb3J9IElmIGFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFwcGVucyBkdXJpbmcgaW5zdGFsbC5cbiAqIEByZXR1cm5zIHtJbnN0YWxsT3JVcGdyYWRlUmVzdWx0fVxuICovXG5hcGtVdGlsc01ldGhvZHMuaW5zdGFsbE9yVXBncmFkZSA9IGFzeW5jIGZ1bmN0aW9uIGluc3RhbGxPclVwZ3JhZGUgKGFwcFBhdGgsIHBrZyA9IG51bGwsIG9wdGlvbnMgPSB7fSkge1xuICBpZiAoIXBrZykge1xuICAgIGNvbnN0IGFwa0luZm8gPSBhd2FpdCB0aGlzLmdldEFwa0luZm8oYXBwUGF0aCk7XG4gICAgcGtnID0gYXBrSW5mby5uYW1lO1xuICB9XG5cbiAgY29uc3Qge1xuICAgIGVuZm9yY2VDdXJyZW50QnVpbGQsXG4gIH0gPSBvcHRpb25zO1xuICBjb25zdCBhcHBTdGF0ZSA9IGF3YWl0IHRoaXMuZ2V0QXBwbGljYXRpb25JbnN0YWxsU3RhdGUoYXBwUGF0aCwgcGtnKTtcbiAgbGV0IHdhc1VuaW5zdGFsbGVkID0gZmFsc2U7XG4gIGNvbnN0IHVuaW5zdGFsbFBhY2thZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFhd2FpdCB0aGlzLnVuaW5zdGFsbEFwayhwa2cpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke3BrZ30nIHBhY2thZ2UgY2Fubm90IGJlIHVuaW5zdGFsbGVkYCk7XG4gICAgfVxuICAgIHdhc1VuaW5zdGFsbGVkID0gdHJ1ZTtcbiAgfTtcbiAgc3dpdGNoIChhcHBTdGF0ZSkge1xuICAgIGNhc2UgdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5OT1RfSU5TVEFMTEVEOlxuICAgICAgbG9nLmRlYnVnKGBJbnN0YWxsaW5nICcke2FwcFBhdGh9J2ApO1xuICAgICAgYXdhaXQgdGhpcy5pbnN0YWxsKGFwcFBhdGgsIE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMsIHtyZXBsYWNlOiBmYWxzZX0pKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFwcFN0YXRlLFxuICAgICAgICB3YXNVbmluc3RhbGxlZCxcbiAgICAgIH07XG4gICAgY2FzZSB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEOlxuICAgICAgaWYgKGVuZm9yY2VDdXJyZW50QnVpbGQpIHtcbiAgICAgICAgbG9nLmluZm8oYERvd25ncmFkaW5nICcke3BrZ30nIGFzIHJlcXVlc3RlZGApO1xuICAgICAgICBhd2FpdCB1bmluc3RhbGxQYWNrYWdlKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgbG9nLmRlYnVnKGBUaGVyZSBpcyBubyBuZWVkIHRvIGRvd25ncmFkZSAnJHtwa2d9J2ApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXBwU3RhdGUsXG4gICAgICAgIHdhc1VuaW5zdGFsbGVkLFxuICAgICAgfTtcbiAgICBjYXNlIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuU0FNRV9WRVJTSU9OX0lOU1RBTExFRDpcbiAgICAgIGlmIChlbmZvcmNlQ3VycmVudEJ1aWxkKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgbG9nLmRlYnVnKGBUaGVyZSBpcyBubyBuZWVkIHRvIGluc3RhbGwvdXBncmFkZSAnJHthcHBQYXRofSdgKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFwcFN0YXRlLFxuICAgICAgICB3YXNVbmluc3RhbGxlZCxcbiAgICAgIH07XG4gICAgY2FzZSB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk9MREVSX1ZFUlNJT05fSU5TVEFMTEVEOlxuICAgICAgbG9nLmRlYnVnKGBFeGVjdXRpbmcgdXBncmFkZSBvZiAnJHthcHBQYXRofSdgKTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBsb2cuZGVidWcoYFRoZSBjdXJyZW50IGluc3RhbGwgc3RhdGUgb2YgJyR7YXBwUGF0aH0nIGlzIHVua25vd24uIEluc3RhbGxpbmcgYW55d2F5YCk7XG4gICAgICBicmVhaztcbiAgfVxuXG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5pbnN0YWxsKGFwcFBhdGgsIE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMsIHtyZXBsYWNlOiB0cnVlfSkpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cud2FybihgQ2Fubm90IGluc3RhbGwvdXBncmFkZSAnJHtwa2d9JyBiZWNhdXNlIG9mICcke2Vyci5tZXNzYWdlfScuIFRyeWluZyBmdWxsIHJlaW5zdGFsbGApO1xuICAgIGF3YWl0IHVuaW5zdGFsbFBhY2thZ2UoKTtcbiAgICBhd2FpdCB0aGlzLmluc3RhbGwoYXBwUGF0aCwgT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucywge3JlcGxhY2U6IGZhbHNlfSkpO1xuICB9XG4gIHJldHVybiB7XG4gICAgYXBwU3RhdGUsXG4gICAgd2FzVW5pbnN0YWxsZWQsXG4gIH07XG59O1xuXG4vKipcbiAqIEV4dHJhY3Qgc3RyaW5nIHJlc291cmNlcyBmcm9tIHRoZSBnaXZlbiBwYWNrYWdlIG9uIGxvY2FsIGZpbGUgc3lzdGVtLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIC0gVGhlIGZ1bGwgcGF0aCB0byB0aGUgLmFwayhzKSBwYWNrYWdlLlxuICogQHBhcmFtIHs/c3RyaW5nfSBsYW5ndWFnZSAtIFRoZSBuYW1lIG9mIHRoZSBsYW5ndWFnZSB0byBleHRyYWN0IHRoZSByZXNvdXJjZXMgZm9yLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRoZSBkZWZhdWx0IGxhbmd1YWdlIGlzIHVzZWQgaWYgdGhpcyBlcXVhbHMgdG8gYG51bGxgL2B1bmRlZmluZWRgXG4gKiBAcGFyYW0ge3N0cmluZ30gb3V0IC0gVGhlIG5hbWUgb2YgdGhlIGRlc3RpbmF0aW9uIGZvbGRlciBvbiB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0gdG9cbiAqICAgICAgICAgICAgICAgICAgICAgICBzdG9yZSB0aGUgZXh0cmFjdGVkIGZpbGUgdG8uXG4gKiBAcmV0dXJuIHtPYmplY3R9IEEgbWFwcGluZyBvYmplY3QsIHdoZXJlIHByb3BlcnRpZXMgYXJlOiAnYXBrU3RyaW5ncycsIGNvbnRhaW5pbmdcbiAqICAgICAgICAgICAgICAgICAgcGFyc2VkIHJlc291cmNlIGZpbGUgcmVwcmVzZW50ZWQgYXMgSlNPTiBvYmplY3QsIGFuZCAnbG9jYWxQYXRoJyxcbiAqICAgICAgICAgICAgICAgICAgY29udGFpbmluZyB0aGUgcGF0aCB0byB0aGUgZXh0cmFjdGVkIGZpbGUgb24gdGhlIGxvY2FsIGZpbGUgc3lzdGVtLlxuICovXG5hcGtVdGlsc01ldGhvZHMuZXh0cmFjdFN0cmluZ3NGcm9tQXBrID0gYXN5bmMgZnVuY3Rpb24gZXh0cmFjdFN0cmluZ3NGcm9tQXBrIChhcHBQYXRoLCBsYW5ndWFnZSwgb3V0KSB7XG4gIGxvZy5kZWJ1ZyhgRXh0cmFjdGluZyBzdHJpbmdzIGZyb20gZm9yIGxhbmd1YWdlOiAke2xhbmd1YWdlIHx8ICdkZWZhdWx0J31gKTtcbiAgY29uc3Qgb3JpZ2luYWxBcHBQYXRoID0gYXBwUGF0aDtcbiAgaWYgKGFwcFBhdGguZW5kc1dpdGgoQVBLU19FWFRFTlNJT04pKSB7XG4gICAgYXBwUGF0aCA9IGF3YWl0IHRoaXMuZXh0cmFjdExhbmd1YWdlQXBrKGFwcFBhdGgsIGxhbmd1YWdlKTtcbiAgfVxuXG4gIGxldCBhcGtTdHJpbmdzID0ge307XG4gIGxldCBjb25maWdNYXJrZXI7XG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5pbml0QWFwdCgpO1xuXG4gICAgY29uZmlnTWFya2VyID0gYXdhaXQgZm9ybWF0Q29uZmlnTWFya2VyKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQsIFtcbiAgICAgICAgJ2QnLCAnY29uZmlndXJhdGlvbnMnLCBhcHBQYXRoLFxuICAgICAgXSk7XG4gICAgICByZXR1cm4gXy51bmlxKHN0ZG91dC5zcGxpdChvcy5FT0wpKTtcbiAgICB9LCBsYW5ndWFnZSwgJyhkZWZhdWx0KScpO1xuXG4gICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBleGVjKHRoaXMuYmluYXJpZXMuYWFwdCwgW1xuICAgICAgJ2QnLCAnLS12YWx1ZXMnLCAncmVzb3VyY2VzJywgYXBwUGF0aCxcbiAgICBdKTtcbiAgICBhcGtTdHJpbmdzID0gcGFyc2VBYXB0U3RyaW5ncyhzdGRvdXQsIGNvbmZpZ01hcmtlcik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2cuZGVidWcoJ0Nhbm5vdCBleHRyYWN0IHJlc291cmNlcyB1c2luZyBhYXB0LiBUcnlpbmcgYWFwdDIuICcgK1xuICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2Uuc3RkZXJyIHx8IGUubWVzc2FnZX1gKTtcblxuICAgIGF3YWl0IHRoaXMuaW5pdEFhcHQyKCk7XG5cbiAgICBjb25maWdNYXJrZXIgPSBhd2FpdCBmb3JtYXRDb25maWdNYXJrZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBleGVjKHRoaXMuYmluYXJpZXMuYWFwdDIsIFtcbiAgICAgICAgJ2QnLCAnY29uZmlndXJhdGlvbnMnLCBhcHBQYXRoLFxuICAgICAgXSk7XG4gICAgICByZXR1cm4gXy51bmlxKHN0ZG91dC5zcGxpdChvcy5FT0wpKTtcbiAgICB9LCBsYW5ndWFnZSwgJycpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQyLCBbXG4gICAgICAgICdkJywgJ3Jlc291cmNlcycsIGFwcFBhdGgsXG4gICAgICBdKTtcbiAgICAgIGFwa1N0cmluZ3MgPSBwYXJzZUFhcHQyU3RyaW5ncyhzdGRvdXQsIGNvbmZpZ01hcmtlcik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgZXh0cmFjdCByZXNvdXJjZXMgZnJvbSAnJHtvcmlnaW5hbEFwcFBhdGh9Jy4gYCArXG4gICAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKF8uaXNFbXB0eShhcGtTdHJpbmdzKSkge1xuICAgIGxvZy53YXJuKGBObyBzdHJpbmdzIGhhdmUgYmVlbiBmb3VuZCBpbiAnJHtvcmlnaW5hbEFwcFBhdGh9JyByZXNvdXJjZXMgYCArXG4gICAgICBgZm9yICcke2NvbmZpZ01hcmtlciB8fCAnZGVmYXVsdCd9JyBjb25maWd1cmF0aW9uYCk7XG4gIH0gZWxzZSB7XG4gICAgbG9nLmluZm8oYFN1Y2Nlc3NmdWxseSBleHRyYWN0ZWQgJHtfLmtleXMoYXBrU3RyaW5ncykubGVuZ3RofSBzdHJpbmdzIGZyb20gYCArXG4gICAgICBgJyR7b3JpZ2luYWxBcHBQYXRofScgcmVzb3VyY2VzIGZvciAnJHtjb25maWdNYXJrZXIgfHwgJ2RlZmF1bHQnfScgY29uZmlndXJhdGlvbmApO1xuICB9XG5cbiAgY29uc3QgbG9jYWxQYXRoID0gcGF0aC5yZXNvbHZlKG91dCwgJ3N0cmluZ3MuanNvbicpO1xuICBhd2FpdCBta2RpcnAob3V0KTtcbiAgYXdhaXQgZnMud3JpdGVGaWxlKGxvY2FsUGF0aCwgSlNPTi5zdHJpbmdpZnkoYXBrU3RyaW5ncywgbnVsbCwgMiksICd1dGYtOCcpO1xuICByZXR1cm4ge2Fwa1N0cmluZ3MsIGxvY2FsUGF0aH07XG59O1xuXG4vKipcbiAqIEdldCB0aGUgbGFuZ3VhZ2UgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgbmFtZSBvZiBkZXZpY2UgbGFuZ3VhZ2UuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXREZXZpY2VMYW5ndWFnZSA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZUxhbmd1YWdlICgpIHtcbiAgbGV0IGxhbmd1YWdlO1xuICBpZiAoYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpIDwgMjMpIHtcbiAgICBsYW5ndWFnZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlU3lzTGFuZ3VhZ2UoKTtcbiAgICBpZiAoIWxhbmd1YWdlKSB7XG4gICAgICBsYW5ndWFnZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlUHJvZHVjdExhbmd1YWdlKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxhbmd1YWdlID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlTG9jYWxlKCkpLnNwbGl0KCctJylbMF07XG4gIH1cbiAgcmV0dXJuIGxhbmd1YWdlO1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIGNvdW50cnkgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgbmFtZSBvZiBkZXZpY2UgY291bnRyeS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldERldmljZUNvdW50cnkgPSBhc3luYyBmdW5jdGlvbiBnZXREZXZpY2VDb3VudHJ5ICgpIHtcbiAgLy8gdGhpcyBtZXRob2QgaXMgb25seSB1c2VkIGluIEFQSSA8IDIzXG4gIGxldCBjb3VudHJ5ID0gYXdhaXQgdGhpcy5nZXREZXZpY2VTeXNDb3VudHJ5KCk7XG4gIGlmICghY291bnRyeSkge1xuICAgIGNvdW50cnkgPSBhd2FpdCB0aGlzLmdldERldmljZVByb2R1Y3RDb3VudHJ5KCk7XG4gIH1cbiAgcmV0dXJuIGNvdW50cnk7XG59O1xuXG4vKipcbiAqIEdldCB0aGUgbG9jYWxlIG5hbWUgb2YgdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIG5hbWUgb2YgZGV2aWNlIGxvY2FsZS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldERldmljZUxvY2FsZSA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZUxvY2FsZSAoKSB7XG4gIC8vIHRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBpbiBBUEkgPj0gMjNcbiAgbGV0IGxvY2FsZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlU3lzTG9jYWxlKCk7XG4gIGlmICghbG9jYWxlKSB7XG4gICAgbG9jYWxlID0gYXdhaXQgdGhpcy5nZXREZXZpY2VQcm9kdWN0TG9jYWxlKCk7XG4gIH1cbiAgcmV0dXJuIGxvY2FsZTtcbn07XG5cbi8qKlxuICogU2V0IHRoZSBsb2NhbGUgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QgYW5kIHRoZSBmb3JtYXQgb2YgdGhlIGxvY2FsZSBpcyBlbi1VUywgZm9yIGV4YW1wbGUuXG4gKiBUaGlzIG1ldGhvZCBjYWxsIHNldERldmljZUxhbmd1YWdlQ291bnRyeSwgc28sIHBsZWFzZSB1c2Ugc2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5IGFzIHBvc3NpYmxlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBsb2NhbGUgLSBOYW1lcyBvZiB0aGUgZGV2aWNlIGxhbmd1YWdlIGFuZCB0aGUgY291bnRyeSBjb25uZWN0ZWQgd2l0aCBgLWAuIGUuZy4gZW4tVVMuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5zZXREZXZpY2VMb2NhbGUgPSBhc3luYyBmdW5jdGlvbiBzZXREZXZpY2VMb2NhbGUgKGxvY2FsZSkge1xuICBjb25zdCB2YWxpZGF0ZUxvY2FsZSA9IG5ldyBSZWdFeHAoL1thLXpBLVpdKy1bYS16QS1aMC05XSsvKTtcbiAgaWYgKCF2YWxpZGF0ZUxvY2FsZS50ZXN0KGxvY2FsZSkpIHtcbiAgICBsb2cud2Fybihgc2V0RGV2aWNlTG9jYWxlIHJlcXVpcmVzIHRoZSBmb2xsb3dpbmcgZm9ybWF0OiBlbi1VUyBvciBqYS1KUGApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxldCBzcGxpdF9sb2NhbGUgPSBsb2NhbGUuc3BsaXQoJy0nKTtcbiAgYXdhaXQgdGhpcy5zZXREZXZpY2VMYW5ndWFnZUNvdW50cnkoc3BsaXRfbG9jYWxlWzBdLCBzcGxpdF9sb2NhbGVbMV0pO1xufTtcblxuLyoqXG4gKiBNYWtlIHN1cmUgY3VycmVudCBkZXZpY2UgbG9jYWxlIGlzIGV4cGVjdGVkIG9yIG5vdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2UgLSBMYW5ndWFnZS4gVGhlIGxhbmd1YWdlIGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUsIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gbG93ZXIgY2FzZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBjb3VudHJ5IC0gQ291bnRyeS4gVGhlIGxhbmd1YWdlIGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUsIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gbG93ZXIgY2FzZS5cbiAqIEBwYXJhbSB7P3N0cmluZ30gc2NyaXB0IC0gU2NyaXB0LiBUaGUgc2NyaXB0IGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUgYnV0IExvY2FsZSBhbHdheXMgY2Fub25pY2FsaXplcyB0byB0aXRsZSBjYXNlLlxuICpcbiAqIEByZXR1cm4ge2Jvb2xlYW59IElmIGN1cnJlbnQgbG9jYWxlIGlzIGxhbmd1YWdlIGFuZCBjb3VudHJ5IGFzIGFyZ3VtZW50cywgcmV0dXJuIHRydWUuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5lbnN1cmVDdXJyZW50TG9jYWxlID0gYXN5bmMgZnVuY3Rpb24gZW5zdXJlQ3VycmVudExvY2FsZSAobGFuZ3VhZ2UsIGNvdW50cnksIHNjcmlwdCA9IG51bGwpIHtcbiAgY29uc3QgaGFzTGFuZ3VhZ2UgPSBfLmlzU3RyaW5nKGxhbmd1YWdlKTtcbiAgY29uc3QgaGFzQ291bnRyeSA9IF8uaXNTdHJpbmcoY291bnRyeSk7XG5cbiAgaWYgKCFoYXNMYW5ndWFnZSAmJiAhaGFzQ291bnRyeSkge1xuICAgIGxvZy53YXJuKCdlbnN1cmVDdXJyZW50TG9jYWxlIHJlcXVpcmVzIGxhbmd1YWdlIG9yIGNvdW50cnknKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBnZXQgbG93ZXIgY2FzZSB2ZXJzaW9ucyBvZiB0aGUgc3RyaW5nc1xuICBsYW5ndWFnZSA9IChsYW5ndWFnZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgY291bnRyeSA9IChjb3VudHJ5IHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuXG4gIGNvbnN0IGFwaUxldmVsID0gYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpO1xuXG4gIHJldHVybiBhd2FpdCByZXRyeUludGVydmFsKDUsIDEwMDAsIGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGFwaUxldmVsIDwgMjMpIHtcbiAgICAgICAgbGV0IGN1ckxhbmd1YWdlLCBjdXJDb3VudHJ5O1xuICAgICAgICBpZiAoaGFzTGFuZ3VhZ2UpIHtcbiAgICAgICAgICBjdXJMYW5ndWFnZSA9IChhd2FpdCB0aGlzLmdldERldmljZUxhbmd1YWdlKCkpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKCFoYXNDb3VudHJ5ICYmIGxhbmd1YWdlID09PSBjdXJMYW5ndWFnZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNDb3VudHJ5KSB7XG4gICAgICAgICAgY3VyQ291bnRyeSA9IChhd2FpdCB0aGlzLmdldERldmljZUNvdW50cnkoKSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBpZiAoIWhhc0xhbmd1YWdlICYmIGNvdW50cnkgPT09IGN1ckNvdW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobGFuZ3VhZ2UgPT09IGN1ckxhbmd1YWdlICYmIGNvdW50cnkgPT09IGN1ckNvdW50cnkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgY3VyTG9jYWxlID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlTG9jYWxlKCkpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vIHpoLWhhbnMtY24gOiB6aC1jblxuICAgICAgICBjb25zdCBsb2NhbGVDb2RlID0gc2NyaXB0ID8gYCR7bGFuZ3VhZ2V9LSR7c2NyaXB0LnRvTG93ZXJDYXNlKCl9LSR7Y291bnRyeX1gIDogYCR7bGFuZ3VhZ2V9LSR7Y291bnRyeX1gO1xuXG4gICAgICAgIGlmIChsb2NhbGVDb2RlID09PSBjdXJMb2NhbGUpIHtcbiAgICAgICAgICBsb2cuZGVidWcoYFJlcXVlc3RlZCBsb2NhbGUgaXMgZXF1YWwgdG8gY3VycmVudCBsb2NhbGU6ICcke2N1ckxvY2FsZX0nYCk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIC8vIGlmIHRoZXJlIGhhcyBiZWVuIGFuIGVycm9yLCByZXN0YXJ0IGFkYiBhbmQgcmV0cnlcbiAgICAgIGxvZy5lcnJvcihgVW5hYmxlIHRvIGNoZWNrIGRldmljZSBsb2NhbGl6YXRpb246ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLnJlY29ubmVjdCgpO1xuICAgICAgfSBjYXRjaCAoaWduKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVzdGFydEFkYigpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfSk7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgbG9jYWxlIG5hbWUgb2YgdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZSAtIExhbmd1YWdlLiBUaGUgbGFuZ3VhZ2UgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSwgYnV0IExvY2FsZSBhbHdheXMgY2Fub25pY2FsaXplcyB0byBsb3dlciBjYXNlLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBbYS16QS1aXXsyLDh9LiBlLmcuIGVuLCBqYSA6IGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3JlZmVyZW5jZS9qYXZhL3V0aWwvTG9jYWxlLmh0bWxcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb3VudHJ5IC0gQ291bnRyeS4gVGhlIGNvdW50cnkgKHJlZ2lvbikgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSwgYnV0IExvY2FsZSBhbHdheXMgY2Fub25pY2FsaXplcyB0byB1cHBlciBjYXNlLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBbYS16QS1aXXsyfSB8IFswLTldezN9LiBlLmcuIFVTLCBKUCA6IGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3JlZmVyZW5jZS9qYXZhL3V0aWwvTG9jYWxlLmh0bWxcbiAqIEBwYXJhbSB7P3N0cmluZ30gc2NyaXB0IC0gU2NyaXB0LiBUaGUgc2NyaXB0IGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUgYnV0IExvY2FsZSBhbHdheXMgY2Fub25pY2FsaXplcyB0byB0aXRsZSBjYXNlLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBbYS16QS1aXXs0fS4gZS5nLiBIYW5zIGluIHpoLUhhbnMtQ04gOiBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS9yZWZlcmVuY2UvamF2YS91dGlsL0xvY2FsZS5odG1sXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5zZXREZXZpY2VMYW5ndWFnZUNvdW50cnkgPSBhc3luYyBmdW5jdGlvbiBzZXREZXZpY2VMYW5ndWFnZUNvdW50cnkgKGxhbmd1YWdlLCBjb3VudHJ5LCBzY3JpcHQgPSBudWxsKSB7XG4gIGxldCBoYXNMYW5ndWFnZSA9IGxhbmd1YWdlICYmIF8uaXNTdHJpbmcobGFuZ3VhZ2UpO1xuICBsZXQgaGFzQ291bnRyeSA9IGNvdW50cnkgJiYgXy5pc1N0cmluZyhjb3VudHJ5KTtcbiAgaWYgKCFoYXNMYW5ndWFnZSB8fCAhaGFzQ291bnRyeSkge1xuICAgIGxvZy53YXJuKGBzZXREZXZpY2VMYW5ndWFnZUNvdW50cnkgcmVxdWlyZXMgbGFuZ3VhZ2UgYW5kIGNvdW50cnkgYXQgbGVhc3RgKTtcbiAgICBsb2cud2FybihgR290IGxhbmd1YWdlOiAnJHtsYW5ndWFnZX0nIGFuZCBjb3VudHJ5OiAnJHtjb3VudHJ5fSdgKTtcbiAgICByZXR1cm47XG4gIH1cbiAgbGV0IGFwaUxldmVsID0gYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpO1xuXG4gIGxhbmd1YWdlID0gKGxhbmd1YWdlIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICBjb3VudHJ5ID0gKGNvdW50cnkgfHwgJycpLnRvVXBwZXJDYXNlKCk7XG5cbiAgaWYgKGFwaUxldmVsIDwgMjMpIHtcbiAgICBsZXQgY3VyTGFuZ3VhZ2UgPSAoYXdhaXQgdGhpcy5nZXREZXZpY2VMYW5ndWFnZSgpKS50b0xvd2VyQ2FzZSgpO1xuICAgIGxldCBjdXJDb3VudHJ5ID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlQ291bnRyeSgpKS50b1VwcGVyQ2FzZSgpO1xuXG4gICAgaWYgKGxhbmd1YWdlICE9PSBjdXJMYW5ndWFnZSB8fCBjb3VudHJ5ICE9PSBjdXJDb3VudHJ5KSB7XG4gICAgICBhd2FpdCB0aGlzLnNldERldmljZVN5c0xvY2FsZVZpYVNldHRpbmdBcHAobGFuZ3VhZ2UsIGNvdW50cnkpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsZXQgY3VyTG9jYWxlID0gYXdhaXQgdGhpcy5nZXREZXZpY2VMb2NhbGUoKTtcblxuICAgIC8vIHpoLUhhbnMtQ04gOiB6aC1DTlxuICAgIGNvbnN0IGxvY2FsZUNvZGUgPSBzY3JpcHQgPyBgJHtsYW5ndWFnZX0tJHtzY3JpcHR9LSR7Y291bnRyeX1gIDogYCR7bGFuZ3VhZ2V9LSR7Y291bnRyeX1gO1xuICAgIGxvZy5kZWJ1ZyhgQ3VycmVudCBsb2NhbGU6ICcke2N1ckxvY2FsZX0nOyByZXF1ZXN0ZWQgbG9jYWxlOiAnJHtsb2NhbGVDb2RlfSdgKTtcbiAgICBpZiAobG9jYWxlQ29kZS50b0xvd2VyQ2FzZSgpICE9PSBjdXJMb2NhbGUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgYXdhaXQgdGhpcy5zZXREZXZpY2VTeXNMb2NhbGVWaWFTZXR0aW5nQXBwKGxhbmd1YWdlLCBjb3VudHJ5LCBzY3JpcHQpO1xuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBBcHBJbmZvXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFBhY2thZ2UgbmFtZSwgZm9yIGV4YW1wbGUgJ2NvbS5hY21lLmFwcCcuXG4gKiBAcHJvcGVydHkge251bWJlcn0gdmVyc2lvbkNvZGUgLSBWZXJzaW9uIGNvZGUuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdmVyc2lvbk5hbWUgLSBWZXJzaW9uIG5hbWUsIGZvciBleGFtcGxlICcxLjAnLlxuICovXG5cbi8qKlxuICogR2V0IHRoZSBwYWNrYWdlIGluZm8gZnJvbSBsb2NhbCBhcGsgZmlsZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIFRoZSBmdWxsIHBhdGggdG8gZXhpc3RpbmcgLmFwayhzKSBwYWNrYWdlIG9uIHRoZSBsb2NhbFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlIHN5c3RlbS5cbiAqIEByZXR1cm4gez9BcHBJbmZvfSBUaGUgcGFyc2VkIGFwcGxpY2F0aW9uIGluZm9ybWF0aW9uLlxuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0QXBrSW5mbyA9IGFzeW5jIGZ1bmN0aW9uIGdldEFwa0luZm8gKGFwcFBhdGgpIHtcbiAgaWYgKCFhd2FpdCBmcy5leGlzdHMoYXBwUGF0aCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBmaWxlIGF0IHBhdGggJHthcHBQYXRofSBkb2VzIG5vdCBleGlzdCBvciBpcyBub3QgYWNjZXNzaWJsZWApO1xuICB9XG5cbiAgaWYgKGFwcFBhdGguZW5kc1dpdGgoQVBLU19FWFRFTlNJT04pKSB7XG4gICAgYXBwUGF0aCA9IGF3YWl0IHRoaXMuZXh0cmFjdEJhc2VBcGsoYXBwUGF0aCk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGFwa1JlYWRlciA9IGF3YWl0IEFwa1JlYWRlci5vcGVuKGFwcFBhdGgpO1xuICAgIGNvbnN0IG1hbmlmZXN0ID0gYXdhaXQgYXBrUmVhZGVyLnJlYWRNYW5pZmVzdCgpO1xuICAgIGNvbnN0IHtwa2csIHZlcnNpb25OYW1lLCB2ZXJzaW9uQ29kZX0gPSBwYXJzZU1hbmlmZXN0KG1hbmlmZXN0KTtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogcGtnLFxuICAgICAgdmVyc2lvbkNvZGUsXG4gICAgICB2ZXJzaW9uTmFtZSxcbiAgICB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nLndhcm4oYEVycm9yICcke2UubWVzc2FnZX0nIHdoaWxlIGdldHRpbmcgYmFkZ2luZyBpbmZvYCk7XG4gIH1cbiAgcmV0dXJuIHt9O1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIHBhY2thZ2UgaW5mbyBmcm9tIHRoZSBpbnN0YWxsZWQgYXBwbGljYXRpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBpbnN0YWxsZWQgcGFja2FnZS5cbiAqIEByZXR1cm4gez9BcHBJbmZvfSBUaGUgcGFyc2VkIGFwcGxpY2F0aW9uIGluZm9ybWF0aW9uLlxuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0UGFja2FnZUluZm8gPSBhc3luYyBmdW5jdGlvbiBnZXRQYWNrYWdlSW5mbyAocGtnKSB7XG4gIGxvZy5kZWJ1ZyhgR2V0dGluZyBwYWNrYWdlIGluZm8gZm9yICcke3BrZ30nYCk7XG4gIGxldCByZXN1bHQgPSB7bmFtZTogcGtnfTtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdGRvdXQgPSBhd2FpdCB0aGlzLnNoZWxsKFsnZHVtcHN5cycsICdwYWNrYWdlJywgcGtnXSk7XG4gICAgY29uc3QgdmVyc2lvbk5hbWVNYXRjaCA9IG5ldyBSZWdFeHAoL3ZlcnNpb25OYW1lPShbXFxkKy5dKykvKS5leGVjKHN0ZG91dCk7XG4gICAgaWYgKHZlcnNpb25OYW1lTWF0Y2gpIHtcbiAgICAgIHJlc3VsdC52ZXJzaW9uTmFtZSA9IHZlcnNpb25OYW1lTWF0Y2hbMV07XG4gICAgfVxuICAgIGNvbnN0IHZlcnNpb25Db2RlTWF0Y2ggPSBuZXcgUmVnRXhwKC92ZXJzaW9uQ29kZT0oXFxkKykvKS5leGVjKHN0ZG91dCk7XG4gICAgaWYgKHZlcnNpb25Db2RlTWF0Y2gpIHtcbiAgICAgIHJlc3VsdC52ZXJzaW9uQ29kZSA9IHBhcnNlSW50KHZlcnNpb25Db2RlTWF0Y2hbMV0sIDEwKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbG9nLndhcm4oYEVycm9yICcke2Vyci5tZXNzYWdlfScgd2hpbGUgZHVtcGluZyBwYWNrYWdlIGluZm9gKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBGZXRjaGVzIGJhc2UuYXBrIG9mIHRoZSBnaXZlbiBwYWNrYWdlIHRvIHRoZSBsb2NhbCBmaWxlIHN5c3RlbVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgVGhlIHBhY2thZ2UgaWRlbnRpZmllciAobXVzdCBiZSBhbHJlYWR5IGluc3RhbGxlZCBvbiB0aGUgZGV2aWNlKVxuICogQHBhcmFtIHtzdHJpbmd9IHRtcERpciBUaGUgZGVzdGluYXRpb24gZm9sZGVyIHBhdGhcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEZ1bGwgcGF0aCB0byB0aGUgZG93bmxvYWRlZCBmaWxlXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGZldGNoaW5nIHRoZSAuYXBrXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5wdWxsQXBrID0gYXN5bmMgZnVuY3Rpb24gcHVsbEFwayAocGtnLCB0bXBEaXIpIHtcbiAgY29uc3Qgc3Rkb3V0ID0gXy50cmltKGF3YWl0IHRoaXMuc2hlbGwoWydwbScsICdwYXRoJywgcGtnXSkpO1xuICBjb25zdCBwYWNrYWdlTWFya2VyID0gJ3BhY2thZ2U6JztcbiAgaWYgKCFfLnN0YXJ0c1dpdGgoc3Rkb3V0LCBwYWNrYWdlTWFya2VyKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHB1bGwgdGhlIC5hcGsgcGFja2FnZSBmb3IgJyR7cGtnfScuIE9yaWdpbmFsIGVycm9yOiAke3N0ZG91dH1gKTtcbiAgfVxuXG4gIGNvbnN0IHJlbW90ZVBhdGggPSBzdGRvdXQucmVwbGFjZShwYWNrYWdlTWFya2VyLCAnJyk7XG4gIGNvbnN0IHRtcEFwcCA9IHBhdGgucmVzb2x2ZSh0bXBEaXIsIGAke3BrZ30uYXBrYCk7XG4gIGF3YWl0IHRoaXMucHVsbChyZW1vdGVQYXRoLCB0bXBBcHApO1xuICBsb2cuZGVidWcoYFB1bGxlZCBhcHAgZm9yIHBhY2thZ2UgJyR7cGtnfScgdG8gJyR7dG1wQXBwfSdgKTtcbiAgcmV0dXJuIHRtcEFwcDtcbn07XG5cbi8qKlxuICogQWN0aXZhdGVzIHRoZSBnaXZlbiBhcHBsaWNhdGlvbiBvciBsYXVuY2hlcyBpdCBpZiBuZWNlc3NhcnkuXG4gKiBUaGUgYWN0aW9uIGxpdGVyYWxseSBzaW11bGF0ZXNcbiAqIGNsaWNraW5nIHRoZSBjb3JyZXNwb25kaW5nIGFwcGxpY2F0aW9uIGljb24gb24gdGhlIGRhc2hib2FyZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwSWQgLSBBcHBsaWNhdGlvbiBwYWNrYWdlIGlkZW50aWZpZXJcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgYXBwIGNhbm5vdCBiZSBhY3RpdmF0ZWRcbiAqL1xuYXBrVXRpbHNNZXRob2RzLmFjdGl2YXRlQXBwID0gYXN5bmMgZnVuY3Rpb24gYWN0aXZhdGVBcHAgKGFwcElkKSB7XG4gIGxvZy5kZWJ1ZyhgQWN0aXZhdGluZyAnJHthcHBJZH0nYCk7XG4gIGNvbnN0IGFwaUxldmVsID0gYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpO1xuICAvLyBGYWxsYmFjayB0byBNb25rZXkgaW4gb2xkZXIgQVBJc1xuICBpZiAoYXBpTGV2ZWwgPCAyNCkge1xuICAgIC8vIFRoZSBtb25rZXkgY29tbWFuZCBjb3VsZCByYWlzZSBhbiBpc3N1ZSBhcyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80NDg2MDQ3NS9ob3ctdG8tdXNlLXRoZS1tb25rZXktY29tbWFuZC13aXRoLWFuLWFuZHJvaWQtc3lzdGVtLXRoYXQtZG9lc250LWhhdmUtcGh5c2ljYWxcbiAgICAvLyBidXQgJy0tcGN0LXN5c2tleXMgMCcgY291bGQgY2F1c2UgYW5vdGhlciBiYWNrZ3JvdW5kIHByb2Nlc3MgaXNzdWUuIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtL2lzc3Vlcy8xNjk0MSNpc3N1ZWNvbW1lbnQtMTEyOTgzNzI4NVxuICAgIGNvbnN0IGNtZCA9IFsnbW9ua2V5JyxcbiAgICAgICctcCcsIGFwcElkLFxuICAgICAgJy1jJywgJ2FuZHJvaWQuaW50ZW50LmNhdGVnb3J5LkxBVU5DSEVSJyxcbiAgICAgICcxJ107XG4gICAgbGV0IG91dHB1dCA9ICcnO1xuICAgIHRyeSB7XG4gICAgICBvdXRwdXQgPSBhd2FpdCB0aGlzLnNoZWxsKGNtZCk7XG4gICAgICBsb2cuZGVidWcoYENvbW1hbmQgc3Rkb3V0OiAke291dHB1dH1gKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgQ2Fubm90IGFjdGl2YXRlICcke2FwcElkfScuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICB9XG4gICAgaWYgKG91dHB1dC5pbmNsdWRlcygnbW9ua2V5IGFib3J0ZWQnKSkge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coYENhbm5vdCBhY3RpdmF0ZSAnJHthcHBJZH0nLiBBcmUgeW91IHN1cmUgaXQgaXMgaW5zdGFsbGVkP2ApO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgYWN0aXZpdHlOYW1lID0gYXdhaXQgdGhpcy5yZXNvbHZlTGF1bmNoYWJsZUFjdGl2aXR5KGFwcElkKTtcbiAgaWYgKGFjdGl2aXR5TmFtZSA9PT0gUkVTT0xWRVJfQUNUSVZJVFlfTkFNRSkge1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtL2lzc3Vlcy8xNzEyOFxuICAgIGxvZy5kZWJ1ZyhcbiAgICAgIGBUaGUgbGF1bmNoYWJsZSBhY3Rpdml0eSBuYW1lIG9mICcke2FwcElkfScgd2FzIHJlc29sdmVkIHRvICcke2FjdGl2aXR5TmFtZX0nLiBgICtcbiAgICAgIGBTd2l0Y2hpbmcgdGhlIHJlc29sdmVyIHRvIG5vdCB1c2UgY21kYFxuICAgICk7XG4gICAgYWN0aXZpdHlOYW1lID0gYXdhaXQgdGhpcy5yZXNvbHZlTGF1bmNoYWJsZUFjdGl2aXR5KGFwcElkLCB7cHJlZmVyQ21kOiBmYWxzZX0pO1xuICB9XG5cbiAgY29uc3Qgc3Rkb3V0ID0gYXdhaXQgdGhpcy5zaGVsbChbXG4gICAgJ2FtJywgKGFwaUxldmVsIDwgMjYpID8gJ3N0YXJ0JyA6ICdzdGFydC1hY3Rpdml0eScsXG4gICAgJy1hJywgJ2FuZHJvaWQuaW50ZW50LmFjdGlvbi5NQUlOJyxcbiAgICAnLWMnLCAnYW5kcm9pZC5pbnRlbnQuY2F0ZWdvcnkuTEFVTkNIRVInLFxuICAgIC8vIEZMQUdfQUNUSVZJVFlfTkVXX1RBU0sgfCBGTEFHX0FDVElWSVRZX1JFU0VUX1RBU0tfSUZfTkVFREVEXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2FuZHJvaWQvY29udGVudC9JbnRlbnQjRkxBR19BQ1RJVklUWV9ORVdfVEFTS1xuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3JlZmVyZW5jZS9hbmRyb2lkL2NvbnRlbnQvSW50ZW50I0ZMQUdfQUNUSVZJVFlfUkVTRVRfVEFTS19JRl9ORUVERURcbiAgICAnLWYnLCAnMHgxMDIwMDAwMCcsXG4gICAgJy1uJywgYWN0aXZpdHlOYW1lLFxuICBdKTtcbiAgbG9nLmRlYnVnKHN0ZG91dCk7XG4gIGlmICgvXmVycm9yOi9taS50ZXN0KHN0ZG91dCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBhY3RpdmF0ZSAnJHthcHBJZH0nLiBPcmlnaW5hbCBlcnJvcjogJHtzdGRvdXR9YCk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IFJFTU9URV9DQUNIRV9ST09UIH07XG5leHBvcnQgZGVmYXVsdCBhcGtVdGlsc01ldGhvZHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLGVBQWUsR0FBRyxDQUFDLENBQUM7QUFFMUJBLGVBQWUsQ0FBQ0MsaUJBQWlCLEdBQUc7RUFDbENDLE9BQU8sRUFBRSxTQUFTO0VBQ2xCQyxhQUFhLEVBQUUsY0FBYztFQUM3QkMsdUJBQXVCLEVBQUUsdUJBQXVCO0VBQ2hEQyxzQkFBc0IsRUFBRSxzQkFBc0I7RUFDOUNDLHVCQUF1QixFQUFFO0FBQzNCLENBQUM7QUFDRCxNQUFNQyxpQkFBaUIsR0FBRyw4QkFBOEI7QUFBQztBQUN6RCxNQUFNQyxzQkFBc0IsR0FBRyxtREFBbUQ7QUFVbEZSLGVBQWUsQ0FBQ1MsY0FBYyxHQUFHLGVBQWVBLGNBQWMsQ0FBRUMsR0FBRyxFQUFFO0VBQ25FQyxlQUFHLENBQUNDLEtBQUssQ0FBRSw4QkFBNkJGLEdBQUksRUFBQyxDQUFDO0VBQzlDLE1BQU1HLGdCQUFnQixHQUFHLElBQUlDLE1BQU0sQ0FBRSxzQkFBcUJDLGVBQUMsQ0FBQ0MsWUFBWSxDQUFDTixHQUFHLENBQUUsWUFBVyxFQUFFLEdBQUcsQ0FBQztFQUMvRixJQUFJO0lBQ0YsTUFBTU8sTUFBTSxHQUFHLE1BQU0sSUFB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