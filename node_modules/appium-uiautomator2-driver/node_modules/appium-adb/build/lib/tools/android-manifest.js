"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _teen_process = require("teen_process");
var _logger = _interopRequireDefault(require("../logger.js"));
var _helpers = require("../helpers.js");
var _support = require("@appium/support");
var _lodash = _interopRequireDefault(require("lodash"));
var _path = _interopRequireDefault(require("path"));
var _adbkitApkreader = _interopRequireDefault(require("adbkit-apkreader"));
let manifestMethods = {};
manifestMethods.packageAndLaunchActivityFromManifest = async function packageAndLaunchActivityFromManifest(appPath) {
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractBaseApk(appPath);
  }
  let manifest;
  try {
    const apkReader = await _adbkitApkreader.default.open(appPath);
    manifest = await apkReader.readManifest();
  } catch (e) {
    _logger.default.debug(e);
    throw new Error(`Cannot extract a manifest from '${appPath}'. ` + `Is it a valid Android application?`);
  }
  const {
    pkg,
    activity
  } = (0, _helpers.parseManifest)(manifest);
  _logger.default.info(`Package name: '${pkg}'`);
  _logger.default.info(`Main activity name: '${activity}'`);
  return {
    apkPackage: pkg,
    apkActivity: activity
  };
};
manifestMethods.targetSdkVersionFromManifest = async function targetSdkVersionFromManifest(appPath) {
  _logger.default.debug(`Extracting target SDK version of '${appPath}'`);
  const originalAppPath = appPath;
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractBaseApk(appPath);
  }
  const getTargetSdkViaApkReader = async () => {
    const apkReader = await _adbkitApkreader.default.open(appPath);
    const manifest = await apkReader.readManifest();
    if (manifest.usesSdk && _lodash.default.isInteger(manifest.usesSdk.targetSdkVersion)) {
      return manifest.usesSdk.targetSdkVersion;
    }
    throw new Error('Cannot find the information about targetSdkVersion in the manifest');
  };
  const getTargetSdkViaAapt = async () => {
    await this.initAapt();
    const args = ['dump', 'badging', appPath];
    const {
      stdout
    } = await (0, _teen_process.exec)(this.binaries.aapt, args);
    const targetSdkVersion = /targetSdkVersion:'([^']+)'/g.exec(stdout);
    if (!targetSdkVersion) {
      _logger.default.debug(stdout);
      throw new Error('Cannot parse the command output');
    }
    return parseInt(targetSdkVersion[1], 10);
  };
  const versionGetters = [['ApkReader', getTargetSdkViaApkReader], ['aapt', getTargetSdkViaAapt]];
  for (const [toolName, versionGetter] of versionGetters) {
    try {
      return await versionGetter();
    } catch (e) {
      _logger.default.info(`Cannot extract targetSdkVersion of '${originalAppPath}' using ${toolName}. ` + `Original error: ${e.message}`);
    }
  }
  throw new Error(`Cannot extract the target SDK version number of '${originalAppPath}' using either of ` + `${JSON.stringify(versionGetters.map(pair => pair[0]))} tools. ` + `Check the server log for more details`);
};
manifestMethods.targetSdkVersionUsingPKG = async function targetSdkVersionUsingPKG(pkg, cmdOutput = null) {
  let stdout = cmdOutput || (await this.shell(['dumpsys', 'package', pkg]));
  let targetSdkVersion = new RegExp(/targetSdk=([^\s\s]+)/g).exec(stdout);
  if (targetSdkVersion && targetSdkVersion.length >= 2) {
    targetSdkVersion = targetSdkVersion[1];
  } else {
    targetSdkVersion = 0;
  }
  return parseInt(targetSdkVersion, 10);
};
manifestMethods.compileManifest = async function compileManifest(manifest, manifestPackage, targetPackage) {
  const {
    platform,
    platformPath
  } = await (0, _helpers.getAndroidPlatformAndPath)(this.sdkRoot);
  if (!platform) {
    throw new Error('Cannot compile the manifest. The required platform does not exist (API level >= 17)');
  }
  const resultPath = `${manifest}.apk`;
  const androidJarPath = _path.default.resolve(platformPath, 'android.jar');
  if (await _support.fs.exists(resultPath)) {
    await _support.fs.rimraf(resultPath);
  }
  try {
    await this.initAapt2();
    const args = ['link', '-o', resultPath, '--manifest', manifest, '--rename-manifest-package', manifestPackage, '--rename-instrumentation-target-package', targetPackage, '-I', androidJarPath, '-v'];
    _logger.default.debug(`Compiling the manifest using '${_support.util.quote([this.binaries.aapt2, ...args])}'`);
    await (0, _teen_process.exec)(this.binaries.aapt2, args);
  } catch (e) {
    _logger.default.debug('Cannot compile the manifest using aapt2. Defaulting to aapt. ' + `Original error: ${e.stderr || e.message}`);
    await this.initAapt();
    const args = ['package', '-M', manifest, '--rename-manifest-package', manifestPackage, '--rename-instrumentation-target-package', targetPackage, '-I', androidJarPath, '-F', resultPath, '-f'];
    _logger.default.debug(`Compiling the manifest using '${_support.util.quote([this.binaries.aapt, ...args])}'`);
    try {
      await (0, _teen_process.exec)(this.binaries.aapt, args);
    } catch (e1) {
      throw new Error(`Cannot compile the manifest. Original error: ${e1.stderr || e1.message}`);
    }
  }
  _logger.default.debug(`Compiled the manifest at '${resultPath}'`);
};
manifestMethods.insertManifest = async function insertManifest(manifest, srcApk, dstApk) {
  _logger.default.debug(`Inserting manifest '${manifest}', src: '${srcApk}', dst: '${dstApk}'`);
  await _support.zip.assertValidZip(srcApk);
  await (0, _helpers.unzipFile)(`${manifest}.apk`);
  const manifestName = _path.default.basename(manifest);
  try {
    await this.initAapt();
    await _support.fs.copyFile(srcApk, dstApk);
    _logger.default.debug('Moving manifest');
    try {
      await (0, _teen_process.exec)(this.binaries.aapt, ['remove', dstApk, manifestName]);
    } catch (ign) {}
    await (0, _teen_process.exec)(this.binaries.aapt, ['add', dstApk, manifestName], {
      cwd: _path.default.dirname(manifest)
    });
  } catch (e) {
    _logger.default.debug('Cannot insert manifest using aapt. Defaulting to zip. ' + `Original error: ${e.stderr || e.message}`);
    const tmpRoot = await _support.tempDir.openDir();
    try {
      _logger.default.debug(`Extracting the source apk at '${srcApk}'`);
      await _support.zip.extractAllTo(srcApk, tmpRoot);
      _logger.default.debug('Moving manifest');
      await _support.fs.mv(manifest, _path.default.resolve(tmpRoot, manifestName));
      _logger.default.debug(`Collecting the destination apk at '${dstApk}'`);
      await _support.zip.toArchive(dstApk, {
        cwd: tmpRoot
      });
    } finally {
      await _support.fs.rimraf(tmpRoot);
    }
  }
  _logger.default.debug(`Manifest insertion into '${dstApk}' is completed`);
};
manifestMethods.hasInternetPermissionFromManifest = async function hasInternetPermissionFromManifest(appPath) {
  _logger.default.debug(`Checking if '${appPath}' requires internet access permission in the manifest`);
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractBaseApk(appPath);
  }
  const apkReader = await _adbkitApkreader.default.open(appPath);
  const manifest = await apkReader.readManifest();
  return (manifest.usesPermissions || []).some(({
    name
  }) => name === 'android.permission.INTERNET');
};
var _default = manifestMethods;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtYW5pZmVzdE1ldGhvZHMiLCJwYWNrYWdlQW5kTGF1bmNoQWN0aXZpdHlGcm9tTWFuaWZlc3QiLCJhcHBQYXRoIiwiZW5kc1dpdGgiLCJBUEtTX0VYVEVOU0lPTiIsImV4dHJhY3RCYXNlQXBrIiwibWFuaWZlc3QiLCJhcGtSZWFkZXIiLCJBcGtSZWFkZXIiLCJvcGVuIiwicmVhZE1hbmlmZXN0IiwiZSIsImxvZyIsImRlYnVnIiwiRXJyb3IiLCJwa2ciLCJhY3Rpdml0eSIsInBhcnNlTWFuaWZlc3QiLCJpbmZvIiwiYXBrUGFja2FnZSIsImFwa0FjdGl2aXR5IiwidGFyZ2V0U2RrVmVyc2lvbkZyb21NYW5pZmVzdCIsIm9yaWdpbmFsQXBwUGF0aCIsImdldFRhcmdldFNka1ZpYUFwa1JlYWRlciIsInVzZXNTZGsiLCJfIiwiaXNJbnRlZ2VyIiwidGFyZ2V0U2RrVmVyc2lvbiIsImdldFRhcmdldFNka1ZpYUFhcHQiLCJpbml0QWFwdCIsImFyZ3MiLCJzdGRvdXQiLCJleGVjIiwiYmluYXJpZXMiLCJhYXB0IiwicGFyc2VJbnQiLCJ2ZXJzaW9uR2V0dGVycyIsInRvb2xOYW1lIiwidmVyc2lvbkdldHRlciIsIm1lc3NhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwibWFwIiwicGFpciIsInRhcmdldFNka1ZlcnNpb25Vc2luZ1BLRyIsImNtZE91dHB1dCIsInNoZWxsIiwiUmVnRXhwIiwibGVuZ3RoIiwiY29tcGlsZU1hbmlmZXN0IiwibWFuaWZlc3RQYWNrYWdlIiwidGFyZ2V0UGFja2FnZSIsInBsYXRmb3JtIiwicGxhdGZvcm1QYXRoIiwiZ2V0QW5kcm9pZFBsYXRmb3JtQW5kUGF0aCIsInNka1Jvb3QiLCJyZXN1bHRQYXRoIiwiYW5kcm9pZEphclBhdGgiLCJwYXRoIiwicmVzb2x2ZSIsImZzIiwiZXhpc3RzIiwicmltcmFmIiwiaW5pdEFhcHQyIiwidXRpbCIsInF1b3RlIiwiYWFwdDIiLCJzdGRlcnIiLCJlMSIsImluc2VydE1hbmlmZXN0Iiwic3JjQXBrIiwiZHN0QXBrIiwiemlwIiwiYXNzZXJ0VmFsaWRaaXAiLCJ1bnppcEZpbGUiLCJtYW5pZmVzdE5hbWUiLCJiYXNlbmFtZSIsImNvcHlGaWxlIiwiaWduIiwiY3dkIiwiZGlybmFtZSIsInRtcFJvb3QiLCJ0ZW1wRGlyIiwib3BlbkRpciIsImV4dHJhY3RBbGxUbyIsIm12IiwidG9BcmNoaXZlIiwiaGFzSW50ZXJuZXRQZXJtaXNzaW9uRnJvbU1hbmlmZXN0IiwidXNlc1Blcm1pc3Npb25zIiwic29tZSIsIm5hbWUiXSwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvdG9vbHMvYW5kcm9pZC1tYW5pZmVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyLmpzJztcbmltcG9ydCB7XG4gIGdldEFuZHJvaWRQbGF0Zm9ybUFuZFBhdGgsIHVuemlwRmlsZSxcbiAgQVBLU19FWFRFTlNJT04sIHBhcnNlTWFuaWZlc3QgfSBmcm9tICcuLi9oZWxwZXJzLmpzJztcbmltcG9ydCB7IGZzLCB6aXAsIHRlbXBEaXIsIHV0aWwgfSBmcm9tICdAYXBwaXVtL3N1cHBvcnQnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IEFwa1JlYWRlciBmcm9tICdhZGJraXQtYXBrcmVhZGVyJztcblxubGV0IG1hbmlmZXN0TWV0aG9kcyA9IHt9O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEFQS0luZm9cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBhcGtQYWNrYWdlIC0gVGhlIG5hbWUgb2YgYXBwbGljYXRpb24gcGFja2FnZSwgZm9yIGV4YW1wbGUgJ2NvbS5hY21lLmFwcCcuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gYXBrQWN0aXZpdHkgLSBUaGUgbmFtZSBvZiBtYWluIGFwcGxpY2F0aW9uIGFjdGl2aXR5LlxuICovXG5cbi8qKlxuICogRXh0cmFjdCBwYWNrYWdlIGFuZCBtYWluIGFjdGl2aXR5IG5hbWUgZnJvbSBhcHBsaWNhdGlvbiBtYW5pZmVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIFRoZSBmdWxsIHBhdGggdG8gYXBwbGljYXRpb24gLmFwayhzKSBwYWNrYWdlXG4gKiBAcmV0dXJuIHtBUEtJbmZvfSBUaGUgcGFyc2VkIGFwcGxpY2F0aW9uIGluZm8uXG4gKiBAdGhyb3dzIHtlcnJvcn0gSWYgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGdldHRpbmcgdGhlIGRhdGEgZnJvbSB0aGUgZ2l2ZW5cbiAqICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbiBwYWNrYWdlLlxuICovXG5tYW5pZmVzdE1ldGhvZHMucGFja2FnZUFuZExhdW5jaEFjdGl2aXR5RnJvbU1hbmlmZXN0ID0gYXN5bmMgZnVuY3Rpb24gcGFja2FnZUFuZExhdW5jaEFjdGl2aXR5RnJvbU1hbmlmZXN0IChhcHBQYXRoKSB7XG4gIGlmIChhcHBQYXRoLmVuZHNXaXRoKEFQS1NfRVhURU5TSU9OKSkge1xuICAgIGFwcFBhdGggPSBhd2FpdCB0aGlzLmV4dHJhY3RCYXNlQXBrKGFwcFBhdGgpO1xuICB9XG5cbiAgbGV0IG1hbmlmZXN0O1xuICB0cnkge1xuICAgIGNvbnN0IGFwa1JlYWRlciA9IGF3YWl0IEFwa1JlYWRlci5vcGVuKGFwcFBhdGgpO1xuICAgIG1hbmlmZXN0ID0gYXdhaXQgYXBrUmVhZGVyLnJlYWRNYW5pZmVzdCgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nLmRlYnVnKGUpO1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGV4dHJhY3QgYSBtYW5pZmVzdCBmcm9tICcke2FwcFBhdGh9Jy4gYCArXG4gICAgICBgSXMgaXQgYSB2YWxpZCBBbmRyb2lkIGFwcGxpY2F0aW9uP2ApO1xuICB9XG4gIGNvbnN0IHtwa2csIGFjdGl2aXR5fSA9IHBhcnNlTWFuaWZlc3QobWFuaWZlc3QpO1xuICBsb2cuaW5mbyhgUGFja2FnZSBuYW1lOiAnJHtwa2d9J2ApO1xuICBsb2cuaW5mbyhgTWFpbiBhY3Rpdml0eSBuYW1lOiAnJHthY3Rpdml0eX0nYCk7XG4gIHJldHVybiB7XG4gICAgYXBrUGFja2FnZTogcGtnLFxuICAgIGFwa0FjdGl2aXR5OiBhY3Rpdml0eSxcbiAgfTtcbn07XG5cbi8qKlxuICogRXh0cmFjdCB0YXJnZXQgU0RLIHZlcnNpb24gZnJvbSBhcHBsaWNhdGlvbiBtYW5pZmVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIFRoZSBmdWxsIHBhdGggdG8gLmFwayhzKSBwYWNrYWdlLlxuICogQHJldHVybiB7bnVtYmVyfSBUaGUgdmVyc2lvbiBvZiB0aGUgdGFyZ2V0IFNESy5cbiAqIEB0aHJvd3Mge2Vycm9yfSBJZiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgZ2V0dGluZyB0aGUgZGF0YSBmcm9tIHRoZSBnaXZlblxuICogICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uIHBhY2thZ2UuXG4gKi9cbm1hbmlmZXN0TWV0aG9kcy50YXJnZXRTZGtWZXJzaW9uRnJvbU1hbmlmZXN0ID0gYXN5bmMgZnVuY3Rpb24gdGFyZ2V0U2RrVmVyc2lvbkZyb21NYW5pZmVzdCAoYXBwUGF0aCkge1xuICBsb2cuZGVidWcoYEV4dHJhY3RpbmcgdGFyZ2V0IFNESyB2ZXJzaW9uIG9mICcke2FwcFBhdGh9J2ApO1xuICBjb25zdCBvcmlnaW5hbEFwcFBhdGggPSBhcHBQYXRoO1xuICBpZiAoYXBwUGF0aC5lbmRzV2l0aChBUEtTX0VYVEVOU0lPTikpIHtcbiAgICBhcHBQYXRoID0gYXdhaXQgdGhpcy5leHRyYWN0QmFzZUFwayhhcHBQYXRoKTtcbiAgfVxuXG4gIGNvbnN0IGdldFRhcmdldFNka1ZpYUFwa1JlYWRlciA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBhcGtSZWFkZXIgPSBhd2FpdCBBcGtSZWFkZXIub3BlbihhcHBQYXRoKTtcbiAgICBjb25zdCBtYW5pZmVzdCA9IGF3YWl0IGFwa1JlYWRlci5yZWFkTWFuaWZlc3QoKTtcbiAgICBpZiAobWFuaWZlc3QudXNlc1NkayAmJiBfLmlzSW50ZWdlcihtYW5pZmVzdC51c2VzU2RrLnRhcmdldFNka1ZlcnNpb24pKSB7XG4gICAgICByZXR1cm4gbWFuaWZlc3QudXNlc1Nkay50YXJnZXRTZGtWZXJzaW9uO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBmaW5kIHRoZSBpbmZvcm1hdGlvbiBhYm91dCB0YXJnZXRTZGtWZXJzaW9uIGluIHRoZSBtYW5pZmVzdCcpO1xuICB9O1xuICBjb25zdCBnZXRUYXJnZXRTZGtWaWFBYXB0ID0gYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdEFhcHQoKTtcbiAgICBjb25zdCBhcmdzID0gWydkdW1wJywgJ2JhZGdpbmcnLCBhcHBQYXRoXTtcbiAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWModGhpcy5iaW5hcmllcy5hYXB0LCBhcmdzKTtcbiAgICBjb25zdCB0YXJnZXRTZGtWZXJzaW9uID0gL3RhcmdldFNka1ZlcnNpb246JyhbXiddKyknL2cuZXhlYyhzdGRvdXQpO1xuICAgIGlmICghdGFyZ2V0U2RrVmVyc2lvbikge1xuICAgICAgbG9nLmRlYnVnKHN0ZG91dCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBwYXJzZSB0aGUgY29tbWFuZCBvdXRwdXQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlSW50KHRhcmdldFNka1ZlcnNpb25bMV0sIDEwKTtcbiAgfTtcbiAgY29uc3QgdmVyc2lvbkdldHRlcnMgPSBbXG4gICAgWydBcGtSZWFkZXInLCBnZXRUYXJnZXRTZGtWaWFBcGtSZWFkZXJdLFxuICAgIFsnYWFwdCcsIGdldFRhcmdldFNka1ZpYUFhcHRdLFxuICBdO1xuICBmb3IgKGNvbnN0IFt0b29sTmFtZSwgdmVyc2lvbkdldHRlcl0gb2YgdmVyc2lvbkdldHRlcnMpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHZlcnNpb25HZXR0ZXIoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuaW5mbyhgQ2Fubm90IGV4dHJhY3QgdGFyZ2V0U2RrVmVyc2lvbiBvZiAnJHtvcmlnaW5hbEFwcFBhdGh9JyB1c2luZyAke3Rvb2xOYW1lfS4gYCArXG4gICAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG4gIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGV4dHJhY3QgdGhlIHRhcmdldCBTREsgdmVyc2lvbiBudW1iZXIgb2YgJyR7b3JpZ2luYWxBcHBQYXRofScgdXNpbmcgZWl0aGVyIG9mIGAgK1xuICAgIGAke0pTT04uc3RyaW5naWZ5KHZlcnNpb25HZXR0ZXJzLm1hcCgocGFpcikgPT4gcGFpclswXSkpfSB0b29scy4gYCArXG4gICAgYENoZWNrIHRoZSBzZXJ2ZXIgbG9nIGZvciBtb3JlIGRldGFpbHNgKTtcbn07XG5cbi8qKlxuICogRXh0cmFjdCB0YXJnZXQgU0RLIHZlcnNpb24gZnJvbSBwYWNrYWdlIGluZm9ybWF0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgY2xhc3MgbmFtZSBvZiB0aGUgcGFja2FnZSBpbnN0YWxsZWQgb24gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICogQHBhcmFtIHs/c3RyaW5nfSBjbWRPdXRwdXQgLSBPcHRpb25hbCBwYXJhbWV0ZXIgY29udGFpbmluZyB0aGUgb3V0cHV0IG9mXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9kdW1wc3lzIHBhY2thZ2VfIGNvbW1hbmQuIEl0IG1heSBzcGVlZCB1cCB0aGUgbWV0aG9kIGV4ZWN1dGlvbi5cbiAqIEByZXR1cm4ge251bWJlcn0gVGhlIHZlcnNpb24gb2YgdGhlIHRhcmdldCBTREsuXG4gKi9cbm1hbmlmZXN0TWV0aG9kcy50YXJnZXRTZGtWZXJzaW9uVXNpbmdQS0cgPSBhc3luYyBmdW5jdGlvbiB0YXJnZXRTZGtWZXJzaW9uVXNpbmdQS0cgKHBrZywgY21kT3V0cHV0ID0gbnVsbCkge1xuICBsZXQgc3Rkb3V0ID0gY21kT3V0cHV0IHx8IGF3YWl0IHRoaXMuc2hlbGwoWydkdW1wc3lzJywgJ3BhY2thZ2UnLCBwa2ddKTtcbiAgbGV0IHRhcmdldFNka1ZlcnNpb24gPSBuZXcgUmVnRXhwKC90YXJnZXRTZGs9KFteXFxzXFxzXSspL2cpLmV4ZWMoc3Rkb3V0KTtcbiAgaWYgKHRhcmdldFNka1ZlcnNpb24gJiYgdGFyZ2V0U2RrVmVyc2lvbi5sZW5ndGggPj0gMikge1xuICAgIHRhcmdldFNka1ZlcnNpb24gPSB0YXJnZXRTZGtWZXJzaW9uWzFdO1xuICB9IGVsc2Uge1xuICAgIC8vIHRhcmdldFNkayBub3QgZm91bmQgaW4gdGhlIGR1bXAsIGFzc2lnbmluZyAwIHRvIHRhcmdldFNka1ZlcnNpb25cbiAgICB0YXJnZXRTZGtWZXJzaW9uID0gMDtcbiAgfVxuICByZXR1cm4gcGFyc2VJbnQodGFyZ2V0U2RrVmVyc2lvbiwgMTApO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYmluYXJ5IHJlcHJlc2VudGF0aW9uIG9mIHBhY2thZ2UgbWFuaWZlc3QgKHVzdWFsbHkgQW5kcm9pZE1hbmlmZXN0LnhtbCkuXG4gKiBgJHttYW5pZmVzdH0uYXBrYCBmaWxlIHdpbGwgYmUgY3JlYXRlZCBhcyB0aGUgcmVzdWx0IG9mIHRoaXMgbWV0aG9kXG4gKiBjb250YWluaW5nIHRoZSBjb21waWxlZCBtYW5pZmVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWFuaWZlc3QgLSBGdWxsIHBhdGggdG8gdGhlIGluaXRpYWwgbWFuaWZlc3QgdGVtcGxhdGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBtYW5pZmVzdFBhY2thZ2UgLSBUaGUgbmFtZSBvZiB0aGUgbWFuaWZlc3QgcGFja2FnZVxuICogQHBhcmFtIHtzdHJpbmd9IHRhcmdldFBhY2thZ2UgLSBUaGUgbmFtZSBvZiB0aGUgZGVzdGluYXRpb24gcGFja2FnZVxuICovXG5tYW5pZmVzdE1ldGhvZHMuY29tcGlsZU1hbmlmZXN0ID0gYXN5bmMgZnVuY3Rpb24gY29tcGlsZU1hbmlmZXN0IChtYW5pZmVzdCwgbWFuaWZlc3RQYWNrYWdlLCB0YXJnZXRQYWNrYWdlKSB7XG4gIGNvbnN0IHtwbGF0Zm9ybSwgcGxhdGZvcm1QYXRofSA9IGF3YWl0IGdldEFuZHJvaWRQbGF0Zm9ybUFuZFBhdGgodGhpcy5zZGtSb290KTtcbiAgaWYgKCFwbGF0Zm9ybSkge1xuICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGNvbXBpbGUgdGhlIG1hbmlmZXN0LiBUaGUgcmVxdWlyZWQgcGxhdGZvcm0gZG9lcyBub3QgZXhpc3QgKEFQSSBsZXZlbCA+PSAxNyknKTtcbiAgfVxuICBjb25zdCByZXN1bHRQYXRoID0gYCR7bWFuaWZlc3R9LmFwa2A7XG4gIGNvbnN0IGFuZHJvaWRKYXJQYXRoID0gcGF0aC5yZXNvbHZlKHBsYXRmb3JtUGF0aCwgJ2FuZHJvaWQuamFyJyk7XG4gIGlmIChhd2FpdCBmcy5leGlzdHMocmVzdWx0UGF0aCkpIHtcbiAgICBhd2FpdCBmcy5yaW1yYWYocmVzdWx0UGF0aCk7XG4gIH1cbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmluaXRBYXB0MigpO1xuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3N0dWRpby9jb21tYW5kLWxpbmUvYWFwdDJcbiAgICBjb25zdCBhcmdzID0gW1xuICAgICAgJ2xpbmsnLFxuICAgICAgJy1vJywgcmVzdWx0UGF0aCxcbiAgICAgICctLW1hbmlmZXN0JywgbWFuaWZlc3QsXG4gICAgICAnLS1yZW5hbWUtbWFuaWZlc3QtcGFja2FnZScsIG1hbmlmZXN0UGFja2FnZSxcbiAgICAgICctLXJlbmFtZS1pbnN0cnVtZW50YXRpb24tdGFyZ2V0LXBhY2thZ2UnLCB0YXJnZXRQYWNrYWdlLFxuICAgICAgJy1JJywgYW5kcm9pZEphclBhdGgsXG4gICAgICAnLXYnLFxuICAgIF07XG4gICAgbG9nLmRlYnVnKGBDb21waWxpbmcgdGhlIG1hbmlmZXN0IHVzaW5nICcke3V0aWwucXVvdGUoW3RoaXMuYmluYXJpZXMuYWFwdDIsIC4uLmFyZ3NdKX0nYCk7XG4gICAgYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQyLCBhcmdzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZy5kZWJ1ZygnQ2Fubm90IGNvbXBpbGUgdGhlIG1hbmlmZXN0IHVzaW5nIGFhcHQyLiBEZWZhdWx0aW5nIHRvIGFhcHQuICcgK1xuICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2Uuc3RkZXJyIHx8IGUubWVzc2FnZX1gKTtcbiAgICBhd2FpdCB0aGlzLmluaXRBYXB0KCk7XG4gICAgY29uc3QgYXJncyA9IFtcbiAgICAgICdwYWNrYWdlJyxcbiAgICAgICctTScsIG1hbmlmZXN0LFxuICAgICAgJy0tcmVuYW1lLW1hbmlmZXN0LXBhY2thZ2UnLCBtYW5pZmVzdFBhY2thZ2UsXG4gICAgICAnLS1yZW5hbWUtaW5zdHJ1bWVudGF0aW9uLXRhcmdldC1wYWNrYWdlJywgdGFyZ2V0UGFja2FnZSxcbiAgICAgICctSScsIGFuZHJvaWRKYXJQYXRoLFxuICAgICAgJy1GJywgcmVzdWx0UGF0aCxcbiAgICAgICctZicsXG4gICAgXTtcbiAgICBsb2cuZGVidWcoYENvbXBpbGluZyB0aGUgbWFuaWZlc3QgdXNpbmcgJyR7dXRpbC5xdW90ZShbdGhpcy5iaW5hcmllcy5hYXB0LCAuLi5hcmdzXSl9J2ApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBleGVjKHRoaXMuYmluYXJpZXMuYWFwdCwgYXJncyk7XG4gICAgfSBjYXRjaCAoZTEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGNvbXBpbGUgdGhlIG1hbmlmZXN0LiBPcmlnaW5hbCBlcnJvcjogJHtlMS5zdGRlcnIgfHwgZTEubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cbiAgbG9nLmRlYnVnKGBDb21waWxlZCB0aGUgbWFuaWZlc3QgYXQgJyR7cmVzdWx0UGF0aH0nYCk7XG59O1xuXG4vKipcbiAqIFJlcGxhY2UvaW5zZXJ0IHRoZSBzcGVjaWFsbHkgcHJlY29tcGlsZWQgbWFuaWZlc3QgZmlsZSBpbnRvIHRoZVxuICogcGFydGljdWxhciBwYWNrYWdlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtYW5pZmVzdCAtIEZ1bGwgcGF0aCB0byB0aGUgcHJlY29tcGlsZWQgbWFuaWZlc3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQgYnkgYGNvbXBpbGVNYW5pZmVzdGAgbWV0aG9kIGNhbGxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhvdXQgLmFwayBleHRlbnNpb25cbiAqIEBwYXJhbSB7c3RyaW5nfSBzcmNBcGsgLSBGdWxsIHBhdGggdG8gdGhlIGV4aXN0aW5nIHZhbGlkIGFwcGxpY2F0aW9uIHBhY2thZ2UsIHdoZXJlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyBtYW5pZmVzdCBoYXMgdG8gYmUgaW5zZXRyZWQgdG8uIFRoaXMgcGFja2FnZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgIHdpbGwgTk9UIGJlIG1vZGlmaWVkLlxuICogQHBhcmFtIHtzdHJpbmd9IGRzdEFwayAtIEZ1bGwgcGF0aCB0byB0aGUgcmVzdWx0aW5nIHBhY2thZ2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIGZpbGUgd2lsbCBiZSBvdmVycmlkZGVuIGlmIGl0IGFscmVhZHkgZXhpc3RzLlxuICovXG5tYW5pZmVzdE1ldGhvZHMuaW5zZXJ0TWFuaWZlc3QgPSBhc3luYyBmdW5jdGlvbiBpbnNlcnRNYW5pZmVzdCAobWFuaWZlc3QsIHNyY0FwaywgZHN0QXBrKSB7XG4gIGxvZy5kZWJ1ZyhgSW5zZXJ0aW5nIG1hbmlmZXN0ICcke21hbmlmZXN0fScsIHNyYzogJyR7c3JjQXBrfScsIGRzdDogJyR7ZHN0QXBrfSdgKTtcbiAgYXdhaXQgemlwLmFzc2VydFZhbGlkWmlwKHNyY0Fwayk7XG4gIGF3YWl0IHVuemlwRmlsZShgJHttYW5pZmVzdH0uYXBrYCk7XG4gIGNvbnN0IG1hbmlmZXN0TmFtZSA9IHBhdGguYmFzZW5hbWUobWFuaWZlc3QpO1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuaW5pdEFhcHQoKTtcbiAgICBhd2FpdCBmcy5jb3B5RmlsZShzcmNBcGssIGRzdEFwayk7XG4gICAgbG9nLmRlYnVnKCdNb3ZpbmcgbWFuaWZlc3QnKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQsIFtcbiAgICAgICAgJ3JlbW92ZScsIGRzdEFwaywgbWFuaWZlc3ROYW1lXG4gICAgICBdKTtcbiAgICB9IGNhdGNoIChpZ24pIHt9XG4gICAgYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQsIFtcbiAgICAgICdhZGQnLCBkc3RBcGssIG1hbmlmZXN0TmFtZVxuICAgIF0sIHtjd2Q6IHBhdGguZGlybmFtZShtYW5pZmVzdCl9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZy5kZWJ1ZygnQ2Fubm90IGluc2VydCBtYW5pZmVzdCB1c2luZyBhYXB0LiBEZWZhdWx0aW5nIHRvIHppcC4gJyArXG4gICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZS5zdGRlcnIgfHwgZS5tZXNzYWdlfWApO1xuICAgIGNvbnN0IHRtcFJvb3QgPSBhd2FpdCB0ZW1wRGlyLm9wZW5EaXIoKTtcbiAgICB0cnkge1xuICAgICAgLy8gVW5mb3J0dW5hdGVseSBOb2RlSlMgZG9lcyBub3QgcHJvdmlkZSBhbnkgcmVsaWFibGUgbWV0aG9kc1xuICAgICAgLy8gdG8gcmVwbGFjZSBmaWxlcyBpbnNpZGUgemlwIGFyY2hpdmVzIHdpdGhvdXQgbG9hZGluZyB0aGVcbiAgICAgIC8vIHdob2xlIGFyY2hpdmUgY29udGVudCBpbnRvIFJBTVxuICAgICAgbG9nLmRlYnVnKGBFeHRyYWN0aW5nIHRoZSBzb3VyY2UgYXBrIGF0ICcke3NyY0Fwa30nYCk7XG4gICAgICBhd2FpdCB6aXAuZXh0cmFjdEFsbFRvKHNyY0FwaywgdG1wUm9vdCk7XG4gICAgICBsb2cuZGVidWcoJ01vdmluZyBtYW5pZmVzdCcpO1xuICAgICAgYXdhaXQgZnMubXYobWFuaWZlc3QsIHBhdGgucmVzb2x2ZSh0bXBSb290LCBtYW5pZmVzdE5hbWUpKTtcbiAgICAgIGxvZy5kZWJ1ZyhgQ29sbGVjdGluZyB0aGUgZGVzdGluYXRpb24gYXBrIGF0ICcke2RzdEFwa30nYCk7XG4gICAgICBhd2FpdCB6aXAudG9BcmNoaXZlKGRzdEFwaywge1xuICAgICAgICBjd2Q6IHRtcFJvb3QsXG4gICAgICB9KTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgYXdhaXQgZnMucmltcmFmKHRtcFJvb3QpO1xuICAgIH1cbiAgfVxuICBsb2cuZGVidWcoYE1hbmlmZXN0IGluc2VydGlvbiBpbnRvICcke2RzdEFwa30nIGlzIGNvbXBsZXRlZGApO1xufTtcblxuLyoqXG4gKiBDaGVjayB3aGV0aGVyIHBhY2thZ2UgbWFuaWZlc3QgY29udGFpbnMgSW50ZXJuZXQgcGVybWlzc2lvbnMuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIC5hcGsocykgcGFja2FnZS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIG1hbmlmZXN0IHJlcXVpcmVzIEludGVybmV0IGFjY2VzcyBwZXJtaXNzaW9uLlxuICovXG5tYW5pZmVzdE1ldGhvZHMuaGFzSW50ZXJuZXRQZXJtaXNzaW9uRnJvbU1hbmlmZXN0ID0gYXN5bmMgZnVuY3Rpb24gaGFzSW50ZXJuZXRQZXJtaXNzaW9uRnJvbU1hbmlmZXN0IChhcHBQYXRoKSB7XG4gIGxvZy5kZWJ1ZyhgQ2hlY2tpbmcgaWYgJyR7YXBwUGF0aH0nIHJlcXVpcmVzIGludGVybmV0IGFjY2VzcyBwZXJtaXNzaW9uIGluIHRoZSBtYW5pZmVzdGApO1xuICBpZiAoYXBwUGF0aC5lbmRzV2l0aChBUEtTX0VYVEVOU0lPTikpIHtcbiAgICBhcHBQYXRoID0gYXdhaXQgdGhpcy5leHRyYWN0QmFzZUFwayhhcHBQYXRoKTtcbiAgfVxuXG4gIGNvbnN0IGFwa1JlYWRlciA9IGF3YWl0IEFwa1JlYWRlci5vcGVuKGFwcFBhdGgpO1xuICBjb25zdCBtYW5pZmVzdCA9IGF3YWl0IGFwa1JlYWRlci5yZWFkTWFuaWZlc3QoKTtcbiAgcmV0dXJuIChtYW5pZmVzdC51c2VzUGVybWlzc2lvbnMgfHwgW10pLnNvbWUoKHtuYW1lfSkgPT4gbmFtZSA9PT0gJ2FuZHJvaWQucGVybWlzc2lvbi5JTlRFUk5FVCcpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgbWFuaWZlc3RNZXRob2RzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsSUFBSUEsZUFBZSxHQUFHLENBQUMsQ0FBQztBQWdCeEJBLGVBQWUsQ0FBQ0Msb0NBQW9DLEdBQUcsZUFBZUEsb0NBQW9DLENBQUVDLE9BQU8sRUFBRTtFQUNuSCxJQUFJQSxPQUFPLENBQUNDLFFBQVEsQ0FBQ0MsdUJBQWMsQ0FBQyxFQUFFO0lBQ3BDRixPQUFPLEdBQUcsTUFBTSxJQUFJLENBQUNHLGNBQWMsQ0FBQ0gsT0FBTyxDQUFDO0VBQzlDO0VBRUEsSUFBSUksUUFBUTtFQUNaLElBQUk7SUFDRixNQUFNQyxTQUFTLEdBQUcsTUFBTUMsd0JBQVMsQ0FBQ0MsSUFBSSxDQUFDUCxPQUFPLENBQUM7SUFDL0NJLFFBQVEsR0FBRyxNQUFNQyxTQUFTLENBQUNHLFlBQVksRUFBRTtFQUMzQyxDQUFDLENBQUMsT0FBT0MsQ0FBQyxFQUFFO0lBQ1ZDLGVBQUcsQ0FBQ0MsS0FBSyxDQUFDRixDQUFDLENBQUM7SUFDWixNQUFNLElBQUlHLEtBQUssQ0FBRSxtQ0FBa0NaLE9BQVEsS0FBSSxHQUM1RCxvQ0FBbUMsQ0FBQztFQUN6QztFQUNBLE1BQU07SUFBQ2EsR0FBRztJQUFFQztFQUFRLENBQUMsR0FBRyxJQUFBQyxzQkFBYSxFQUFDWCxRQUFRLENBQUM7RUFDL0NNLGVBQUcsQ0FBQ00sSUFBSSxDQUFFLGtCQUFpQkgsR0FBSSxHQUFFLENBQUM7RUFDbENILGVBQUcsQ0FBQ00sSUFBSSxDQUFFLHdCQUF1QkYsUUFBUyxHQUFFLENBQUM7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