"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "DEFAULT_ADB_EXEC_TIMEOUT", {
  enumerable: true,
  get: function () {
    return _helpers.DEFAULT_ADB_EXEC_TIMEOUT;
  }
});
exports.default = void 0;
exports.getAndroidBinaryPath = getAndroidBinaryPath;
require("source-map-support/register");
var _path = _interopRequireDefault(require("path"));
var _logger = _interopRequireDefault(require("../logger.js"));
var _bluebird = _interopRequireDefault(require("bluebird"));
var _support = require("@appium/support");
var _helpers = require("../helpers");
var _teen_process = require("teen_process");
var _asyncbox = require("asyncbox");
var _lodash = _interopRequireDefault(require("lodash"));
var _semver = _interopRequireDefault(require("semver"));
let systemCallMethods = {};
const DEFAULT_ADB_REBOOT_RETRIES = 90;
const LINKER_WARNING_REGEXP = /^WARNING: linker.+$/m;
const ADB_RETRY_ERROR_PATTERNS = [/protocol fault \(no status\)/i, /error: device ('.+' )?not found/i, /error: device still connecting/i];
const BINARY_VERSION_PATTERN = /^Version ([\d.]+)-(\d+)/m;
const BRIDGE_VERSION_PATTERN = /^Android Debug Bridge version ([\d.]+)/m;
const CERTS_ROOT = '/system/etc/security/cacerts';
const SDK_BINARY_ROOTS = ['platform-tools', 'emulator', ['cmdline-tools', 'latest', 'bin'], 'tools', ['tools', 'bin'], '.'];
const MIN_DELAY_ADB_API_LEVEL = 28;
const REQUIRED_SERVICES = ['activity', 'package', 'mount'];
systemCallMethods.getSdkBinaryPath = async function getSdkBinaryPath(binaryName) {
  return await this.getBinaryFromSdkRoot(binaryName);
};
systemCallMethods.getBinaryNameForOS = _lodash.default.memoize(function getBinaryNameForOSMemorize(binaryName) {
  return getBinaryNameForOS(binaryName);
});
function getBinaryNameForOS(binaryName) {
  if (!_support.system.isWindows()) {
    return binaryName;
  }
  if (['android', 'apksigner', 'apkanalyzer'].includes(binaryName)) {
    return `${binaryName}.bat`;
  }
  if (!_path.default.extname(binaryName)) {
    return `${binaryName}.exe`;
  }
  return binaryName;
}
systemCallMethods.getBinaryFromSdkRoot = async function getBinaryFromSdkRoot(binaryName) {
  if (this.binaries[binaryName]) {
    return this.binaries[binaryName];
  }
  const fullBinaryName = this.getBinaryNameForOS(binaryName);
  const binaryLocs = getSdkBinaryLocationCandidates(this.sdkRoot, fullBinaryName);
  let buildToolsDirs = await (0, _helpers.getBuildToolsDirs)(this.sdkRoot);
  if (this.buildToolsVersion) {
    buildToolsDirs = buildToolsDirs.filter(x => _path.default.basename(x) === this.buildToolsVersion);
    if (_lodash.default.isEmpty(buildToolsDirs)) {
      _logger.default.info(`Found no build tools whose version matches to '${this.buildToolsVersion}'`);
    } else {
      _logger.default.info(`Using build tools at '${buildToolsDirs}'`);
    }
  }
  binaryLocs.push(..._lodash.default.flatten(buildToolsDirs.map(dir => [_path.default.resolve(dir, fullBinaryName), _path.default.resolve(dir, 'lib', fullBinaryName)])));
  let binaryLoc = null;
  for (const loc of binaryLocs) {
    if (await _support.fs.exists(loc)) {
      binaryLoc = loc;
      break;
    }
  }
  if (_lodash.default.isNull(binaryLoc)) {
    throw new Error(`Could not find '${fullBinaryName}' in ${JSON.stringify(binaryLocs)}. ` + `Do you have Android Build Tools ${this.buildToolsVersion ? `v ${this.buildToolsVersion} ` : ''}` + `installed at '${this.sdkRoot}'?`);
  }
  _logger.default.info(`Using '${fullBinaryName}' from '${binaryLoc}'`);
  this.binaries[binaryName] = binaryLoc;
  return binaryLoc;
};
function getSdkBinaryLocationCandidates(sdkRoot, fullBinaryName) {
  return SDK_BINARY_ROOTS.map(x => _path.default.resolve(sdkRoot, ...(_lodash.default.isArray(x) ? x : [x]), fullBinaryName));
}
async function getAndroidBinaryPath(binaryName) {
  const fullBinaryName = getBinaryNameForOS(binaryName);
  const sdkRoot = (0, _helpers.getSdkRootFromEnv)();
  const binaryLocs = getSdkBinaryLocationCandidates(sdkRoot, fullBinaryName);
  for (const loc of binaryLocs) {
    if (await _support.fs.exists(loc)) {
      return loc;
    }
  }
  throw new Error(`Could not find '${fullBinaryName}' in ${JSON.stringify(binaryLocs)}. ` + `Do you have Android Build Tools installed at '${sdkRoot}'?`);
}
systemCallMethods.getBinaryFromPath = async function getBinaryFromPath(binaryName) {
  if (this.binaries[binaryName]) {
    return this.binaries[binaryName];
  }
  const fullBinaryName = this.getBinaryNameForOS(binaryName);
  try {
    const binaryLoc = await _support.fs.which(fullBinaryName);
    _logger.default.info(`Using '${fullBinaryName}' from '${binaryLoc}'`);
    this.binaries[binaryName] = binaryLoc;
    return binaryLoc;
  } catch (e) {
    throw new Error(`Could not find '${fullBinaryName}' in PATH. Please set the ANDROID_HOME ` + `or ANDROID_SDK_ROOT environment variables to the correct Android SDK root directory path.`);
  }
};
systemCallMethods.getConnectedDevices = async function getConnectedDevices(opts = {}) {
  _logger.default.debug('Getting connected devices');
  const args = [...this.executable.defaultArgs, 'devices'];
  if (opts.verbose) {
    args.push('-l');
  }
  let stdout;
  try {
    ({
      stdout
    } = await (0, _teen_process.exec)(this.executable.path, args));
  } catch (e) {
    throw new Error(`Error while getting connected devices. Original error: ${e.message}`);
  }
  const listHeader = 'List of devices';
  const startingIndex = stdout.indexOf(listHeader);
  if (startingIndex < 0) {
    throw new Error(`Unexpected output while trying to get devices: ${stdout}`);
  }
  stdout = stdout.slice(startingIndex);
  let excludedLines = [listHeader, 'adb server', '* daemon'];
  if (!this.allowOfflineDevices) {
    excludedLines.push('offline');
  }
  const devices = stdout.split('\n').map(_lodash.default.trim).filter(line => line && !excludedLines.some(x => line.includes(x))).map(line => {
    const [udid, state, ...description] = line.split(/\s+/);
    const device = {
      udid,
      state
    };
    if (opts.verbose) {
      for (const entry of description) {
        if (entry.includes(':')) {
          const [key, value] = entry.split(':');
          device[key] = value;
        }
      }
    }
    return device;
  });
  if (_lodash.default.isEmpty(devices)) {
    _logger.default.debug('No connected devices have been detected');
  } else {
    _logger.default.debug(`Connected devices: ${JSON.stringify(devices)}`);
  }
  return devices;
};
systemCallMethods.getDevicesWithRetry = async function getDevicesWithRetry(timeoutMs = 20000) {
  const timer = new _support.timing.Timer().start();
  _logger.default.debug('Trying to find a connected android device');
  const getDevices = async () => {
    if (timer.getDuration().asMilliSeconds > timeoutMs) {
      throw new Error(`Could not find a connected Android device in ${timer.getDuration().asMilliSeconds.toFixed(0)}ms.`);
    }
    try {
      const devices = await this.getConnectedDevices();
      if (devices.length > 0) {
        return devices;
      }
    } catch (ign) {}
    _logger.default.debug('Could not find online devices');
    try {
      await this.reconnect();
    } catch (ign) {
      await this.restartAdb();
    }
    await (0, _asyncbox.sleep)(200);
    return await getDevices();
  };
  return await getDevices();
};
systemCallMethods.reconnect = async function reconnect(target = 'offline') {
  _logger.default.debug(`Reconnecting adb (target ${target})`);
  const args = ['reconnect'];
  if (target) {
    args.push(target);
  }
  try {
    await this.adbExec(args);
  } catch (e) {
    throw new Error(`Cannot reconnect adb. Original error: ${e.stderr || e.message}`);
  }
};
systemCallMethods.restartAdb = async function restartAdb() {
  if (this.suppressKillServer) {
    _logger.default.debug(`Not restarting abd since 'suppressKillServer' is on`);
    return;
  }
  _logger.default.debug('Restarting adb');
  try {
    await this.killServer();
    await this.adbExec(['start-server']);
  } catch (e) {
    _logger.default.error(`Error killing ADB server, going to see if it's online anyway`);
  }
};
systemCallMethods.killServer = async function killServer() {
  _logger.default.debug(`Killing adb server on port '${this.adbPort}'`);
  await this.adbExec(['kill-server'], {
    exclusive: true
  });
};
systemCallMethods.resetTelnetAuthToken = _lodash.default.memoize(async function resetTelnetAuthToken() {
  const homeFolderPath = process.env[process.platform === 'win32' ? 'USERPROFILE' : 'HOME'];
  if (!homeFolderPath) {
    _logger.default.warn(`Cannot find the path to user home folder. Ignoring resetting of emulator's telnet authentication token`);
    return false;
  }
  const dstPath = _path.default.resolve(homeFolderPath, '.emulator_console_auth_token');
  _logger.default.debug(`Overriding ${dstPath} with an empty string to avoid telnet authentication for emulator commands`);
  try {
    await _support.fs.writeFile(dstPath, '');
  } catch (e) {
    _logger.default.warn(`Error ${e.message} while resetting the content of ${dstPath}. Ignoring resetting of emulator's telnet authentication token`);
    return false;
  }
  return true;
});
systemCallMethods.adbExecEmu = async function adbExecEmu(cmd) {
  await this.verifyEmulatorConnected();
  await this.resetTelnetAuthToken();
  await this.adbExec(['emu', ...cmd]);
};
let isExecLocked = false;
systemCallMethods.EXEC_OUTPUT_FORMAT = Object.freeze({
  STDOUT: 'stdout',
  FULL: 'full'
});
systemCallMethods.adbExec = async function adbExec(cmd, opts = {}) {
  if (!cmd) {
    throw new Error('You need to pass in a command to adbExec()');
  }
  opts = _lodash.default.cloneDeep(opts);
  opts.timeout = opts.timeout || this.adbExecTimeout || _helpers.DEFAULT_ADB_EXEC_TIMEOUT;
  opts.timeoutCapName = opts.timeoutCapName || 'adbExecTimeout';
  const {
    outputFormat = this.EXEC_OUTPUT_FORMAT.STDOUT
  } = opts;
  cmd = _lodash.default.isArray(cmd) ? cmd : [cmd];
  let adbRetried = false;
  const execFunc = async () => {
    try {
      const args = [...this.executable.defaultArgs, ...cmd];
      _logger.default.debug(`Running '${this.executable.path} ` + (args.find(arg => /\s+/.test(arg)) ? _support.util.quote(args) : args.join(' ')) + `'`);
      let {
        stdout,
        stderr
      } = await (0, _teen_process.exec)(this.executable.path, args, opts);
      stdout = stdout.replace(LINKER_WARNING_REGEXP, '').trim();
      return outputFormat === this.EXEC_OUTPUT_FORMAT.FULL ? {
        stdout,
        stderr
      } : stdout;
    } catch (e) {
      const errText = `${e.message}, ${e.stdout}, ${e.stderr}`;
      if (ADB_RETRY_ERROR_PATTERNS.some(p => p.test(errText))) {
        _logger.default.info(`Error sending command, reconnecting device and retrying: ${cmd}`);
        await (0, _asyncbox.sleep)(1000);
        await this.getDevicesWithRetry();
        if (adbRetried) {
          adbRetried = true;
          return await execFunc();
        }
      }
      if (e.code === 0 && e.stdout) {
        return e.stdout.replace(LINKER_WARNING_REGEXP, '').trim();
      }
      if (_lodash.default.isNull(e.code)) {
        e.message = `Error executing adbExec. Original error: '${e.message}'. ` + `Try to increase the ${opts.timeout}ms adb execution timeout represented by '${opts.timeoutCapName}' capability`;
      } else {
        e.message = `Error executing adbExec. Original error: '${e.message}'; ` + `Command output: ${e.stderr || e.stdout || '<empty>'}`;
      }
      throw e;
    }
  };
  if (isExecLocked) {
    _logger.default.debug('Waiting until the other exclusive ADB command is completed');
    await (0, _asyncbox.waitForCondition)(() => !isExecLocked, {
      waitMs: Number.MAX_SAFE_INTEGER,
      intervalMs: 10
    });
    _logger.default.debug('Continuing with the current ADB command');
  }
  if (opts.exclusive) {
    isExecLocked = true;
  }
  try {
    return await execFunc();
  } finally {
    if (opts.exclusive) {
      isExecLocked = false;
    }
  }
};
systemCallMethods.shell = async function shell(cmd, opts = {}) {
  const {
    privileged
  } = opts;
  const cmdArr = _lodash.default.isArray(cmd) ? cmd : [cmd];
  const fullCmd = ['shell'];
  if (privileged) {
    _logger.default.info(`'adb shell ${_support.util.quote(cmdArr)}' requires root access`);
    if (await this.isRoot()) {
      _logger.default.info('The device already had root access');
      fullCmd.push(...cmdArr);
    } else {
      fullCmd.push('su', 'root', _support.util.quote(cmdArr));
    }
  } else {
    fullCmd.push(...cmdArr);
  }
  return await this.adbExec(fullCmd, opts);
};
systemCallMethods.createSubProcess = function createSubProcess(args = []) {
  args = [...this.executable.defaultArgs, ...args];
  _logger.default.debug(`Creating ADB subprocess with args: ${JSON.stringify(args)}`);
  return new _teen_process.SubProcess(this.getAdbPath(), args);
};
systemCallMethods.getAdbServerPort = function getAdbServerPort() {
  return this.adbPort;
};
systemCallMethods.getEmulatorPort = async function getEmulatorPort() {
  _logger.default.debug('Getting running emulator port');
  if (this.emulatorPort !== null) {
    return this.emulatorPort;
  }
  try {
    let devices = await this.getConnectedDevices();
    let port = this.getPortFromEmulatorString(devices[0].udid);
    if (port) {
      return port;
    } else {
      throw new Error(`Emulator port not found`);
    }
  } catch (e) {
    throw new Error(`No devices connected. Original error: ${e.message}`);
  }
};
systemCallMethods.getPortFromEmulatorString = function getPortFromEmulatorString(emStr) {
  let portPattern = /emulator-(\d+)/;
  if (portPattern.test(emStr)) {
    return parseInt(portPattern.exec(emStr)[1], 10);
  }
  return false;
};
systemCallMethods.getConnectedEmulators = async function getConnectedEmulators(opts = {}) {
  _logger.default.debug('Getting connected emulators');
  try {
    let devices = await this.getConnectedDevices(opts);
    let emulators = [];
    for (let device of devices) {
      let port = this.getPortFromEmulatorString(device.udid);
      if (port) {
        device.port = port;
        emulators.push(device);
      }
    }
    _logger.default.debug(`${_support.util.pluralize('emulator', emulators.length, true)} connected`);
    return emulators;
  } catch (e) {
    throw new Error(`Error getting emulators. Original error: ${e.message}`);
  }
};
systemCallMethods.setEmulatorPort = function setEmulatorPort(emPort) {
  this.emulatorPort = emPort;
};
systemCallMethods.setDeviceId = function setDeviceId(deviceId) {
  _logger.default.debug(`Setting device id to ${deviceId}`);
  this.curDeviceId = deviceId;
  let argsHasDevice = this.executable.defaultArgs.indexOf('-s');
  if (argsHasDevice !== -1) {
    this.executable.defaultArgs.splice(argsHasDevice, 2);
  }
  this.executable.defaultArgs.push('-s', deviceId);
};
systemCallMethods.setDevice = function setDevice(deviceObj) {
  let deviceId = deviceObj.udid;
  let emPort = this.getPortFromEmulatorString(deviceId);
  this.setEmulatorPort(emPort);
  this.setDeviceId(deviceId);
};
systemCallMethods.getRunningAVD = async function getRunningAVD(avdName) {
  _logger.default.debug(`Trying to find '${avdName}' emulator`);
  try {
    const emulators = await this.getConnectedEmulators();
    for (const emulator of emulators) {
      this.setEmulatorPort(emulator.port);
      const runningAVDName = await this.execEmuConsoleCommand(['avd', 'name'], {
        port: emulator.port,
        execTimeout: 5000,
        connTimeout: 1000
      });
      if (_lodash.default.toLower(avdName) === _lodash.default.toLower(runningAVDName.trim())) {
        _logger.default.debug(`Found emulator '${avdName}' on port ${emulator.port}`);
        this.setDeviceId(emulator.udid);
        return emulator;
      }
    }
    _logger.default.debug(`Emulator '${avdName}' not running`);
    return null;
  } catch (e) {
    throw new Error(`Error getting AVD. Original error: ${e.message}`);
  }
};
systemCallMethods.getRunningAVDWithRetry = async function getRunningAVDWithRetry(avdName, timeoutMs = 20000) {
  try {
    return await (0, _asyncbox.waitForCondition)(async () => {
      try {
        return await this.getRunningAVD(avdName.replace('@', ''));
      } catch (e) {
        _logger.default.debug(e.message);
        return false;
      }
    }, {
      waitMs: timeoutMs,
      intervalMs: 1000
    });
  } catch (e) {
    throw new Error(`Error getting AVD with retry. Original error: ${e.message}`);
  }
};
systemCallMethods.killAllEmulators = async function killAllEmulators() {
  let cmd, args;
  if (_support.system.isWindows()) {
    cmd = 'TASKKILL';
    args = ['TASKKILL', '/IM', 'emulator.exe'];
  } else {
    cmd = '/usr/bin/killall';
    args = ['-m', 'emulator*'];
  }
  try {
    await (0, _teen_process.exec)(cmd, args);
  } catch (e) {
    throw new Error(`Error killing emulators. Original error: ${e.message}`);
  }
};
systemCallMethods.killEmulator = async function killEmulator(avdName = null, timeout = 60000) {
  if (_support.util.hasValue(avdName)) {
    _logger.default.debug(`Killing avd '${avdName}'`);
    const device = await this.getRunningAVD(avdName);
    if (!device) {
      _logger.default.info(`No avd with name '${avdName}' running. Skipping kill step.`);
      return false;
    }
  } else {
    _logger.default.debug(`Killing avd with id '${this.curDeviceId}'`);
    if (!(await this.isEmulatorConnected())) {
      _logger.default.debug(`Emulator with id '${this.curDeviceId}' not connected. Skipping kill step`);
      return false;
    }
  }
  await this.adbExec(['emu', 'kill']);
  _logger.default.debug(`Waiting up to ${timeout}ms until the emulator '${avdName ? avdName : this.curDeviceId}' is killed`);
  try {
    await (0, _asyncbox.waitForCondition)(async () => {
      try {
        return _support.util.hasValue(avdName) ? !(await this.getRunningAVD(avdName)) : !(await this.isEmulatorConnected());
      } catch (ign) {}
      return false;
    }, {
      waitMs: timeout,
      intervalMs: 2000
    });
  } catch (e) {
    throw new Error(`The emulator '${avdName ? avdName : this.curDeviceId}' is still running after being killed ${timeout}ms ago`);
  }
  _logger.default.info(`Successfully killed the '${avdName ? avdName : this.curDeviceId}' emulator`);
  return true;
};
systemCallMethods.launchAVD = async function launchAVD(avdName, opts = {}) {
  const {
    args = [],
    env = {},
    language,
    country,
    launchTimeout = 60000,
    readyTimeout = 60000,
    retryTimes = 1
  } = opts;
  _logger.default.debug(`Launching Emulator with AVD ${avdName}, launchTimeout ` + `${launchTimeout}ms and readyTimeout ${readyTimeout}ms`);
  const emulatorBinaryPath = await this.getSdkBinaryPath('emulator');
  if (avdName[0] === '@') {
    avdName = avdName.substr(1);
  }
  await this.checkAvdExist(avdName);
  const launchArgs = ['-avd', avdName];
  launchArgs.push(...(0, _helpers.toAvdLocaleArgs)(language, country));
  let isDelayAdbFeatureEnabled = false;
  if (this.allowDelayAdb) {
    const {
      revision
    } = await this.getEmuVersionInfo();
    if (revision && _support.util.compareVersions(revision, '>=', '29.0.7')) {
      try {
        const {
          target
        } = await this.getEmuImageProperties(avdName);
        const apiMatch = /\d+/.exec(target);
        if (apiMatch && parseInt(apiMatch[0], 10) >= MIN_DELAY_ADB_API_LEVEL) {
          launchArgs.push('-delay-adb');
          isDelayAdbFeatureEnabled = true;
        } else {
          throw new Error(`The actual image API version is below ${MIN_DELAY_ADB_API_LEVEL}`);
        }
      } catch (e) {
        _logger.default.info(`The -delay-adb emulator startup detection feature will not be enabled. ` + `Original error: ${e.message}`);
      }
    }
  } else {
    _logger.default.info('The -delay-adb emulator startup detection feature has been explicitly disabled');
  }
  if (!_lodash.default.isEmpty(args)) {
    launchArgs.push(...(_lodash.default.isArray(args) ? args : _support.util.shellParse(`${args}`)));
  }
  _logger.default.debug(`Running '${emulatorBinaryPath}' with args: ${_support.util.quote(launchArgs)}`);
  if (!_lodash.default.isEmpty(env)) {
    _logger.default.debug(`Customized emulator environment: ${JSON.stringify(env)}`);
  }
  const proc = new _teen_process.SubProcess(emulatorBinaryPath, launchArgs, {
    env: Object.assign({}, process.env, env)
  });
  await proc.start(0);
  proc.on('output', (stdout, stderr) => {
    for (let line of (stdout || stderr || '').split('\n').filter(Boolean)) {
      _logger.default.info(`[AVD OUTPUT] ${line}`);
    }
  });
  proc.on('die', (code, signal) => {
    _logger.default.warn(`Emulator avd ${avdName} exited with code ${code}${signal ? `, signal ${signal}` : ''}`);
  });
  await (0, _asyncbox.retry)(retryTimes, async () => await this.getRunningAVDWithRetry(avdName, launchTimeout));
  const timer = new _support.timing.Timer().start();
  if (isDelayAdbFeatureEnabled) {
    try {
      await this.adbExec(['wait-for-device'], {
        timeout: readyTimeout
      });
    } catch (e) {
      throw new Error(`'${avdName}' Emulator has failed to boot: ${e.stderr || e.message}`);
    }
  }
  await this.waitForEmulatorReady(readyTimeout - timer.getDuration().asMilliSeconds);
  return proc;
};
systemCallMethods.getVersion = _lodash.default.memoize(async function getVersion() {
  let stdout;
  try {
    stdout = await this.adbExec('version');
  } catch (e) {
    throw new Error(`Error getting adb version: ${e.stderr || e.message}`);
  }
  const result = {};
  const binaryVersionMatch = BINARY_VERSION_PATTERN.exec(stdout);
  if (binaryVersionMatch) {
    result.binary = {
      version: _semver.default.coerce(binaryVersionMatch[1]),
      build: parseInt(binaryVersionMatch[2], 10)
    };
  }
  const bridgeVersionMatch = BRIDGE_VERSION_PATTERN.exec(stdout);
  if (bridgeVersionMatch) {
    result.bridge = {
      version: _semver.default.coerce(bridgeVersionMatch[1])
    };
  }
  return result;
});
systemCallMethods.waitForEmulatorReady = async function waitForEmulatorReady(timeoutMs = 20000) {
  const requiredServicesRe = REQUIRED_SERVICES.map(name => new RegExp(`\\b${name}:`));
  let services;
  try {
    await (0, _asyncbox.waitForCondition)(async () => {
      try {
        services = await this.shell(['service', 'list']);
        return requiredServicesRe.every(pattern => pattern.test(services));
      } catch (err) {
        _logger.default.debug(`Waiting for emulator startup. Intermediate error: ${err.message}`);
        return false;
      }
    }, {
      waitMs: timeoutMs,
      intervalMs: 3000
    });
  } catch (e) {
    if (services) {
      _logger.default.debug(`Recently listed services:\n${services}`);
    }
    const missingServices = _lodash.default.zip(REQUIRED_SERVICES, requiredServicesRe).filter(([, pattern]) => !pattern.test(services)).map(([name]) => name);
    throw new Error(`Emulator is not ready within ${timeoutMs}ms ` + `(${missingServices} service${missingServices.length === 1 ? ' is' : 's are'} not running)`);
  }
};
systemCallMethods.waitForDevice = async function waitForDevice(appDeviceReadyTimeout = 30) {
  this.appDeviceReadyTimeout = appDeviceReadyTimeout;
  const retries = 3;
  const timeout = parseInt(this.appDeviceReadyTimeout, 10) * 1000 / retries;
  await (0, _asyncbox.retry)(retries, async () => {
    try {
      await this.adbExec('wait-for-device', {
        timeout
      });
      await this.ping();
    } catch (e) {
      try {
        await this.reconnect();
      } catch (ign) {
        await this.restartAdb();
      }
      await this.getConnectedDevices();
      throw new Error(`Error waiting for the device to be available. Original error: '${e.message}'`);
    }
  });
};
systemCallMethods.reboot = async function reboot(retries = DEFAULT_ADB_REBOOT_RETRIES) {
  const {
    wasAlreadyRooted
  } = await this.root();
  try {
    await this.shell(['stop']);
    await _bluebird.default.delay(2000);
    await this.setDeviceProperty('sys.boot_completed', 0, {
      privileged: false
    });
    await this.shell(['start']);
  } catch (e) {
    const {
      message
    } = e;
    if (message.includes('must be root')) {
      throw new Error(`Could not reboot device. Rebooting requires root access and ` + `attempt to get root access on device failed with error: '${message}'`);
    }
    throw e;
  } finally {
    if (!wasAlreadyRooted) {
      await this.unroot();
    }
  }
  const timer = new _support.timing.Timer().start();
  await (0, _asyncbox.retryInterval)(retries, 1000, async () => {
    if ((await this.getDeviceProperty('sys.boot_completed')) === '1') {
      return;
    }
    const msg = `Reboot is not completed after ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`;
    _logger.default.debug(msg);
    throw new Error(msg);
  });
};
systemCallMethods.changeUserPrivileges = async function changeUserPrivileges(isElevated) {
  const cmd = isElevated ? 'root' : 'unroot';
  const retryIfOffline = async cmdFunc => {
    try {
      return await cmdFunc();
    } catch (err) {
      if (['closed', 'device offline', 'timeout expired'].some(x => (err.stderr || '').toLowerCase().includes(x))) {
        _logger.default.warn(`Attempt to ${cmd} caused ADB to think the device went offline`);
        try {
          await this.reconnect();
        } catch (ign) {
          await this.restartAdb();
        }
        return await cmdFunc();
      } else {
        throw err;
      }
    }
  };
  const isRoot = await retryIfOffline(async () => await this.isRoot());
  if (isRoot && isElevated || !isRoot && !isElevated) {
    return {
      isSuccessful: true,
      wasAlreadyRooted: isRoot
    };
  }
  let wasAlreadyRooted = isRoot;
  try {
    const {
      stdout
    } = await retryIfOffline(async () => await this.adbExec([cmd]));
    _logger.default.debug(stdout);
    if (stdout) {
      if (stdout.includes('adbd cannot run as root')) {
        return {
          isSuccessful: false,
          wasAlreadyRooted
        };
      }
      if (stdout.includes('already running as root')) {
        wasAlreadyRooted = true;
      }
    }
    return {
      isSuccessful: true,
      wasAlreadyRooted
    };
  } catch (err) {
    const {
      stderr = '',
      message
    } = err;
    _logger.default.warn(`Unable to ${cmd} adb daemon. Original error: '${message}'. Stderr: '${stderr}'. Continuing.`);
    return {
      isSuccessful: false,
      wasAlreadyRooted
    };
  }
};
systemCallMethods.root = async function root() {
  return await this.changeUserPrivileges(true);
};
systemCallMethods.unroot = async function unroot() {
  return await this.changeUserPrivileges(false);
};
systemCallMethods.isRoot = async function isRoot() {
  return (await this.shell(['whoami'])).trim() === 'root';
};
systemCallMethods.fileExists = async function fileExists(remotePath) {
  const passFlag = '__PASS__';
  const checkCmd = `[ -e '${remotePath.replace(/'/g, `\\'`)}' ] && echo ${passFlag}`;
  try {
    return _lodash.default.includes(await this.shell([checkCmd]), passFlag);
  } catch (ign) {
    return false;
  }
};
systemCallMethods.ls = async function ls(remotePath, opts = []) {
  try {
    let args = ['ls', ...opts, remotePath];
    let stdout = await this.shell(args);
    let lines = stdout.split('\n');
    return lines.map(l => l.trim()).filter(Boolean).filter(l => l.indexOf('No such file') === -1);
  } catch (err) {
    if (err.message.indexOf('No such file or directory') === -1) {
      throw err;
    }
    return [];
  }
};
systemCallMethods.fileSize = async function fileSize(remotePath) {
  try {
    const files = await this.ls(remotePath, ['-la']);
    if (files.length !== 1) {
      throw new Error(`Remote path is not a file`);
    }
    const match = /[rwxsStT\-+]{10}[\s\d]*\s[^\s]+\s+[^\s]+\s+(\d+)/.exec(files[0]);
    if (!match || _lodash.default.isNaN(parseInt(match[1], 10))) {
      throw new Error(`Unable to parse size from list output: '${files[0]}'`);
    }
    return parseInt(match[1], 10);
  } catch (err) {
    throw new Error(`Unable to get file size for '${remotePath}': ${err.message}`);
  }
};
systemCallMethods.installMitmCertificate = async function installMitmCertificate(cert) {
  const openSsl = await (0, _helpers.getOpenSslForOs)();
  if (!_lodash.default.isBuffer(cert)) {
    cert = Buffer.from(cert, 'base64');
  }
  const tmpRoot = await _support.tempDir.openDir();
  try {
    const srcCert = _path.default.resolve(tmpRoot, 'source.cer');
    await _support.fs.writeFile(srcCert, cert);
    let {
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-noout', '-hash', '-in', srcCert]);
    const certHash = stdout.trim();
    _logger.default.debug(`Got certificate hash: ${certHash}`);
    _logger.default.debug('Preparing certificate content');
    ({
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-in', srcCert], {
      isBuffer: true
    }));
    let dstCertContent = stdout;
    ({
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-in', srcCert, '-text', '-fingerprint', '-noout'], {
      isBuffer: true
    }));
    dstCertContent = Buffer.concat([dstCertContent, stdout]);
    const dstCert = _path.default.resolve(tmpRoot, `${certHash}.0`);
    await _support.fs.writeFile(dstCert, dstCertContent);
    _logger.default.debug('Remounting /system in rw mode');
    await (0, _asyncbox.retryInterval)(5, 2000, async () => await this.adbExec(['remount']));
    _logger.default.debug(`Uploading the generated certificate from '${dstCert}' to '${CERTS_ROOT}'`);
    await this.push(dstCert, CERTS_ROOT);
    _logger.default.debug('Remounting /system to confirm changes');
    await this.adbExec(['remount']);
  } catch (err) {
    throw new Error(`Cannot inject the custom certificate. ` + `Is the certificate properly encoded into base64-string? ` + `Do you have root permissions on the device? ` + `Original error: ${err.message}`);
  } finally {
    await _support.fs.rimraf(tmpRoot);
  }
};
systemCallMethods.isMitmCertificateInstalled = async function isMitmCertificateInstalled(cert) {
  const openSsl = await (0, _helpers.getOpenSslForOs)();
  if (!_lodash.default.isBuffer(cert)) {
    cert = Buffer.from(cert, 'base64');
  }
  const tmpRoot = await _support.tempDir.openDir();
  let certHash;
  try {
    const tmpCert = _path.default.resolve(tmpRoot, 'source.cer');
    await _support.fs.writeFile(tmpCert, cert);
    const {
      stdout
    } = await (0, _teen_process.exec)(openSsl, ['x509', '-noout', '-hash', '-in', tmpCert]);
    certHash = stdout.trim();
  } catch (err) {
    throw new Error(`Cannot retrieve the certificate hash. ` + `Is the certificate properly encoded into base64-string? ` + `Original error: ${err.message}`);
  } finally {
    await _support.fs.rimraf(tmpRoot);
  }
  const dstPath = _path.default.posix.resolve(CERTS_ROOT, `${certHash}.0`);
  _logger.default.debug(`Checking if the certificate is already installed at '${dstPath}'`);
  return await this.fileExists(dstPath);
};
var _default = systemCallMethods;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzeXN0ZW1DYWxsTWV0aG9kcyIsIkRFRkFVTFRfQURCX1JFQk9PVF9SRVRSSUVTIiwiTElOS0VSX1dBUk5JTkdfUkVHRVhQIiwiQURCX1JFVFJZX0VSUk9SX1BBVFRFUk5TIiwiQklOQVJZX1ZFUlNJT05fUEFUVEVSTiIsIkJSSURHRV9WRVJTSU9OX1BBVFRFUk4iLCJDRVJUU19ST09UIiwiU0RLX0JJTkFSWV9ST09UUyIsIk1JTl9ERUxBWV9BREJfQVBJX0xFVkVMIiwiUkVRVUlSRURfU0VSVklDRVMiLCJnZXRTZGtCaW5hcnlQYXRoIiwiYmluYXJ5TmFtZSIsImdldEJpbmFyeUZyb21TZGtSb290IiwiZ2V0QmluYXJ5TmFtZUZvck9TIiwiXyIsIm1lbW9pemUiLCJnZXRCaW5hcnlOYW1lRm9yT1NNZW1vcml6ZSIsInN5c3RlbSIsImlzV2luZG93cyIsImluY2x1ZGVzIiwicGF0aCIsImV4dG5hbWUiLCJiaW5hcmllcyIsImZ1bGxCaW5hcnlOYW1lIiwiYmluYXJ5TG9jcyIsImdldFNka0JpbmFyeUxvY2F0aW9uQ2FuZGlkYXRlcyIsInNka1Jvb3QiLCJidWlsZFRvb2xzRGlycyIsImdldEJ1aWxkVG9vbHNEaXJzIiwiYnVpbGRUb29sc1ZlcnNpb24iLCJmaWx0ZXIiLCJ4IiwiYmFzZW5hbWUiLCJpc0VtcHR5IiwibG9nIiwiaW5mbyIsInB1c2giLCJmbGF0dGVuIiwibWFwIiwiZGlyIiwicmVzb2x2ZSIsImJpbmFyeUxvYyIsImxvYyIsImZzIiwiZXhpc3RzIiwiaXNOdWxsIiwiRXJyb3IiLCJKU09OIiwic3RyaW5naWZ5IiwiaXNBcnJheSIsImdldEFuZHJvaWRCaW5hcnlQYXRoIiwiZ2V0U2RrUm9vdEZyb21FbnYiLCJnZXRCaW5hcnlGcm9tUGF0aCIsIndoaWNoIiwiZSIsImdldENvbm5lY3RlZERldmljZXMiLCJvcHRzIiwiZGVidWciLCJhcmdzIiwiZXhlY3V0YWJsZSIsImRlZmF1bHRBcmdzIiwidmVyYm9zZSIsInN0ZG91dCIsImV4ZWMiLCJtZXNzYWdlIiwibGlzdEhlYWRlciIsInN0YXJ0aW5nSW5kZXgiLCJpbmRleE9mIiwic2xpY2UiLCJleGNsdWRlZExpbmVzIiwiYWxsb3dPZmZsaW5lRGV2aWNlcyIsImRldmljZXMiLCJzcGxpdCIsInRyaW0iLCJsaW5lIiwic29tZSIsInVkaWQiLCJzdGF0ZSIsImRlc2NyaXB0aW9uIiwiZGV2aWNlIiwiZW50cnkiLCJrZXkiLCJ2YWx1ZSIsImdldERldmljZXNXaXRoUmV0cnkiLCJ0aW1lb3V0TXMiLCJ0aW1lciIsInRpbWluZyIsIlRpbWVyIiwic3RhcnQiLCJnZXREZXZpY2VzIiwiZ2V0RHVyYXRpb24iLCJhc01pbGxpU2Vjb25kcyIsInRvRml4ZWQiLCJsZW5ndGgiLCJpZ24iLCJyZWNvbm5lY3QiLCJyZXN0YXJ0QWRiIiwic2xlZXAiLCJ0YXJnZXQiLCJhZGJFeGVjIiwic3RkZXJyIiwic3VwcHJlc3NLaWxsU2VydmVyIiwia2lsbFNlcnZlciIsImVycm9yIiwiYWRiUG9ydCIsImV4Y2x1c2l2ZSIsInJlc2V0VGVsbmV0QXV0aFRva2VuIiwiaG9tZUZvbGRlclBhdGgiLCJwcm9jZXNzIiwiZW52IiwicGxhdGZvcm0iLCJ3YXJuIiwiZHN0UGF0aCIsIndyaXRlRmlsZSIsImFkYkV4ZWNFbXUiLCJjbWQiLCJ2ZXJpZnlFbXVsYXRvckNvbm5lY3RlZCIsImlzRXhlY0xvY2tlZCIsIkVYRUNfT1VUUFVUX0ZPUk1BVCIsIk9iamVjdCIsImZyZWV6ZSIsIlNURE9VVCIsIkZVTEwiLCJjbG9uZURlZXAiLCJ0aW1lb3V0IiwiYWRiRXhlY1RpbWVvdXQiLCJERUZBVUxUX0FEQl9FWEVDX1RJTUVPVVQiLCJ0aW1lb3V0Q2FwTmFtZSIsIm91dHB1dEZvcm1hdCIsImFkYlJldHJpZWQiLCJleGVjRnVuYyIsImZpbmQiLCJhcmciLCJ0ZXN0IiwidXRpbCIsInF1b3RlIiwiam9pbiIsInJlcGxhY2UiLCJlcnJUZXh0IiwicCIsImNvZGUiLCJ3YWl0Rm9yQ29uZGl0aW9uIiwid2FpdE1zIiwiTnVtYmVyIiwiTUFYX1NBRkVfSU5URUdFUiIsImludGVydmFsTXMiLCJzaGVsbCIsInByaXZpbGVnZWQiLCJjbWRBcnIiLCJmdWxsQ21kIiwiaXNSb290IiwiY3JlYXRlU3ViUHJvY2VzcyIsIlN1YlByb2Nlc3MiLCJnZXRBZGJQYXRoIiwiZ2V0QWRiU2VydmVyUG9ydCIsImdldEVtdWxhdG9yUG9ydCIsImVtdWxhdG9yUG9ydCIsInBvcnQiLCJnZXRQb3J0RnJvbUVtdWxhdG9yU3RyaW5nIiwiZW1TdHIiLCJwb3J0UGF0dGVybiIsInBhcnNlSW50IiwiZ2V0Q29ubmVjdGVkRW11bGF0b3JzIiwiZW11bGF0b3JzIiwicGx1cmFsaXplIiwic2V0RW11bGF0b3JQb3J0IiwiZW1Qb3J0Iiwic2V0RGV2aWNlSWQiLCJkZXZpY2VJZCIsImN1ckRldmljZUlkIiwiYXJnc0hhc0RldmljZSIsInNwbGljZSIsInNldERldmljZSIsImRldmljZU9iaiIsImdldFJ1bm5pbmdBVkQiLCJhdmROYW1lIiwiZW11bGF0b3IiLCJydW5uaW5nQVZETmFtZSIsImV4ZWNFbXVDb25zb2xlQ29tbWFuZCIsImV4ZWNUaW1lb3V0IiwiY29ublRpbWVvdXQiLCJ0b0xvd2VyIiwiZ2V0UnVubmluZ0FWRFdpdGhSZXRyeSIsImtpbGxBbGxFbXVsYXRvcnMiLCJraWxsRW11bGF0b3IiLCJoYXNWYWx1ZSIsImlzRW11bGF0b3JDb25uZWN0ZWQiLCJsYXVuY2hBVkQiLCJsYW5ndWFnZSIsImNvdW50cnkiLCJsYXVuY2hUaW1lb3V0IiwicmVhZHlUaW1lb3V0IiwicmV0cnlUaW1lcyIsImVtdWxhdG9yQmluYXJ5UGF0aCIsInN1YnN0ciIsImNoZWNrQXZkRXhpc3QiLCJsYXVuY2hBcmdzIiwidG9BdmRMb2NhbGVBcmdzIiwiaXNEZWxheUFkYkZlYXR1cmVFbmFibGVkIiwiYWxsb3dEZWxheUFkYiIsInJldmlzaW9uIiwiZ2V0RW11VmVyc2lvbkluZm8iLCJjb21wYXJlVmVyc2lvbnMiLCJnZXRFbXVJbWFnZVByb3BlcnRpZXMiLCJhcGlNYXRjaCIsInNoZWxsUGFyc2UiLCJwcm9jIiwiYXNzaWduIiwib24iLCJCb29sZWFuIiwic2lnbmFsIiwicmV0cnkiLCJ3YWl0Rm9yRW11bGF0b3JSZWFkeSIsImdldFZlcnNpb24iLCJyZXN1bHQiLCJiaW5hcnlWZXJzaW9uTWF0Y2giLCJiaW5hcnkiLCJ2ZXJzaW9uIiwic2VtdmVyIiwiY29lcmNlIiwiYnVpbGQiLCJicmlkZ2VWZXJzaW9uTWF0Y2giLCJicmlkZ2UiLCJyZXF1aXJlZFNlcnZpY2VzUmUiLCJuYW1lIiwiUmVnRXhwIiwic2VydmljZXMiLCJldmVyeSIsInBhdHRlcm4iLCJlcnIiLCJtaXNzaW5nU2VydmljZXMiLCJ6aXAiLCJ3YWl0Rm9yRGV2aWNlIiwiYXBwRGV2aWNlUmVhZHlUaW1lb3V0IiwicmV0cmllcyIsInBpbmciLCJyZWJvb3QiLCJ3YXNBbHJlYWR5Um9vdGVkIiwicm9vdCIsIkIiLCJkZWxheSIsInNldERldmljZVByb3BlcnR5IiwidW5yb290IiwicmV0cnlJbnRlcnZhbCIsImdldERldmljZVByb3BlcnR5IiwibXNnIiwiY2hhbmdlVXNlclByaXZpbGVnZXMiLCJpc0VsZXZhdGVkIiwicmV0cnlJZk9mZmxpbmUiLCJjbWRGdW5jIiwidG9Mb3dlckNhc2UiLCJpc1N1Y2Nlc3NmdWwiLCJmaWxlRXhpc3RzIiwicmVtb3RlUGF0aCIsInBhc3NGbGFnIiwiY2hlY2tDbWQiLCJscyIsImxpbmVzIiwibCIsImZpbGVTaXplIiwiZmlsZXMiLCJtYXRjaCIsImlzTmFOIiwiaW5zdGFsbE1pdG1DZXJ0aWZpY2F0ZSIsImNlcnQiLCJvcGVuU3NsIiwiZ2V0T3BlblNzbEZvck9zIiwiaXNCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwidG1wUm9vdCIsInRlbXBEaXIiLCJvcGVuRGlyIiwic3JjQ2VydCIsImNlcnRIYXNoIiwiZHN0Q2VydENvbnRlbnQiLCJjb25jYXQiLCJkc3RDZXJ0IiwicmltcmFmIiwiaXNNaXRtQ2VydGlmaWNhdGVJbnN0YWxsZWQiLCJ0bXBDZXJ0IiwicG9zaXgiXSwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvdG9vbHMvc3lzdGVtLWNhbGxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IGxvZyBmcm9tICcuLi9sb2dnZXIuanMnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHsgc3lzdGVtLCBmcywgdXRpbCwgdGVtcERpciwgdGltaW5nIH0gZnJvbSAnQGFwcGl1bS9zdXBwb3J0JztcbmltcG9ydCB7XG4gIGdldEJ1aWxkVG9vbHNEaXJzLCB0b0F2ZExvY2FsZUFyZ3MsXG4gIGdldE9wZW5Tc2xGb3JPcywgREVGQVVMVF9BREJfRVhFQ19USU1FT1VULCBnZXRTZGtSb290RnJvbUVudlxufSBmcm9tICcuLi9oZWxwZXJzJztcbmltcG9ydCB7IGV4ZWMsIFN1YlByb2Nlc3MgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IHsgc2xlZXAsIHJldHJ5LCByZXRyeUludGVydmFsLCB3YWl0Rm9yQ29uZGl0aW9uIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJztcblxuXG5sZXQgc3lzdGVtQ2FsbE1ldGhvZHMgPSB7fTtcblxuY29uc3QgREVGQVVMVF9BREJfUkVCT09UX1JFVFJJRVMgPSA5MDtcbmNvbnN0IExJTktFUl9XQVJOSU5HX1JFR0VYUCA9IC9eV0FSTklORzogbGlua2VyLiskL207XG5jb25zdCBBREJfUkVUUllfRVJST1JfUEFUVEVSTlMgPSBbXG4gIC9wcm90b2NvbCBmYXVsdCBcXChubyBzdGF0dXNcXCkvaSxcbiAgL2Vycm9yOiBkZXZpY2UgKCcuKycgKT9ub3QgZm91bmQvaSxcbiAgL2Vycm9yOiBkZXZpY2Ugc3RpbGwgY29ubmVjdGluZy9pLFxuXTtcbmNvbnN0IEJJTkFSWV9WRVJTSU9OX1BBVFRFUk4gPSAvXlZlcnNpb24gKFtcXGQuXSspLShcXGQrKS9tO1xuY29uc3QgQlJJREdFX1ZFUlNJT05fUEFUVEVSTiA9IC9eQW5kcm9pZCBEZWJ1ZyBCcmlkZ2UgdmVyc2lvbiAoW1xcZC5dKykvbTtcbmNvbnN0IENFUlRTX1JPT1QgPSAnL3N5c3RlbS9ldGMvc2VjdXJpdHkvY2FjZXJ0cyc7XG5jb25zdCBTREtfQklOQVJZX1JPT1RTID0gW1xuICAncGxhdGZvcm0tdG9vbHMnLFxuICAnZW11bGF0b3InLFxuICBbJ2NtZGxpbmUtdG9vbHMnLCAnbGF0ZXN0JywgJ2JpbiddLFxuICAndG9vbHMnLFxuICBbJ3Rvb2xzJywgJ2JpbiddLFxuICAnLicgLy8gQWxsb3cgY3VzdG9tIHNka1Jvb3QgdG8gc3BlY2lmeSBmdWxsIGZvbGRlciBwYXRoXG5dO1xuY29uc3QgTUlOX0RFTEFZX0FEQl9BUElfTEVWRUwgPSAyODtcbmNvbnN0IFJFUVVJUkVEX1NFUlZJQ0VTID0gWydhY3Rpdml0eScsICdwYWNrYWdlJywgJ21vdW50J107XG5cbi8qKlxuICogUmV0cmlldmUgZnVsbCBwYXRoIHRvIHRoZSBnaXZlbiBiaW5hcnkuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJpbmFyeU5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgYmluYXJ5LlxuICogQHJldHVybiB7c3RyaW5nfSBGdWxsIHBhdGggdG8gdGhlIGdpdmVuIGJpbmFyeSBpbmNsdWRpbmcgY3VycmVudCBTREsgcm9vdC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0U2RrQmluYXJ5UGF0aCA9IGFzeW5jIGZ1bmN0aW9uIGdldFNka0JpbmFyeVBhdGggKGJpbmFyeU5hbWUpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QmluYXJ5RnJvbVNka1Jvb3QoYmluYXJ5TmFtZSk7XG59O1xuXG4vKipcbiAqIFJldHJpZXZlIGZ1bGwgYmluYXJ5IG5hbWUgZm9yIHRoZSBjdXJyZW50IG9wZXJhdGluZyBzeXN0ZW0gYXMgbWVtb3RpemUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJpbmFyeU5hbWUgLSBzaW1wbGUgYmluYXJ5IG5hbWUsIGZvciBleGFtcGxlICdhbmRyb2lkJy5cbiAqIEByZXR1cm4ge3N0cmluZ30gRm9ybWF0dGVkIGJpbmFyeSBuYW1lIGRlcGVuZGluZyBvbiB0aGUgY3VycmVudCBwbGF0Zm9ybSxcbiAqICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUsICdhbmRyb2lkLmJhdCcgb24gV2luZG93cy5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0QmluYXJ5TmFtZUZvck9TID0gXy5tZW1vaXplKGZ1bmN0aW9uIGdldEJpbmFyeU5hbWVGb3JPU01lbW9yaXplIChiaW5hcnlOYW1lKSB7XG4gIHJldHVybiBnZXRCaW5hcnlOYW1lRm9yT1MoYmluYXJ5TmFtZSk7XG59KTtcblxuLyoqXG4gKiBSZXRyaWV2ZSBmdWxsIGJpbmFyeSBuYW1lIGZvciB0aGUgY3VycmVudCBvcGVyYXRpbmcgc3lzdGVtLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBiaW5hcnlOYW1lIC0gc2ltcGxlIGJpbmFyeSBuYW1lLCBmb3IgZXhhbXBsZSAnYW5kcm9pZCcuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEZvcm1hdHRlZCBiaW5hcnkgbmFtZSBkZXBlbmRpbmcgb24gdGhlIGN1cnJlbnQgcGxhdGZvcm0sXG4gKiAgICAgICAgICAgICAgICAgIGZvciBleGFtcGxlLCAnYW5kcm9pZC5iYXQnIG9uIFdpbmRvd3MuXG4gKi9cbmZ1bmN0aW9uIGdldEJpbmFyeU5hbWVGb3JPUyAoYmluYXJ5TmFtZSkge1xuICBpZiAoIXN5c3RlbS5pc1dpbmRvd3MoKSkge1xuICAgIHJldHVybiBiaW5hcnlOYW1lO1xuICB9XG5cbiAgaWYgKFsnYW5kcm9pZCcsICdhcGtzaWduZXInLCAnYXBrYW5hbHl6ZXInXS5pbmNsdWRlcyhiaW5hcnlOYW1lKSkge1xuICAgIHJldHVybiBgJHtiaW5hcnlOYW1lfS5iYXRgO1xuICB9XG4gIGlmICghcGF0aC5leHRuYW1lKGJpbmFyeU5hbWUpKSB7XG4gICAgcmV0dXJuIGAke2JpbmFyeU5hbWV9LmV4ZWA7XG4gIH1cbiAgcmV0dXJuIGJpbmFyeU5hbWU7XG59XG5cbi8qKlxuICogUmV0cmlldmUgZnVsbCBwYXRoIHRvIHRoZSBnaXZlbiBiaW5hcnkgYW5kIGNhY2hlcyBpdCBpbnRvIGBiaW5hcmllc2BcbiAqIHByb3BlcnR5IG9mIHRoZSBjdXJyZW50IEFEQiBpbnN0YW5jZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYmluYXJ5TmFtZSAtIFNpbXBsZSBuYW1lIG9mIGEgYmluYXJ5IGZpbGUuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEZ1bGwgcGF0aCB0byB0aGUgZ2l2ZW4gYmluYXJ5LiBUaGUgbWV0aG9kIHRyaWVzXG4gKiAgICAgICAgICAgICAgICAgIHRvIGVudW1lcmF0ZSBhbGwgdGhlIGtub3duIGxvY2F0aW9ucyB3aGVyZSB0aGUgYmluYXJ5XG4gKiAgICAgICAgICAgICAgICAgIG1pZ2h0IGJlIGxvY2F0ZWQgYW5kIHN0b3BzIHRoZSBzZWFyY2ggYXMgc29vbiBhcyB0aGUgZmlyc3RcbiAqICAgICAgICAgICAgICAgICAgbWF0Y2ggaXMgZm91bmQgb24gdGhlIGxvY2FsIGZpbGUgc3lzdGVtLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBiaW5hcnkgd2l0aCBnaXZlbiBuYW1lIGlzIG5vdCBwcmVzZW50IGF0IGFueVxuICogICAgICAgICAgICAgICAgIG9mIGtub3duIGxvY2F0aW9ucyBvciBBbmRyb2lkIFNESyBpcyBub3QgaW5zdGFsbGVkIG9uIHRoZVxuICogICAgICAgICAgICAgICAgIGxvY2FsIGZpbGUgc3lzdGVtLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5nZXRCaW5hcnlGcm9tU2RrUm9vdCA9IGFzeW5jIGZ1bmN0aW9uIGdldEJpbmFyeUZyb21TZGtSb290IChiaW5hcnlOYW1lKSB7XG4gIGlmICh0aGlzLmJpbmFyaWVzW2JpbmFyeU5hbWVdKSB7XG4gICAgcmV0dXJuIHRoaXMuYmluYXJpZXNbYmluYXJ5TmFtZV07XG4gIH1cbiAgY29uc3QgZnVsbEJpbmFyeU5hbWUgPSB0aGlzLmdldEJpbmFyeU5hbWVGb3JPUyhiaW5hcnlOYW1lKTtcbiAgY29uc3QgYmluYXJ5TG9jcyA9IGdldFNka0JpbmFyeUxvY2F0aW9uQ2FuZGlkYXRlcyh0aGlzLnNka1Jvb3QsIGZ1bGxCaW5hcnlOYW1lKTtcblxuICAvLyBnZXQgc3VicGF0aHMgZm9yIGN1cnJlbnRseSBpbnN0YWxsZWQgYnVpbGQgdG9vbCBkaXJlY3Rvcmllc1xuICBsZXQgYnVpbGRUb29sc0RpcnMgPSBhd2FpdCBnZXRCdWlsZFRvb2xzRGlycyh0aGlzLnNka1Jvb3QpO1xuICBpZiAodGhpcy5idWlsZFRvb2xzVmVyc2lvbikge1xuICAgIGJ1aWxkVG9vbHNEaXJzID0gYnVpbGRUb29sc0RpcnNcbiAgICAgIC5maWx0ZXIoKHgpID0+IHBhdGguYmFzZW5hbWUoeCkgPT09IHRoaXMuYnVpbGRUb29sc1ZlcnNpb24pO1xuICAgIGlmIChfLmlzRW1wdHkoYnVpbGRUb29sc0RpcnMpKSB7XG4gICAgICBsb2cuaW5mbyhgRm91bmQgbm8gYnVpbGQgdG9vbHMgd2hvc2UgdmVyc2lvbiBtYXRjaGVzIHRvICcke3RoaXMuYnVpbGRUb29sc1ZlcnNpb259J2ApO1xuICAgIH0gZWxzZSB7XG4gICAgICBsb2cuaW5mbyhgVXNpbmcgYnVpbGQgdG9vbHMgYXQgJyR7YnVpbGRUb29sc0RpcnN9J2ApO1xuICAgIH1cbiAgfVxuICBiaW5hcnlMb2NzLnB1c2goLi4uKF8uZmxhdHRlbihidWlsZFRvb2xzRGlyc1xuICAgIC5tYXAoKGRpcikgPT4gW1xuICAgICAgcGF0aC5yZXNvbHZlKGRpciwgZnVsbEJpbmFyeU5hbWUpLFxuICAgICAgcGF0aC5yZXNvbHZlKGRpciwgJ2xpYicsIGZ1bGxCaW5hcnlOYW1lKSxcbiAgICBdKSlcbiAgKSk7XG5cbiAgbGV0IGJpbmFyeUxvYyA9IG51bGw7XG4gIGZvciAoY29uc3QgbG9jIG9mIGJpbmFyeUxvY3MpIHtcbiAgICBpZiAoYXdhaXQgZnMuZXhpc3RzKGxvYykpIHtcbiAgICAgIGJpbmFyeUxvYyA9IGxvYztcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBpZiAoXy5pc051bGwoYmluYXJ5TG9jKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgJyR7ZnVsbEJpbmFyeU5hbWV9JyBpbiAke0pTT04uc3RyaW5naWZ5KGJpbmFyeUxvY3MpfS4gYCArXG4gICAgICBgRG8geW91IGhhdmUgQW5kcm9pZCBCdWlsZCBUb29scyAke3RoaXMuYnVpbGRUb29sc1ZlcnNpb24gPyBgdiAke3RoaXMuYnVpbGRUb29sc1ZlcnNpb259IGAgOiAnJ31gICtcbiAgICAgIGBpbnN0YWxsZWQgYXQgJyR7dGhpcy5zZGtSb290fSc/YCk7XG4gIH1cbiAgbG9nLmluZm8oYFVzaW5nICcke2Z1bGxCaW5hcnlOYW1lfScgZnJvbSAnJHtiaW5hcnlMb2N9J2ApO1xuICB0aGlzLmJpbmFyaWVzW2JpbmFyeU5hbWVdID0gYmluYXJ5TG9jO1xuICByZXR1cm4gYmluYXJ5TG9jO1xufTtcblxuLyoqXG4gKiAgUmV0dXJucyB0aGUgQW5kcm9pZCBiaW5hcmllcyBsb2NhdGlvbnNcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc2RrUm9vdCBUaGUgcGF0aCB0byBBbmRyb2lkIFNESyByb290LlxuICogQHBhcmFtIHtzdHJpbmd9IGZ1bGxCaW5hcnlOYW1lIFRoZSBuYW1lIG9mIGZ1bGwgYmluYXJ5IG5hbWUuXG4gKiBAcmV0dXJuIHtBcnJheTxzdHJpbmc+fSBUaGUgbGlzdCBvZiBTREtfQklOQVJZX1JPT1RTIHBhdGhzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBzZGtSb290IGFuZCBmdWxsQmluYXJ5TmFtZS5cbiAqL1xuZnVuY3Rpb24gZ2V0U2RrQmluYXJ5TG9jYXRpb25DYW5kaWRhdGVzIChzZGtSb290LCBmdWxsQmluYXJ5TmFtZSkge1xuICByZXR1cm4gU0RLX0JJTkFSWV9ST09UUy5tYXAoKHgpID0+XG4gICAgcGF0aC5yZXNvbHZlKHNka1Jvb3QsIC4uLihfLmlzQXJyYXkoeCkgPyB4IDogW3hdKSwgZnVsbEJpbmFyeU5hbWUpKTtcbn1cblxuLyoqXG4gKiBSZXRyaWV2ZSBmdWxsIHBhdGggdG8gdGhlIGdpdmVuIGJpbmFyeS5cbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IGhhdmUgY2FjaGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJpbmFyeU5hbWUgLSBTaW1wbGUgbmFtZSBvZiBhIGJpbmFyeSBmaWxlLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmcuICdhZGInLCAnYW5kcm9pZCdcbiAqIEByZXR1cm4ge3N0cmluZ30gRnVsbCBwYXRoIHRvIHRoZSBnaXZlbiBiaW5hcnkuIFRoZSBtZXRob2QgdHJpZXNcbiAqICAgICAgICAgICAgICAgICAgdG8gZW51bWVyYXRlIGFsbCB0aGUga25vd24gbG9jYXRpb25zIHdoZXJlIHRoZSBiaW5hcnlcbiAqICAgICAgICAgICAgICAgICAgbWlnaHQgYmUgbG9jYXRlZCBhbmQgc3RvcHMgdGhlIHNlYXJjaCBhcyBzb29uIGFzIHRoZSBmaXJzdFxuICogICAgICAgICAgICAgICAgICBtYXRjaCBpcyBmb3VuZCBvbiB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0uXG4gKiAgICAgICAgICAgICAgICAgIGUuZy4gJy9QYXRoL1RvL0FuZHJvaWQvc2RrL3BsYXRmb3JtLXRvb2xzL2FkYidcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgYmluYXJ5IHdpdGggZ2l2ZW4gbmFtZSBpcyBub3QgcHJlc2VudCBhdCBhbnlcbiAqICAgICAgICAgICAgICAgICBvZiBrbm93biBsb2NhdGlvbnMgb3IgQW5kcm9pZCBTREsgaXMgbm90IGluc3RhbGxlZCBvbiB0aGVcbiAqICAgICAgICAgICAgICAgICBsb2NhbCBmaWxlIHN5c3RlbS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0QW5kcm9pZEJpbmFyeVBhdGggKGJpbmFyeU5hbWUpIHtcbiAgY29uc3QgZnVsbEJpbmFyeU5hbWUgPSBnZXRCaW5hcnlOYW1lRm9yT1MoYmluYXJ5TmFtZSk7XG4gIGNvbnN0IHNka1Jvb3QgPSBnZXRTZGtSb290RnJvbUVudigpO1xuICBjb25zdCBiaW5hcnlMb2NzID0gZ2V0U2RrQmluYXJ5TG9jYXRpb25DYW5kaWRhdGVzKHNka1Jvb3QsIGZ1bGxCaW5hcnlOYW1lKTtcbiAgZm9yIChjb25zdCBsb2Mgb2YgYmluYXJ5TG9jcykge1xuICAgIGlmIChhd2FpdCBmcy5leGlzdHMobG9jKSkge1xuICAgICAgcmV0dXJuIGxvYztcbiAgICB9XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCAnJHtmdWxsQmluYXJ5TmFtZX0nIGluICR7SlNPTi5zdHJpbmdpZnkoYmluYXJ5TG9jcyl9LiBgICtcbiAgICBgRG8geW91IGhhdmUgQW5kcm9pZCBCdWlsZCBUb29scyBpbnN0YWxsZWQgYXQgJyR7c2RrUm9vdH0nP2ApO1xufVxuXG4vKipcbiAqIFJldHJpZXZlIGZ1bGwgcGF0aCB0byBhIGJpbmFyeSBmaWxlIHVzaW5nIHRoZSBzdGFuZGFyZCBzeXN0ZW0gbG9va3VwIHRvb2wuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJpbmFyeU5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgYmluYXJ5LlxuICogQHJldHVybiB7c3RyaW5nfSBGdWxsIHBhdGggdG8gdGhlIGJpbmFyeSByZWNlaXZlZCBmcm9tICd3aGljaCcvJ3doZXJlJ1xuICogICAgICAgICAgICAgICAgICBvdXRwdXQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgbG9va3VwIHRvb2wgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0QmluYXJ5RnJvbVBhdGggPSBhc3luYyBmdW5jdGlvbiBnZXRCaW5hcnlGcm9tUGF0aCAoYmluYXJ5TmFtZSkge1xuICBpZiAodGhpcy5iaW5hcmllc1tiaW5hcnlOYW1lXSkge1xuICAgIHJldHVybiB0aGlzLmJpbmFyaWVzW2JpbmFyeU5hbWVdO1xuICB9XG5cbiAgY29uc3QgZnVsbEJpbmFyeU5hbWUgPSB0aGlzLmdldEJpbmFyeU5hbWVGb3JPUyhiaW5hcnlOYW1lKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBiaW5hcnlMb2MgPSBhd2FpdCBmcy53aGljaChmdWxsQmluYXJ5TmFtZSk7XG4gICAgbG9nLmluZm8oYFVzaW5nICcke2Z1bGxCaW5hcnlOYW1lfScgZnJvbSAnJHtiaW5hcnlMb2N9J2ApO1xuICAgIHRoaXMuYmluYXJpZXNbYmluYXJ5TmFtZV0gPSBiaW5hcnlMb2M7XG4gICAgcmV0dXJuIGJpbmFyeUxvYztcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgJyR7ZnVsbEJpbmFyeU5hbWV9JyBpbiBQQVRILiBQbGVhc2Ugc2V0IHRoZSBBTkRST0lEX0hPTUUgYCArXG4gICAgICBgb3IgQU5EUk9JRF9TREtfUk9PVCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgdG8gdGhlIGNvcnJlY3QgQW5kcm9pZCBTREsgcm9vdCBkaXJlY3RvcnkgcGF0aC5gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDb25uZWN0ZWREZXZpY2VzT3B0aW9uc1xuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gdmVyYm9zZSAtIFdoZXRoZXIgdG8gZ2V0IGxvbmcgb3V0cHV0LCB3aGljaCBpbmNsdWRlcyBleHRyYSBwcm9wZXJ0aWVzIGluIGVhY2ggZGV2aWNlLlxuICogQWtpbiB0byBydW5uaW5nIGBhZGIgZGV2aWNlcyAtbGAuXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBEZXZpY2VcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB1ZGlkIC0gVGhlIGRldmljZSB1ZGlkLlxuICogQHByb3BlcnR5IHtzdHJpbmd9IHN0YXRlIC0gQ3VycmVudCBkZXZpY2Ugc3RhdGUsIGFzIGl0IGlzIHZpc2libGUgaW5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hZGIgZGV2aWNlcyAtbF8gb3V0cHV0LlxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge0RldmljZX0gVmVyYm9zZURldmljZSBBZGRpdGlvbmFsIHByb3BlcnRpZXMgcmV0dXJuZWQgd2hlbiBgdmVyYm9zZWAgaXMgdHJ1ZS5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBwcm9kdWN0IC0gVGhlIHByb2R1Y3QgY29kZW5hbWUgb2YgdGhlIGRldmljZSwgc3VjaCBhcyBcInJhem9yXCIuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbW9kZWwgLSBUaGUgbW9kZWwgbmFtZSBvZiB0aGUgZGV2aWNlLCBzdWNoIGFzIFwiTmV4dXNfN1wiLlxuICogQHByb3BlcnR5IHtzdHJpbmd9IGRldmljZSAtIFRoZSBkZXZpY2UgY29kZW5hbWUsIHN1Y2ggYXMgXCJmbG93XCIuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHVzYiAtIFJlcHJlc2VudHMgdGhlIFVTQiBwb3J0IHRoZSBkZXZpY2UgaXMgY29ubmVjdGVkIHRvLCBzdWNoIGFzIFwiMS0xXCIuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHRyYW5zcG9ydF9pZCAtIFRoZSBUcmFuc3BvcnQgSUQgZm9yIHRoZSBkZXZpY2UsIHN1Y2ggYXMgXCIxXCIuXG4gKi9cblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgbGlzdCBvZiBkZXZpY2VzIHZpc2libGUgdG8gYWRiLlxuICpcbiAqIEBwYXJhbSB7P0Nvbm5lY3RlZERldmljZXNPcHRpb25zfSBvcHRzIFt7fV0gLSBBZGRpdGlvbmFsIG9wdGlvbnMgbWFwcGluZy5cbiAqIEByZXR1cm4ge0FycmF5LjxEZXZpY2U+fSBUaGUgbGlzdCBvZiBkZXZpY2VzIG9yIGFuIGVtcHR5IGxpc3QgaWZcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBubyBkZXZpY2VzIGFyZSBjb25uZWN0ZWQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGxpc3RpbmcgZGV2aWNlcy5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0Q29ubmVjdGVkRGV2aWNlcyA9IGFzeW5jIGZ1bmN0aW9uIGdldENvbm5lY3RlZERldmljZXMgKG9wdHMgPSB7fSkge1xuICBsb2cuZGVidWcoJ0dldHRpbmcgY29ubmVjdGVkIGRldmljZXMnKTtcbiAgY29uc3QgYXJncyA9IFsuLi50aGlzLmV4ZWN1dGFibGUuZGVmYXVsdEFyZ3MsICdkZXZpY2VzJ107XG4gIGlmIChvcHRzLnZlcmJvc2UpIHtcbiAgICBhcmdzLnB1c2goJy1sJyk7XG4gIH1cblxuICBsZXQgc3Rkb3V0O1xuICB0cnkge1xuICAgICh7c3Rkb3V0fSA9IGF3YWl0IGV4ZWModGhpcy5leGVjdXRhYmxlLnBhdGgsIGFyZ3MpKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3Igd2hpbGUgZ2V0dGluZyBjb25uZWN0ZWQgZGV2aWNlcy4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG4gIGNvbnN0IGxpc3RIZWFkZXIgPSAnTGlzdCBvZiBkZXZpY2VzJztcbiAgLy8gZXhwZWN0aW5nIGFkYiBkZXZpY2VzIHRvIHJldHVybiBvdXRwdXQgYXNcbiAgLy8gTGlzdCBvZiBkZXZpY2VzIGF0dGFjaGVkXG4gIC8vIGVtdWxhdG9yLTU1NTRcdGRldmljZVxuICBjb25zdCBzdGFydGluZ0luZGV4ID0gc3Rkb3V0LmluZGV4T2YobGlzdEhlYWRlcik7XG4gIGlmIChzdGFydGluZ0luZGV4IDwgMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCBvdXRwdXQgd2hpbGUgdHJ5aW5nIHRvIGdldCBkZXZpY2VzOiAke3N0ZG91dH1gKTtcbiAgfVxuICAvLyBzbGljaW5nIG91dHB1dCB3ZSBjYXJlIGFib3V0XG4gIHN0ZG91dCA9IHN0ZG91dC5zbGljZShzdGFydGluZ0luZGV4KTtcbiAgbGV0IGV4Y2x1ZGVkTGluZXMgPSBbbGlzdEhlYWRlciwgJ2FkYiBzZXJ2ZXInLCAnKiBkYWVtb24nXTtcbiAgaWYgKCF0aGlzLmFsbG93T2ZmbGluZURldmljZXMpIHtcbiAgICBleGNsdWRlZExpbmVzLnB1c2goJ29mZmxpbmUnKTtcbiAgfVxuICBjb25zdCBkZXZpY2VzID0gc3Rkb3V0LnNwbGl0KCdcXG4nKVxuICAgIC5tYXAoXy50cmltKVxuICAgIC5maWx0ZXIoKGxpbmUpID0+IGxpbmUgJiYgIWV4Y2x1ZGVkTGluZXMuc29tZSgoeCkgPT4gbGluZS5pbmNsdWRlcyh4KSkpXG4gICAgLm1hcCgobGluZSkgPT4ge1xuICAgICAgLy8gc3RhdGUgaXMgXCJkZXZpY2VcIiwgYWZhaWNcbiAgICAgIGNvbnN0IFt1ZGlkLCBzdGF0ZSwgLi4uZGVzY3JpcHRpb25dID0gbGluZS5zcGxpdCgvXFxzKy8pO1xuICAgICAgY29uc3QgZGV2aWNlID0ge3VkaWQsIHN0YXRlfTtcbiAgICAgIGlmIChvcHRzLnZlcmJvc2UpIHtcbiAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBkZXNjcmlwdGlvbikge1xuICAgICAgICAgIGlmIChlbnRyeS5pbmNsdWRlcygnOicpKSB7XG4gICAgICAgICAgICAvLyBlYWNoIGVudHJ5IGxvb2tzIGxpa2Uga2V5OnZhbHVlXG4gICAgICAgICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSBlbnRyeS5zcGxpdCgnOicpO1xuICAgICAgICAgICAgZGV2aWNlW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBkZXZpY2U7XG4gICAgfSk7XG4gIGlmIChfLmlzRW1wdHkoZGV2aWNlcykpIHtcbiAgICBsb2cuZGVidWcoJ05vIGNvbm5lY3RlZCBkZXZpY2VzIGhhdmUgYmVlbiBkZXRlY3RlZCcpO1xuICB9IGVsc2Uge1xuICAgIGxvZy5kZWJ1ZyhgQ29ubmVjdGVkIGRldmljZXM6ICR7SlNPTi5zdHJpbmdpZnkoZGV2aWNlcyl9YCk7XG4gIH1cbiAgcmV0dXJuIGRldmljZXM7XG59O1xuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBsaXN0IG9mIGRldmljZXMgdmlzaWJsZSB0byBhZGIgd2l0aGluIHRoZSBnaXZlbiB0aW1lb3V0LlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lb3V0TXMgLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIGdldCBhdCBsZWFzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uZSBsaXN0IGl0ZW0uXG4gKiBAcmV0dXJuIHtBcnJheS48RGV2aWNlPn0gVGhlIGxpc3Qgb2YgY29ubmVjdGVkIGRldmljZXMuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgbm8gY29ubmVjdGVkIGRldmljZXMgY2FuIGJlIGRldGVjdGVkIHdpdGhpbiB0aGUgZ2l2ZW4gdGltZW91dC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0RGV2aWNlc1dpdGhSZXRyeSA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZXNXaXRoUmV0cnkgKHRpbWVvdXRNcyA9IDIwMDAwKSB7XG4gIGNvbnN0IHRpbWVyID0gbmV3IHRpbWluZy5UaW1lcigpLnN0YXJ0KCk7XG4gIGxvZy5kZWJ1ZygnVHJ5aW5nIHRvIGZpbmQgYSBjb25uZWN0ZWQgYW5kcm9pZCBkZXZpY2UnKTtcbiAgY29uc3QgZ2V0RGV2aWNlcyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAodGltZXIuZ2V0RHVyYXRpb24oKS5hc01pbGxpU2Vjb25kcyA+IHRpbWVvdXRNcykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBhIGNvbm5lY3RlZCBBbmRyb2lkIGRldmljZSBpbiAke3RpbWVyLmdldER1cmF0aW9uKCkuYXNNaWxsaVNlY29uZHMudG9GaXhlZCgwKX1tcy5gKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRldmljZXMgPSBhd2FpdCB0aGlzLmdldENvbm5lY3RlZERldmljZXMoKTtcbiAgICAgIGlmIChkZXZpY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGRldmljZXM7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoaWduKSB7fVxuXG4gICAgbG9nLmRlYnVnKCdDb3VsZCBub3QgZmluZCBvbmxpbmUgZGV2aWNlcycpO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnJlY29ubmVjdCgpO1xuICAgIH0gY2F0Y2ggKGlnbikge1xuICAgICAgYXdhaXQgdGhpcy5yZXN0YXJ0QWRiKCk7XG4gICAgfVxuICAgIC8vIGNvb2wgZG93blxuICAgIGF3YWl0IHNsZWVwKDIwMCk7XG4gICAgcmV0dXJuIGF3YWl0IGdldERldmljZXMoKTtcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IGdldERldmljZXMoKTtcbn07XG5cbi8qKlxuICogS2ljayBjdXJyZW50IGNvbm5lY3Rpb24gZnJvbSBob3N0L2RldmljZSBzaWRlIGFuZCBtYWtlIGl0IHJlY29ubmVjdFxuICpcbiAqIEBwYXJhbSB7P3N0cmluZ30gdGFyZ2V0IFtvZmZsaW5lXSBPbmUgb2YgcG9zc2libGUgdGFyZ2V0cyB0byByZWNvbm5lY3Q6XG4gKiBvZmZsaW5lLCBkZXZpY2Ugb3IgbnVsbFxuICogUHJvdmlkaW5nIGBudWxsYCB3aWxsIGNhdXNlIHJlY29ubmVjdGlvbiB0byBoYXBwZW4gZnJvbSB0aGUgaG9zdCBzaWRlLlxuICpcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBlaXRoZXIgQURCIHZlcnNpb24gaXMgdG9vIG9sZCBhbmQgZG9lcyBub3Qgc3VwcG9ydCB0aGlzXG4gKiBjb21tYW5kIG9yIHRoZXJlIHdhcyBhIGZhaWx1cmUgZHVyaW5nIHJlY29ubmVjdC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMucmVjb25uZWN0ID0gYXN5bmMgZnVuY3Rpb24gcmVjb25uZWN0ICh0YXJnZXQgPSAnb2ZmbGluZScpIHtcbiAgbG9nLmRlYnVnKGBSZWNvbm5lY3RpbmcgYWRiICh0YXJnZXQgJHt0YXJnZXR9KWApO1xuXG4gIGNvbnN0IGFyZ3MgPSBbJ3JlY29ubmVjdCddO1xuICBpZiAodGFyZ2V0KSB7XG4gICAgYXJncy5wdXNoKHRhcmdldCk7XG4gIH1cbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmFkYkV4ZWMoYXJncyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCByZWNvbm5lY3QgYWRiLiBPcmlnaW5hbCBlcnJvcjogJHtlLnN0ZGVyciB8fCBlLm1lc3NhZ2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogUmVzdGFydCBhZGIgc2VydmVyLCB1bmxlc3MgX3RoaXMuc3VwcHJlc3NLaWxsU2VydmVyXyBwcm9wZXJ0eSBpcyB0cnVlLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5yZXN0YXJ0QWRiID0gYXN5bmMgZnVuY3Rpb24gcmVzdGFydEFkYiAoKSB7XG4gIGlmICh0aGlzLnN1cHByZXNzS2lsbFNlcnZlcikge1xuICAgIGxvZy5kZWJ1ZyhgTm90IHJlc3RhcnRpbmcgYWJkIHNpbmNlICdzdXBwcmVzc0tpbGxTZXJ2ZXInIGlzIG9uYCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbG9nLmRlYnVnKCdSZXN0YXJ0aW5nIGFkYicpO1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMua2lsbFNlcnZlcigpO1xuICAgIGF3YWl0IHRoaXMuYWRiRXhlYyhbJ3N0YXJ0LXNlcnZlciddKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZy5lcnJvcihgRXJyb3Iga2lsbGluZyBBREIgc2VydmVyLCBnb2luZyB0byBzZWUgaWYgaXQncyBvbmxpbmUgYW55d2F5YCk7XG4gIH1cbn07XG5cbi8qKlxuICogS2lsbCBhZGIgc2VydmVyLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5raWxsU2VydmVyID0gYXN5bmMgZnVuY3Rpb24ga2lsbFNlcnZlciAoKSB7XG4gIGxvZy5kZWJ1ZyhgS2lsbGluZyBhZGIgc2VydmVyIG9uIHBvcnQgJyR7dGhpcy5hZGJQb3J0fSdgKTtcbiAgYXdhaXQgdGhpcy5hZGJFeGVjKFsna2lsbC1zZXJ2ZXInXSwge1xuICAgIGV4Y2x1c2l2ZTogdHJ1ZSxcbiAgfSk7XG59O1xuXG4vKipcbiAqIFJlc2V0IFRlbG5ldCBhdXRoZW50aWNhdGlvbiB0b2tlbi5cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly90b29scy5hbmRyb2lkLmNvbS9yZWNlbnQvZW11bGF0b3IyNTE2cmVsZWFzZW5vdGVzfSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufSBJZiB0b2tlbiByZXNldCB3YXMgc3VjY2Vzc2Z1bC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMucmVzZXRUZWxuZXRBdXRoVG9rZW4gPSBfLm1lbW9pemUoYXN5bmMgZnVuY3Rpb24gcmVzZXRUZWxuZXRBdXRoVG9rZW4gKCkge1xuICAvLyBUaGUgbWV0aG9kcyBpcyB1c2VkIHRvIHJlbW92ZSB0ZWxuZXQgYXV0aCB0b2tlblxuICAvL1xuICBjb25zdCBob21lRm9sZGVyUGF0aCA9IHByb2Nlc3MuZW52Wyhwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSA/ICdVU0VSUFJPRklMRScgOiAnSE9NRSddO1xuICBpZiAoIWhvbWVGb2xkZXJQYXRoKSB7XG4gICAgbG9nLndhcm4oYENhbm5vdCBmaW5kIHRoZSBwYXRoIHRvIHVzZXIgaG9tZSBmb2xkZXIuIElnbm9yaW5nIHJlc2V0dGluZyBvZiBlbXVsYXRvcidzIHRlbG5ldCBhdXRoZW50aWNhdGlvbiB0b2tlbmApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBkc3RQYXRoID0gcGF0aC5yZXNvbHZlKGhvbWVGb2xkZXJQYXRoLCAnLmVtdWxhdG9yX2NvbnNvbGVfYXV0aF90b2tlbicpO1xuICBsb2cuZGVidWcoYE92ZXJyaWRpbmcgJHtkc3RQYXRofSB3aXRoIGFuIGVtcHR5IHN0cmluZyB0byBhdm9pZCB0ZWxuZXQgYXV0aGVudGljYXRpb24gZm9yIGVtdWxhdG9yIGNvbW1hbmRzYCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKGRzdFBhdGgsICcnKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZy53YXJuKGBFcnJvciAke2UubWVzc2FnZX0gd2hpbGUgcmVzZXR0aW5nIHRoZSBjb250ZW50IG9mICR7ZHN0UGF0aH0uIElnbm9yaW5nIHJlc2V0dGluZyBvZiBlbXVsYXRvcidzIHRlbG5ldCBhdXRoZW50aWNhdGlvbiB0b2tlbmApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn0pO1xuXG4vKipcbiAqIEV4ZWN1dGUgdGhlIGdpdmVuIGVtdWxhdG9yIGNvbW1hbmQgdXNpbmcgX2FkYiBlbXVfIHRvb2wuXG4gKlxuICogQHBhcmFtIHtBcnJheS48c3RyaW5nPn0gY21kIC0gVGhlIGFycmF5IG9mIHJlc3QgY29tbWFuZCBsaW5lIHBhcmFtZXRlcnMuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmFkYkV4ZWNFbXUgPSBhc3luYyBmdW5jdGlvbiBhZGJFeGVjRW11IChjbWQpIHtcbiAgYXdhaXQgdGhpcy52ZXJpZnlFbXVsYXRvckNvbm5lY3RlZCgpO1xuICBhd2FpdCB0aGlzLnJlc2V0VGVsbmV0QXV0aFRva2VuKCk7XG4gIGF3YWl0IHRoaXMuYWRiRXhlYyhbJ2VtdScsIC4uLmNtZF0pO1xufTtcblxubGV0IGlzRXhlY0xvY2tlZCA9IGZhbHNlO1xuXG5zeXN0ZW1DYWxsTWV0aG9kcy5FWEVDX09VVFBVVF9GT1JNQVQgPSBPYmplY3QuZnJlZXplKHtcbiAgU1RET1VUOiAnc3Rkb3V0JyxcbiAgRlVMTDogJ2Z1bGwnLFxufSk7XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gRXhlY1Jlc3VsdFxuICogQHByb3BlcnR5IHtzdHJpbmd9IHN0ZG91dCBUaGUgc3Rkb3V0IHJlY2VpdmVkIGZyb20gZXhlY1xuICogQHByb3BlcnR5IHtzdHJpbmd9IHN0ZGVyciBUaGUgc3RkZXJyIHJlY2VpdmVkIGZyb20gZXhlY1xuICovXG5cbi8qKlxuICogRXhlY3V0ZSB0aGUgZ2l2ZW4gYWRiIGNvbW1hbmQuXG4gKlxuICogQHBhcmFtIHtBcnJheS48c3RyaW5nPn0gY21kIC0gVGhlIGFycmF5IG9mIHJlc3QgY29tbWFuZCBsaW5lIHBhcmFtZXRlcnNcbiAqICAgICAgICAgICAgICAgICAgICAgIG9yIGEgc2luZ2xlIHN0cmluZyBwYXJhbWV0ZXIuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0cyAtIEFkZGl0aW9uYWwgb3B0aW9ucyBtYXBwaW5nLiBTZWVcbiAqICAgICAgICAgICAgICAgICAgICAgICAge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vbm9kZS10ZWVuX3Byb2Nlc3N9XG4gKiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtb3JlIGRldGFpbHMuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIFlvdSBjYW4gYWxzbyBzZXQgdGhlIGFkZGl0aW9uYWwgYGV4Y2x1c2l2ZWAgcGFyYW1cbiAqICAgICAgICAgICAgICAgICAgICAgICAgdG8gYHRydWVgIHRoYXQgYXNzdXJlcyBubyBvdGhlciBwYXJhbGxlbCBhZGIgY29tbWFuZHNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgYXJlIGdvaW5nIHRvIGJlIGV4ZWN1dGVkIHdoaWxlIHRoZSBjdXJyZW50IG9uZSBpcyBydW5uaW5nXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIFlvdSBjYW4gc2V0IHRoZSBgb3V0cHV0Rm9ybWF0YCBwYXJhbSB0byBgc3Rkb3V0YCB0byByZWNlaXZlIGp1c3QgdGhlIHN0ZG91dFxuICogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKGRlZmF1bHQpIG9yIGBmdWxsYCB0byByZWNlaXZlIHRoZSBzdGRvdXQgYW5kIHN0ZGVyciByZXNwb25zZSBmcm9tIGFcbiAqICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZCB3aXRoIGEgemVybyBleGl0IGNvZGVcbiAqIEByZXR1cm4ge3N0cmluZ3xFeGVjUmVzdWx0fSAtIENvbW1hbmQncyBzdGRvdXQgb3IgYW4gb2JqZWN0IGNvbnRhaW5pbmcgc3Rkb3V0IGFuZCBzdGRlcnIuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvbW1hbmQgcmV0dXJuZWQgbm9uLXplcm8gZXhpdCBjb2RlLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5hZGJFeGVjID0gYXN5bmMgZnVuY3Rpb24gYWRiRXhlYyAoY21kLCBvcHRzID0ge30pIHtcbiAgaWYgKCFjbWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBuZWVkIHRvIHBhc3MgaW4gYSBjb21tYW5kIHRvIGFkYkV4ZWMoKScpO1xuICB9XG5cbiAgb3B0cyA9IF8uY2xvbmVEZWVwKG9wdHMpO1xuICAvLyBzZXR0aW5nIGRlZmF1bHQgdGltZW91dCBmb3IgZWFjaCBjb21tYW5kIHRvIHByZXZlbnQgaW5maW5pdGUgd2FpdC5cbiAgb3B0cy50aW1lb3V0ID0gb3B0cy50aW1lb3V0IHx8IHRoaXMuYWRiRXhlY1RpbWVvdXQgfHwgREVGQVVMVF9BREJfRVhFQ19USU1FT1VUO1xuICBvcHRzLnRpbWVvdXRDYXBOYW1lID0gb3B0cy50aW1lb3V0Q2FwTmFtZSB8fCAnYWRiRXhlY1RpbWVvdXQnOyAvLyBGb3IgZXJyb3IgbWVzc2FnZVxuXG4gIGNvbnN0IHtvdXRwdXRGb3JtYXQgPSB0aGlzLkVYRUNfT1VUUFVUX0ZPUk1BVC5TVERPVVR9ID0gb3B0cztcblxuICBjbWQgPSBfLmlzQXJyYXkoY21kKSA/IGNtZCA6IFtjbWRdO1xuICBsZXQgYWRiUmV0cmllZCA9IGZhbHNlO1xuICBjb25zdCBleGVjRnVuYyA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYXJncyA9IFsuLi50aGlzLmV4ZWN1dGFibGUuZGVmYXVsdEFyZ3MsIC4uLmNtZF07XG4gICAgICBsb2cuZGVidWcoYFJ1bm5pbmcgJyR7dGhpcy5leGVjdXRhYmxlLnBhdGh9IGAgK1xuICAgICAgICAoYXJncy5maW5kKChhcmcpID0+IC9cXHMrLy50ZXN0KGFyZykpID8gdXRpbC5xdW90ZShhcmdzKSA6IGFyZ3Muam9pbignICcpKSArIGAnYCk7XG4gICAgICBsZXQge3N0ZG91dCwgc3RkZXJyfSA9IGF3YWl0IGV4ZWModGhpcy5leGVjdXRhYmxlLnBhdGgsIGFyZ3MsIG9wdHMpO1xuICAgICAgLy8gc29tZXRpbWVzIEFEQiBwcmludHMgb3V0IHdlaXJkIHN0ZG91dCB3YXJuaW5ncyB0aGF0IHdlIGRvbid0IHdhbnRcbiAgICAgIC8vIHRvIGluY2x1ZGUgaW4gYW55IG9mIHRoZSByZXNwb25zZSBkYXRhLCBzbyBsZXQncyBzdHJpcCBpdCBvdXRcbiAgICAgIHN0ZG91dCA9IHN0ZG91dC5yZXBsYWNlKExJTktFUl9XQVJOSU5HX1JFR0VYUCwgJycpLnRyaW0oKTtcbiAgICAgIHJldHVybiBvdXRwdXRGb3JtYXQgPT09IHRoaXMuRVhFQ19PVVRQVVRfRk9STUFULkZVTEwgPyB7c3Rkb3V0LCBzdGRlcnJ9IDogc3Rkb3V0O1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnN0IGVyclRleHQgPSBgJHtlLm1lc3NhZ2V9LCAke2Uuc3Rkb3V0fSwgJHtlLnN0ZGVycn1gO1xuICAgICAgaWYgKEFEQl9SRVRSWV9FUlJPUl9QQVRURVJOUy5zb21lKChwKSA9PiBwLnRlc3QoZXJyVGV4dCkpKSB7XG4gICAgICAgIGxvZy5pbmZvKGBFcnJvciBzZW5kaW5nIGNvbW1hbmQsIHJlY29ubmVjdGluZyBkZXZpY2UgYW5kIHJldHJ5aW5nOiAke2NtZH1gKTtcbiAgICAgICAgYXdhaXQgc2xlZXAoMTAwMCk7XG4gICAgICAgIGF3YWl0IHRoaXMuZ2V0RGV2aWNlc1dpdGhSZXRyeSgpO1xuXG4gICAgICAgIC8vIHRyeSBhZ2FpbiBvbmUgdGltZVxuICAgICAgICBpZiAoYWRiUmV0cmllZCkge1xuICAgICAgICAgIGFkYlJldHJpZWQgPSB0cnVlO1xuICAgICAgICAgIHJldHVybiBhd2FpdCBleGVjRnVuYygpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChlLmNvZGUgPT09IDAgJiYgZS5zdGRvdXQpIHtcbiAgICAgICAgcmV0dXJuIGUuc3Rkb3V0LnJlcGxhY2UoTElOS0VSX1dBUk5JTkdfUkVHRVhQLCAnJykudHJpbSgpO1xuICAgICAgfVxuXG4gICAgICBpZiAoXy5pc051bGwoZS5jb2RlKSkge1xuICAgICAgICBlLm1lc3NhZ2UgPSBgRXJyb3IgZXhlY3V0aW5nIGFkYkV4ZWMuIE9yaWdpbmFsIGVycm9yOiAnJHtlLm1lc3NhZ2V9Jy4gYCArXG4gICAgICAgICAgYFRyeSB0byBpbmNyZWFzZSB0aGUgJHtvcHRzLnRpbWVvdXR9bXMgYWRiIGV4ZWN1dGlvbiB0aW1lb3V0IHJlcHJlc2VudGVkIGJ5ICcke29wdHMudGltZW91dENhcE5hbWV9JyBjYXBhYmlsaXR5YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGUubWVzc2FnZSA9IGBFcnJvciBleGVjdXRpbmcgYWRiRXhlYy4gT3JpZ2luYWwgZXJyb3I6ICcke2UubWVzc2FnZX0nOyBgICtcbiAgICAgICAgICBgQ29tbWFuZCBvdXRwdXQ6ICR7ZS5zdGRlcnIgfHwgZS5zdGRvdXQgfHwgJzxlbXB0eT4nfWA7XG4gICAgICB9XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfTtcblxuICBpZiAoaXNFeGVjTG9ja2VkKSB7XG4gICAgbG9nLmRlYnVnKCdXYWl0aW5nIHVudGlsIHRoZSBvdGhlciBleGNsdXNpdmUgQURCIGNvbW1hbmQgaXMgY29tcGxldGVkJyk7XG4gICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbigoKSA9PiAhaXNFeGVjTG9ja2VkLCB7XG4gICAgICB3YWl0TXM6IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSLFxuICAgICAgaW50ZXJ2YWxNczogMTAsXG4gICAgfSk7XG4gICAgbG9nLmRlYnVnKCdDb250aW51aW5nIHdpdGggdGhlIGN1cnJlbnQgQURCIGNvbW1hbmQnKTtcbiAgfVxuICBpZiAob3B0cy5leGNsdXNpdmUpIHtcbiAgICBpc0V4ZWNMb2NrZWQgPSB0cnVlO1xuICB9XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGV4ZWNGdW5jKCk7XG4gIH0gZmluYWxseSB7XG4gICAgaWYgKG9wdHMuZXhjbHVzaXZlKSB7XG4gICAgICBpc0V4ZWNMb2NrZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU2hlbGxFeGVjT3B0aW9uc1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSB0aW1lb3V0Q2FwTmFtZSBbYWRiRXhlY1RpbWVvdXRdIC0gdGhlIG5hbWUgb2YgdGhlIGNvcnJlc3BvbmRpbmcgQXBwaXVtJ3MgdGltZW91dCBjYXBhYmlsaXR5XG4gKiAodXNlZCBpbiB0aGUgZXJyb3IgbWVzc2FnZXMpLlxuICogQHByb3BlcnR5IHs/bnVtYmVyfSB0aW1lb3V0IFthZGJFeGVjVGltZW91dF0gLSBjb21tYW5kIGV4ZWN1dGlvbiB0aW1lb3V0LlxuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gcHJpdmlsZWdlZCBbZmFsc3ldIC0gV2hldGhlciB0byBydW4gdGhlIGdpdmVuIGNvbW1hbmQgYXMgcm9vdC5cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gb3V0cHV0Rm9ybWF0IFtzdGRvdXRdIC0gV2hldGhlciByZXNwb25zZSBzaG91bGQgaW5jbHVkZSBmdWxsIGV4ZWMgb3V0cHV0IG9yIGp1c3Qgc3Rkb3V0LlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3RlbnRpYWwgdmFsdWVzIGFyZSBmdWxsIG9yIHN0ZG91dC5cbiAqXG4gKiBBbGwgb3RoZXIgcHJvcGVydGllcyBhcmUgdGhlIHNhbWUgYXMgZm9yIGBleGVjYCBjYWxsIGZyb20ge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vbm9kZS10ZWVuX3Byb2Nlc3N9XG4gKiBtb2R1bGVcbiAqL1xuXG4vKipcbiAqIEV4ZWN1dGUgdGhlIGdpdmVuIGNvbW1hbmQgdXNpbmcgX2FkYiBzaGVsbF8gcHJlZml4LlxuICpcbiAqIEBwYXJhbSB7IUFycmF5LjxzdHJpbmc+fHN0cmluZ30gY21kIC0gVGhlIGFycmF5IG9mIHJlc3QgY29tbWFuZCBsaW5lIHBhcmFtZXRlcnMgb3IgYSBzaW5nbGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgcGFyYW1ldGVyLlxuICogQHBhcmFtIHs/U2hlbGxFeGVjT3B0aW9uc30gb3B0cyBbe31dIC0gQWRkaXRpb25hbCBvcHRpb25zIG1hcHBpbmcuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IC0gQ29tbWFuZCdzIHN0ZG91dC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29tbWFuZCByZXR1cm5lZCBub24temVybyBleGl0IGNvZGUuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLnNoZWxsID0gYXN5bmMgZnVuY3Rpb24gc2hlbGwgKGNtZCwgb3B0cyA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICBwcml2aWxlZ2VkLFxuICB9ID0gb3B0cztcblxuICBjb25zdCBjbWRBcnIgPSBfLmlzQXJyYXkoY21kKSA/IGNtZCA6IFtjbWRdO1xuICBjb25zdCBmdWxsQ21kID0gWydzaGVsbCddO1xuICBpZiAocHJpdmlsZWdlZCkge1xuICAgIGxvZy5pbmZvKGAnYWRiIHNoZWxsICR7dXRpbC5xdW90ZShjbWRBcnIpfScgcmVxdWlyZXMgcm9vdCBhY2Nlc3NgKTtcbiAgICBpZiAoYXdhaXQgdGhpcy5pc1Jvb3QoKSkge1xuICAgICAgbG9nLmluZm8oJ1RoZSBkZXZpY2UgYWxyZWFkeSBoYWQgcm9vdCBhY2Nlc3MnKTtcbiAgICAgIGZ1bGxDbWQucHVzaCguLi5jbWRBcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmdWxsQ21kLnB1c2goJ3N1JywgJ3Jvb3QnLCB1dGlsLnF1b3RlKGNtZEFycikpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmdWxsQ21kLnB1c2goLi4uY21kQXJyKTtcbiAgfVxuICByZXR1cm4gYXdhaXQgdGhpcy5hZGJFeGVjKGZ1bGxDbWQsIG9wdHMpO1xufTtcblxuc3lzdGVtQ2FsbE1ldGhvZHMuY3JlYXRlU3ViUHJvY2VzcyA9IGZ1bmN0aW9uIGNyZWF0ZVN1YlByb2Nlc3MgKGFyZ3MgPSBbXSkge1xuICAvLyBhZGQgdGhlIGRlZmF1bHQgYXJndW1lbnRzXG4gIGFyZ3MgPSBbLi4udGhpcy5leGVjdXRhYmxlLmRlZmF1bHRBcmdzLCAuLi5hcmdzXTtcbiAgbG9nLmRlYnVnKGBDcmVhdGluZyBBREIgc3VicHJvY2VzcyB3aXRoIGFyZ3M6ICR7SlNPTi5zdHJpbmdpZnkoYXJncyl9YCk7XG4gIHJldHVybiBuZXcgU3ViUHJvY2Vzcyh0aGlzLmdldEFkYlBhdGgoKSwgYXJncyk7XG59O1xuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBjdXJyZW50IGFkYiBwb3J0LlxuICogQHRvZG8gY2FuIHByb2JhYmx5IGRlcHJlY2F0ZSB0aGlzIG5vdyB0aGF0IHRoZSBsb2dpYyBpcyBqdXN0IHRvIHJlYWQgdGhpcy5hZGJQb3J0XG4gKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBjdXJyZW50IGFkYiBwb3J0IG51bWJlci5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0QWRiU2VydmVyUG9ydCA9IGZ1bmN0aW9uIGdldEFkYlNlcnZlclBvcnQgKCkge1xuICByZXR1cm4gdGhpcy5hZGJQb3J0O1xufTtcblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBlbXVsYXRvciBwb3J0IGZyb20gX2FkYiBkZXZpdmVzXyBvdXRwdXQuXG4gKlxuICogQHJldHVybiB7bnVtYmVyfSBUaGUgY3VycmVudCBlbXVsYXRvciBwb3J0LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIGFyZSBubyBjb25uZWN0ZWQgZGV2aWNlcy5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0RW11bGF0b3JQb3J0ID0gYXN5bmMgZnVuY3Rpb24gZ2V0RW11bGF0b3JQb3J0ICgpIHtcbiAgbG9nLmRlYnVnKCdHZXR0aW5nIHJ1bm5pbmcgZW11bGF0b3IgcG9ydCcpO1xuICBpZiAodGhpcy5lbXVsYXRvclBvcnQgIT09IG51bGwpIHtcbiAgICByZXR1cm4gdGhpcy5lbXVsYXRvclBvcnQ7XG4gIH1cbiAgdHJ5IHtcbiAgICBsZXQgZGV2aWNlcyA9IGF3YWl0IHRoaXMuZ2V0Q29ubmVjdGVkRGV2aWNlcygpO1xuICAgIGxldCBwb3J0ID0gdGhpcy5nZXRQb3J0RnJvbUVtdWxhdG9yU3RyaW5nKGRldmljZXNbMF0udWRpZCk7XG4gICAgaWYgKHBvcnQpIHtcbiAgICAgIHJldHVybiBwb3J0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVtdWxhdG9yIHBvcnQgbm90IGZvdW5kYCk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBObyBkZXZpY2VzIGNvbm5lY3RlZC4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBjdXJyZW50IGVtdWxhdG9yIHBvcnQgYnkgcGFyc2luZyBlbXVsYXRvciBuYW1lIHN0cmluZy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZW1TdHIgLSBFbXVsYXRvciBuYW1lIHN0cmluZy5cbiAqIEByZXR1cm4ge251bWJlcnxib29sZWFufSBFaXRoZXIgdGhlIGN1cnJlbnQgZW11bGF0b3IgcG9ydCBvclxuICogICAgICAgICAgICAgICAgICAgICAgICAgIF9mYWxzZV8gaWYgcG9ydCBudW1iZXIgY2Fubm90IGJlIHBhcnNlZC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0UG9ydEZyb21FbXVsYXRvclN0cmluZyA9IGZ1bmN0aW9uIGdldFBvcnRGcm9tRW11bGF0b3JTdHJpbmcgKGVtU3RyKSB7XG4gIGxldCBwb3J0UGF0dGVybiA9IC9lbXVsYXRvci0oXFxkKykvO1xuICBpZiAocG9ydFBhdHRlcm4udGVzdChlbVN0cikpIHtcbiAgICByZXR1cm4gcGFyc2VJbnQocG9ydFBhdHRlcm4uZXhlYyhlbVN0cilbMV0sIDEwKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBsaXN0IG9mIGN1cnJlbnRseSBjb25uZWN0ZWQgZW11bGF0b3JzLlxuICpcbiAqIEBwYXJhbSB7P0Nvbm5lY3RlZERldmljZXNPcHRpb25zfSBvcHRzIFt7fV0gLSBBZGRpdGlvbmFsIG9wdGlvbnMgbWFwcGluZy5cbiAqIEByZXR1cm4ge0FycmF5LjxEZXZpY2U+fSBUaGUgbGlzdCBvZiBjb25uZWN0ZWQgZGV2aWNlcy5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZ2V0Q29ubmVjdGVkRW11bGF0b3JzID0gYXN5bmMgZnVuY3Rpb24gZ2V0Q29ubmVjdGVkRW11bGF0b3JzIChvcHRzID0ge30pIHtcbiAgbG9nLmRlYnVnKCdHZXR0aW5nIGNvbm5lY3RlZCBlbXVsYXRvcnMnKTtcbiAgdHJ5IHtcbiAgICBsZXQgZGV2aWNlcyA9IGF3YWl0IHRoaXMuZ2V0Q29ubmVjdGVkRGV2aWNlcyhvcHRzKTtcbiAgICBsZXQgZW11bGF0b3JzID0gW107XG4gICAgZm9yIChsZXQgZGV2aWNlIG9mIGRldmljZXMpIHtcbiAgICAgIGxldCBwb3J0ID0gdGhpcy5nZXRQb3J0RnJvbUVtdWxhdG9yU3RyaW5nKGRldmljZS51ZGlkKTtcbiAgICAgIGlmIChwb3J0KSB7XG4gICAgICAgIGRldmljZS5wb3J0ID0gcG9ydDtcbiAgICAgICAgZW11bGF0b3JzLnB1c2goZGV2aWNlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgbG9nLmRlYnVnKGAke3V0aWwucGx1cmFsaXplKCdlbXVsYXRvcicsIGVtdWxhdG9ycy5sZW5ndGgsIHRydWUpfSBjb25uZWN0ZWRgKTtcbiAgICByZXR1cm4gZW11bGF0b3JzO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBnZXR0aW5nIGVtdWxhdG9ycy4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIFNldCBfZW11bGF0b3JQb3J0XyBwcm9wZXJ0eSBvZiB0aGUgY3VycmVudCBjbGFzcy5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gZW1Qb3J0IC0gVGhlIGVtdWxhdG9yIHBvcnQgdG8gYmUgc2V0LlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5zZXRFbXVsYXRvclBvcnQgPSBmdW5jdGlvbiBzZXRFbXVsYXRvclBvcnQgKGVtUG9ydCkge1xuICB0aGlzLmVtdWxhdG9yUG9ydCA9IGVtUG9ydDtcbn07XG5cbi8qKlxuICogU2V0IHRoZSBpZGVudGlmaWVyIG9mIHRoZSBjdXJyZW50IGRldmljZSAoX3RoaXMuY3VyRGV2aWNlSWRfKS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gLSBUaGUgZGV2aWNlIGlkZW50aWZpZXIuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLnNldERldmljZUlkID0gZnVuY3Rpb24gc2V0RGV2aWNlSWQgKGRldmljZUlkKSB7XG4gIGxvZy5kZWJ1ZyhgU2V0dGluZyBkZXZpY2UgaWQgdG8gJHtkZXZpY2VJZH1gKTtcbiAgdGhpcy5jdXJEZXZpY2VJZCA9IGRldmljZUlkO1xuICBsZXQgYXJnc0hhc0RldmljZSA9IHRoaXMuZXhlY3V0YWJsZS5kZWZhdWx0QXJncy5pbmRleE9mKCctcycpO1xuICBpZiAoYXJnc0hhc0RldmljZSAhPT0gLTEpIHtcbiAgICAvLyByZW1vdmUgdGhlIG9sZCBkZXZpY2UgaWQgZnJvbSB0aGUgYXJndW1lbnRzXG4gICAgdGhpcy5leGVjdXRhYmxlLmRlZmF1bHRBcmdzLnNwbGljZShhcmdzSGFzRGV2aWNlLCAyKTtcbiAgfVxuICB0aGlzLmV4ZWN1dGFibGUuZGVmYXVsdEFyZ3MucHVzaCgnLXMnLCBkZXZpY2VJZCk7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgdGhlIGN1cnJlbnQgZGV2aWNlIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge0RldmljZX0gZGV2aWNlT2JqIC0gVGhlIGRldmljZSBvYmplY3QgdG8gYmUgc2V0LlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5zZXREZXZpY2UgPSBmdW5jdGlvbiBzZXREZXZpY2UgKGRldmljZU9iaikge1xuICBsZXQgZGV2aWNlSWQgPSBkZXZpY2VPYmoudWRpZDtcbiAgbGV0IGVtUG9ydCA9IHRoaXMuZ2V0UG9ydEZyb21FbXVsYXRvclN0cmluZyhkZXZpY2VJZCk7XG4gIHRoaXMuc2V0RW11bGF0b3JQb3J0KGVtUG9ydCk7XG4gIHRoaXMuc2V0RGV2aWNlSWQoZGV2aWNlSWQpO1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIG9iamVjdCBmb3IgdGhlIGN1cnJlbnRseSBydW5uaW5nIGVtdWxhdG9yLlxuICogISEhIFRoaXMgbWV0aG9kIGhhcyBhIHNpZGUgZWZmZWN0IC0gaXQgaW1wbGljaXRseSBjaGFuZ2VzIHRoZVxuICogYGRldmljZUlkYCAob25seSBpZiBBVkQgd2l0aCBhIG1hdGNoaW5nIG5hbWUgaXMgZm91bmQpXG4gKiBhbmQgYGVtdWxhdG9yUG9ydGAgaW5zdGFuY2UgcHJvcGVydGllcy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXZkTmFtZSAtIEVtdWxhdG9yIG5hbWUuXG4gKiBAcmV0dXJuIHs/RGV2aWNlfSBDdXJyZW50bHkgcnVubmluZyBlbXVsYXRvciBvciBfbnVsbF8uXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldFJ1bm5pbmdBVkQgPSBhc3luYyBmdW5jdGlvbiBnZXRSdW5uaW5nQVZEIChhdmROYW1lKSB7XG4gIGxvZy5kZWJ1ZyhgVHJ5aW5nIHRvIGZpbmQgJyR7YXZkTmFtZX0nIGVtdWxhdG9yYCk7XG4gIHRyeSB7XG4gICAgY29uc3QgZW11bGF0b3JzID0gYXdhaXQgdGhpcy5nZXRDb25uZWN0ZWRFbXVsYXRvcnMoKTtcbiAgICBmb3IgKGNvbnN0IGVtdWxhdG9yIG9mIGVtdWxhdG9ycykge1xuICAgICAgdGhpcy5zZXRFbXVsYXRvclBvcnQoZW11bGF0b3IucG9ydCk7XG4gICAgICBjb25zdCBydW5uaW5nQVZETmFtZSA9IGF3YWl0IHRoaXMuZXhlY0VtdUNvbnNvbGVDb21tYW5kKFsnYXZkJywgJ25hbWUnXSwge1xuICAgICAgICBwb3J0OiBlbXVsYXRvci5wb3J0LFxuICAgICAgICBleGVjVGltZW91dDogNTAwMCxcbiAgICAgICAgY29ublRpbWVvdXQ6IDEwMDAsXG4gICAgICB9KTtcbiAgICAgIGlmIChfLnRvTG93ZXIoYXZkTmFtZSkgPT09IF8udG9Mb3dlcihydW5uaW5nQVZETmFtZS50cmltKCkpKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgRm91bmQgZW11bGF0b3IgJyR7YXZkTmFtZX0nIG9uIHBvcnQgJHtlbXVsYXRvci5wb3J0fWApO1xuICAgICAgICB0aGlzLnNldERldmljZUlkKGVtdWxhdG9yLnVkaWQpO1xuICAgICAgICByZXR1cm4gZW11bGF0b3I7XG4gICAgICB9XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgRW11bGF0b3IgJyR7YXZkTmFtZX0nIG5vdCBydW5uaW5nYCk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGdldHRpbmcgQVZELiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogR2V0IHRoZSBvYmplY3QgZm9yIHRoZSBjdXJyZW50bHkgcnVubmluZyBlbXVsYXRvci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXZkTmFtZSAtIEVtdWxhdG9yIG5hbWUuXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZW91dE1zIFsyMDAwMF0gLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byB3YWl0IHVudGlsIGF0IGxlYXN0IG9uZSBydW5uaW5nIEFWRCBvYmplY3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzIGRldGVjdGVkLlxuICogQHJldHVybiB7P0RldmljZX0gQ3VycmVudGx5IHJ1bm5pbmcgZW11bGF0b3Igb3IgX251bGxfLlxuICogQHRocm93cyB7RXJyb3J9IElmIG5vIGRldmljZSBoYXMgYmVlbiBkZXRlY3RlZCB3aXRoaW4gdGhlIHRpbWVvdXQuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldFJ1bm5pbmdBVkRXaXRoUmV0cnkgPSBhc3luYyBmdW5jdGlvbiBnZXRSdW5uaW5nQVZEV2l0aFJldHJ5IChhdmROYW1lLCB0aW1lb3V0TXMgPSAyMDAwMCkge1xuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCB3YWl0Rm9yQ29uZGl0aW9uKGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldFJ1bm5pbmdBVkQoYXZkTmFtZS5yZXBsYWNlKCdAJywgJycpKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nLmRlYnVnKGUubWVzc2FnZSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICB3YWl0TXM6IHRpbWVvdXRNcyxcbiAgICAgIGludGVydmFsTXM6IDEwMDAsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGdldHRpbmcgQVZEIHdpdGggcmV0cnkuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBTaHV0ZG93biBhbGwgcnVubmluZyBlbXVsYXRvcnMgYnkga2lsbGluZyB0aGVpciBwcm9jZXNzZXMuXG4gKlxuICogQHRocm93cyB7RXJyb3J9IElmIGtpbGxpbmcgdG9vbCByZXR1cm5lZCBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMua2lsbEFsbEVtdWxhdG9ycyA9IGFzeW5jIGZ1bmN0aW9uIGtpbGxBbGxFbXVsYXRvcnMgKCkge1xuICBsZXQgY21kLCBhcmdzO1xuICBpZiAoc3lzdGVtLmlzV2luZG93cygpKSB7XG4gICAgY21kID0gJ1RBU0tLSUxMJztcbiAgICBhcmdzID0gWydUQVNLS0lMTCcsICcvSU0nLCAnZW11bGF0b3IuZXhlJ107XG4gIH0gZWxzZSB7XG4gICAgY21kID0gJy91c3IvYmluL2tpbGxhbGwnO1xuICAgIGFyZ3MgPSBbJy1tJywgJ2VtdWxhdG9yKiddO1xuICB9XG4gIHRyeSB7XG4gICAgYXdhaXQgZXhlYyhjbWQsIGFyZ3MpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBraWxsaW5nIGVtdWxhdG9ycy4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIEtpbGwgZW11bGF0b3Igd2l0aCB0aGUgZ2l2ZW4gbmFtZS4gTm8gZXJyb3JcbiAqIGlzIHRocm93biBpcyBnaXZlbiBhdmQgZG9lcyBub3QgZXhpc3QvaXMgbm90IHJ1bm5pbmcuXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfSBhdmROYW1lIC0gVGhlIG5hbWUgb2YgdGhlIGVtdWxhdG9yIHRvIGJlIGtpbGxlZC4gSWYgZW1wdHksXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgY3VycmVudCBlbXVsYXRvciB3aWxsIGJlIGtpbGxlZC5cbiAqIEBwYXJhbSB7P251bWJlcn0gdGltZW91dCBbNjAwMDBdIC0gVGhlIGFtb3VudCBvZiB0aW1lIHRvIHdhaXQgYmVmb3JlIHRocm93aW5nXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuIGV4Y2VwdGlvbiBhYm91dCB1bnN1Y2Nlc3NmdWwga2lsbGluZ1xuICogQHJldHVybiB7Ym9vbGVhbn0gLSBUcnVlIGlmIHRoZSBlbXVsYXRvciB3YXMga2lsbGVkLCBmYWxzZSBvdGhlcndpc2UuXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgdGhlcmUgd2FzIGEgZmFpbHVyZSBieSBraWxsaW5nIHRoZSBlbXVsYXRvclxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5raWxsRW11bGF0b3IgPSBhc3luYyBmdW5jdGlvbiBraWxsRW11bGF0b3IgKGF2ZE5hbWUgPSBudWxsLCB0aW1lb3V0ID0gNjAwMDApIHtcbiAgaWYgKHV0aWwuaGFzVmFsdWUoYXZkTmFtZSkpIHtcbiAgICBsb2cuZGVidWcoYEtpbGxpbmcgYXZkICcke2F2ZE5hbWV9J2ApO1xuICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IHRoaXMuZ2V0UnVubmluZ0FWRChhdmROYW1lKTtcbiAgICBpZiAoIWRldmljZSkge1xuICAgICAgbG9nLmluZm8oYE5vIGF2ZCB3aXRoIG5hbWUgJyR7YXZkTmFtZX0nIHJ1bm5pbmcuIFNraXBwaW5nIGtpbGwgc3RlcC5gKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8ga2lsbGluZyB0aGUgY3VycmVudCBhdmRcbiAgICBsb2cuZGVidWcoYEtpbGxpbmcgYXZkIHdpdGggaWQgJyR7dGhpcy5jdXJEZXZpY2VJZH0nYCk7XG4gICAgaWYgKCFhd2FpdCB0aGlzLmlzRW11bGF0b3JDb25uZWN0ZWQoKSkge1xuICAgICAgbG9nLmRlYnVnKGBFbXVsYXRvciB3aXRoIGlkICcke3RoaXMuY3VyRGV2aWNlSWR9JyBub3QgY29ubmVjdGVkLiBTa2lwcGluZyBraWxsIHN0ZXBgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgYXdhaXQgdGhpcy5hZGJFeGVjKFsnZW11JywgJ2tpbGwnXSk7XG4gIGxvZy5kZWJ1ZyhgV2FpdGluZyB1cCB0byAke3RpbWVvdXR9bXMgdW50aWwgdGhlIGVtdWxhdG9yICcke2F2ZE5hbWUgPyBhdmROYW1lIDogdGhpcy5jdXJEZXZpY2VJZH0nIGlzIGtpbGxlZGApO1xuICB0cnkge1xuICAgIGF3YWl0IHdhaXRGb3JDb25kaXRpb24oYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHV0aWwuaGFzVmFsdWUoYXZkTmFtZSlcbiAgICAgICAgICA/ICFhd2FpdCB0aGlzLmdldFJ1bm5pbmdBVkQoYXZkTmFtZSlcbiAgICAgICAgICA6ICFhd2FpdCB0aGlzLmlzRW11bGF0b3JDb25uZWN0ZWQoKTtcbiAgICAgIH0gY2F0Y2ggKGlnbikge31cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LCB7XG4gICAgICB3YWl0TXM6IHRpbWVvdXQsXG4gICAgICBpbnRlcnZhbE1zOiAyMDAwLFxuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgZW11bGF0b3IgJyR7YXZkTmFtZSA/IGF2ZE5hbWUgOiB0aGlzLmN1ckRldmljZUlkfScgaXMgc3RpbGwgcnVubmluZyBhZnRlciBiZWluZyBraWxsZWQgJHt0aW1lb3V0fW1zIGFnb2ApO1xuICB9XG4gIGxvZy5pbmZvKGBTdWNjZXNzZnVsbHkga2lsbGVkIHRoZSAnJHthdmROYW1lID8gYXZkTmFtZSA6IHRoaXMuY3VyRGV2aWNlSWR9JyBlbXVsYXRvcmApO1xuICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQXZkTGF1bmNoT3B0aW9uc1xuICogQHByb3BlcnR5IHtzdHJpbmd8QXJyYXk8c3RyaW5nPn0gYXJncyBBZGRpdGlvbmFsIGVtdWxhdG9yIGNvbW1hbmQgbGluZSBhcmd1bWVudHNcbiAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBlbnYgQWRkaXRpb25hbCBlbXVsYXRvciBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBsYW5ndWFnZSBFbXVsYXRvciBzeXN0ZW0gbGFuZ3VhZ2VcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBjb3VudHJ5IEVtdWxhdG9yIHN5c3RlbSBjb3VudHJ5XG4gKiBAcHJvcGVydHkge251bWJlcn0gbGF1bmNoVGltZW91dCBbNjAwMDBdIEVtdWxhdG9yIHN0YXJ0dXAgdGltZW91dCBpbiBtaWxsaXNlY29uZHNcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSByZWFkeVRpbWVvdXQgWzYwMDAwXSBUaGUgbWF4aW11bSBwZXJpb2Qgb2YgdGltZSB0byB3YWl0IHVudGlsIEVtdWxhdG9yXG4gKiBpcyByZWFkeSBmb3IgdXNhZ2UgaW4gbWlsbGlzZWNvbmRzXG4gKiBAcHJvcGVydHkge251bWJlcn0gcmV0cnlUaW1lcyBbMV0gVGhlIG1heGltdW0gbnVtYmVyIG9mIHN0YXJ0dXAgcmV0cmllc1xuICovXG5cbi8qKlxuICogU3RhcnQgYW4gZW11bGF0b3Igd2l0aCBnaXZlbiBwYXJhbWV0ZXJzIGFuZCB3YWl0IHVudGlsIGl0IGlzIGZ1bGx5IHN0YXJ0ZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGF2ZE5hbWUgLSBUaGUgbmFtZSBvZiBhbiBleGlzdGluZyBlbXVsYXRvci5cbiAqIEBwYXJhbSB7P0F2ZExhdW5jaE9wdGlvbnN9IG9wdHNcbiAqIEByZXR1cm5zIHtTdWJQcm9jZXNzfSBFbXVsYXRvciBzdWJwcm9jZXNzIGluc3RhbmNlXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGVtdWxhdG9yIGZhaWxzIHRvIHN0YXJ0IHdpdGhpbiB0aGUgZ2l2ZW4gdGltZW91dC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMubGF1bmNoQVZEID0gYXN5bmMgZnVuY3Rpb24gbGF1bmNoQVZEIChhdmROYW1lLCBvcHRzID0ge30pIHtcbiAgY29uc3Qge1xuICAgIGFyZ3MgPSBbXSxcbiAgICBlbnYgPSB7fSxcbiAgICBsYW5ndWFnZSxcbiAgICBjb3VudHJ5LFxuICAgIGxhdW5jaFRpbWVvdXQgPSA2MDAwMCxcbiAgICByZWFkeVRpbWVvdXQgPSA2MDAwMCxcbiAgICByZXRyeVRpbWVzID0gMSxcbiAgfSA9IG9wdHM7XG4gIGxvZy5kZWJ1ZyhgTGF1bmNoaW5nIEVtdWxhdG9yIHdpdGggQVZEICR7YXZkTmFtZX0sIGxhdW5jaFRpbWVvdXQgYCArXG4gICAgICAgICAgICBgJHtsYXVuY2hUaW1lb3V0fW1zIGFuZCByZWFkeVRpbWVvdXQgJHtyZWFkeVRpbWVvdXR9bXNgKTtcbiAgY29uc3QgZW11bGF0b3JCaW5hcnlQYXRoID0gYXdhaXQgdGhpcy5nZXRTZGtCaW5hcnlQYXRoKCdlbXVsYXRvcicpO1xuICBpZiAoYXZkTmFtZVswXSA9PT0gJ0AnKSB7XG4gICAgYXZkTmFtZSA9IGF2ZE5hbWUuc3Vic3RyKDEpO1xuICB9XG4gIGF3YWl0IHRoaXMuY2hlY2tBdmRFeGlzdChhdmROYW1lKTtcblxuICBjb25zdCBsYXVuY2hBcmdzID0gWyctYXZkJywgYXZkTmFtZV07XG4gIGxhdW5jaEFyZ3MucHVzaCguLi4odG9BdmRMb2NhbGVBcmdzKGxhbmd1YWdlLCBjb3VudHJ5KSkpO1xuXG4gIGxldCBpc0RlbGF5QWRiRmVhdHVyZUVuYWJsZWQgPSBmYWxzZTtcbiAgaWYgKHRoaXMuYWxsb3dEZWxheUFkYikge1xuICAgIGNvbnN0IHtyZXZpc2lvbn0gPSBhd2FpdCB0aGlzLmdldEVtdVZlcnNpb25JbmZvKCk7XG4gICAgaWYgKHJldmlzaW9uICYmIHV0aWwuY29tcGFyZVZlcnNpb25zKHJldmlzaW9uLCAnPj0nLCAnMjkuMC43JykpIHtcbiAgICAgIC8vIGh0dHBzOi8vYW5kcm9pZHN0dWRpby5nb29nbGVibG9nLmNvbS8yMDE5LzA1L2VtdWxhdG9yLTI5MDctY2FuYXJ5Lmh0bWxcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHt0YXJnZXR9ID0gYXdhaXQgdGhpcy5nZXRFbXVJbWFnZVByb3BlcnRpZXMoYXZkTmFtZSk7XG4gICAgICAgIGNvbnN0IGFwaU1hdGNoID0gL1xcZCsvLmV4ZWModGFyZ2V0KTtcbiAgICAgICAgLy8gaHR0cHM6Ly9pc3N1ZXRyYWNrZXIuZ29vZ2xlLmNvbS9pc3N1ZXMvMTQyNTMzMzU1XG4gICAgICAgIGlmIChhcGlNYXRjaCAmJiBwYXJzZUludChhcGlNYXRjaFswXSwgMTApID49IE1JTl9ERUxBWV9BREJfQVBJX0xFVkVMKSB7XG4gICAgICAgICAgbGF1bmNoQXJncy5wdXNoKCctZGVsYXktYWRiJyk7XG4gICAgICAgICAgaXNEZWxheUFkYkZlYXR1cmVFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBhY3R1YWwgaW1hZ2UgQVBJIHZlcnNpb24gaXMgYmVsb3cgJHtNSU5fREVMQVlfQURCX0FQSV9MRVZFTH1gKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuaW5mbyhgVGhlIC1kZWxheS1hZGIgZW11bGF0b3Igc3RhcnR1cCBkZXRlY3Rpb24gZmVhdHVyZSB3aWxsIG5vdCBiZSBlbmFibGVkLiBgICtcbiAgICAgICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsb2cuaW5mbygnVGhlIC1kZWxheS1hZGIgZW11bGF0b3Igc3RhcnR1cCBkZXRlY3Rpb24gZmVhdHVyZSBoYXMgYmVlbiBleHBsaWNpdGx5IGRpc2FibGVkJyk7XG4gIH1cblxuICBpZiAoIV8uaXNFbXB0eShhcmdzKSkge1xuICAgIGxhdW5jaEFyZ3MucHVzaCguLi4oXy5pc0FycmF5KGFyZ3MpID8gYXJncyA6IHV0aWwuc2hlbGxQYXJzZShgJHthcmdzfWApKSk7XG4gIH1cblxuICBsb2cuZGVidWcoYFJ1bm5pbmcgJyR7ZW11bGF0b3JCaW5hcnlQYXRofScgd2l0aCBhcmdzOiAke3V0aWwucXVvdGUobGF1bmNoQXJncyl9YCk7XG4gIGlmICghXy5pc0VtcHR5KGVudikpIHtcbiAgICBsb2cuZGVidWcoYEN1c3RvbWl6ZWQgZW11bGF0b3IgZW52aXJvbm1lbnQ6ICR7SlNPTi5zdHJpbmdpZnkoZW52KX1gKTtcbiAgfVxuICBjb25zdCBwcm9jID0gbmV3IFN1YlByb2Nlc3MoZW11bGF0b3JCaW5hcnlQYXRoLCBsYXVuY2hBcmdzLCB7XG4gICAgZW52OiBPYmplY3QuYXNzaWduKHt9LCBwcm9jZXNzLmVudiwgZW52KSxcbiAgfSk7XG4gIGF3YWl0IHByb2Muc3RhcnQoMCk7XG4gIHByb2Mub24oJ291dHB1dCcsIChzdGRvdXQsIHN0ZGVycikgPT4ge1xuICAgIGZvciAobGV0IGxpbmUgb2YgKHN0ZG91dCB8fCBzdGRlcnIgfHwgJycpLnNwbGl0KCdcXG4nKS5maWx0ZXIoQm9vbGVhbikpIHtcbiAgICAgIGxvZy5pbmZvKGBbQVZEIE9VVFBVVF0gJHtsaW5lfWApO1xuICAgIH1cbiAgfSk7XG4gIHByb2Mub24oJ2RpZScsIChjb2RlLCBzaWduYWwpID0+IHtcbiAgICBsb2cud2FybihgRW11bGF0b3IgYXZkICR7YXZkTmFtZX0gZXhpdGVkIHdpdGggY29kZSAke2NvZGV9JHtzaWduYWwgPyBgLCBzaWduYWwgJHtzaWduYWx9YCA6ICcnfWApO1xuICB9KTtcbiAgYXdhaXQgcmV0cnkocmV0cnlUaW1lcywgYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5nZXRSdW5uaW5nQVZEV2l0aFJldHJ5KGF2ZE5hbWUsIGxhdW5jaFRpbWVvdXQpKTtcbiAgLy8gQXQgdGhpcyBwb2ludCB3ZSBoYXZlIGRldmljZUlkIGFscmVhZHkgYXNzaWduZWRcbiAgY29uc3QgdGltZXIgPSBuZXcgdGltaW5nLlRpbWVyKCkuc3RhcnQoKTtcbiAgaWYgKGlzRGVsYXlBZGJGZWF0dXJlRW5hYmxlZCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmFkYkV4ZWMoWyd3YWl0LWZvci1kZXZpY2UnXSwge3RpbWVvdXQ6IHJlYWR5VGltZW91dH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7YXZkTmFtZX0nIEVtdWxhdG9yIGhhcyBmYWlsZWQgdG8gYm9vdDogJHtlLnN0ZGVyciB8fCBlLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG4gIGF3YWl0IHRoaXMud2FpdEZvckVtdWxhdG9yUmVhZHkocmVhZHlUaW1lb3V0IC0gdGltZXIuZ2V0RHVyYXRpb24oKS5hc01pbGxpU2Vjb25kcyk7XG4gIHJldHVybiBwcm9jO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBCaW5hcnlWZXJzaW9uXG4gKiBAcHJvcGVydHkge1NlbVZlcn0gdmVyc2lvbiAtIFRoZSBBREIgYmluYXJ5IHZlcnNpb24gbnVtYmVyXG4gKiBAcHJvcGVydHkge251bWJlcn0gYnVpbGQgLSBUaGUgQURCIGJpbmFyeSBidWlsZCBudW1iZXJcbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEJyaWRnZVZlcnNpb25cbiAqIEBwcm9wZXJ0eSB7U2VtVmVyfSB2ZXJzaW9uIC0gVGhlIEFuZHJvaWQgRGVidWcgQnJpZGdlIHZlcnNpb24gbnVtYmVyXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBWZXJzaW9uXG4gKiBAcHJvcGVydHkgez9CaW5hcnlWZXJzaW9ufSBiaW5hcnkgVGhpcyB2ZXJzaW9uIG51bWJlciBtaWdodCBub3QgYmVcbiAqIGJlIHByZXNlbnQgZm9yIG9sZGVyIEFEQiByZWxlYXNlcy5cbiAqIEBwcm9wZXJ0eSB7QnJpZGdlVmVyc2lvbn0gYnJpZGdlXG4gKi9cblxuLyoqXG4gKiBHZXQgdGhlIGFkYiB2ZXJzaW9uLiBUaGUgcmVzdWx0IG9mIHRoaXMgbWV0aG9kIGlzIGNhY2hlZC5cbiAqXG4gKiBAcmV0dXJuIHtWZXJzaW9ufVxuICogQHRocm93cyB7RXJyb3J9IElmIGl0IGlzIG5vdCBwb3NzaWJsZSB0byBwYXJzZSBhZGIgYmluYXJ5IHZlcnNpb24uXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmdldFZlcnNpb24gPSBfLm1lbW9pemUoYXN5bmMgZnVuY3Rpb24gZ2V0VmVyc2lvbiAoKSB7XG4gIGxldCBzdGRvdXQ7XG4gIHRyeSB7XG4gICAgc3Rkb3V0ID0gYXdhaXQgdGhpcy5hZGJFeGVjKCd2ZXJzaW9uJyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGdldHRpbmcgYWRiIHZlcnNpb246ICR7ZS5zdGRlcnIgfHwgZS5tZXNzYWdlfWApO1xuICB9XG5cbiAgY29uc3QgcmVzdWx0ID0ge307XG4gIGNvbnN0IGJpbmFyeVZlcnNpb25NYXRjaCA9IEJJTkFSWV9WRVJTSU9OX1BBVFRFUk4uZXhlYyhzdGRvdXQpO1xuICBpZiAoYmluYXJ5VmVyc2lvbk1hdGNoKSB7XG4gICAgcmVzdWx0LmJpbmFyeSA9IHtcbiAgICAgIHZlcnNpb246IHNlbXZlci5jb2VyY2UoYmluYXJ5VmVyc2lvbk1hdGNoWzFdKSxcbiAgICAgIGJ1aWxkOiBwYXJzZUludChiaW5hcnlWZXJzaW9uTWF0Y2hbMl0sIDEwKSxcbiAgICB9O1xuICB9XG4gIGNvbnN0IGJyaWRnZVZlcnNpb25NYXRjaCA9IEJSSURHRV9WRVJTSU9OX1BBVFRFUk4uZXhlYyhzdGRvdXQpO1xuICBpZiAoYnJpZGdlVmVyc2lvbk1hdGNoKSB7XG4gICAgcmVzdWx0LmJyaWRnZSA9IHtcbiAgICAgIHZlcnNpb246IHNlbXZlci5jb2VyY2UoYnJpZGdlVmVyc2lvbk1hdGNoWzFdKSxcbiAgICB9O1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59KTtcblxuLyoqXG4gKiBDaGVjayBpZiB0aGUgY3VycmVudCBlbXVsYXRvciBpcyByZWFkeSB0byBhY2NlcHQgZnVydGhlciBjb21tYW5kcyAoYm9vdGluZyBjb21wbGV0ZWQpLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lb3V0TXMgWzIwMDAwXSAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgZW11bGF0b3IgaXMgbm90IHJlYWR5IHdpdGhpbiB0aGUgZ2l2ZW4gdGltZW91dC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMud2FpdEZvckVtdWxhdG9yUmVhZHkgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yRW11bGF0b3JSZWFkeSAodGltZW91dE1zID0gMjAwMDApIHtcbiAgY29uc3QgcmVxdWlyZWRTZXJ2aWNlc1JlID0gUkVRVUlSRURfU0VSVklDRVMubWFwKChuYW1lKSA9PiBuZXcgUmVnRXhwKGBcXFxcYiR7bmFtZX06YCkpO1xuICBsZXQgc2VydmljZXM7XG4gIHRyeSB7XG4gICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBzZXJ2aWNlcyA9IGF3YWl0IHRoaXMuc2hlbGwoWydzZXJ2aWNlJywgJ2xpc3QnXSk7XG4gICAgICAgIHJldHVybiByZXF1aXJlZFNlcnZpY2VzUmUuZXZlcnkoKHBhdHRlcm4pID0+IHBhdHRlcm4udGVzdChzZXJ2aWNlcykpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgV2FpdGluZyBmb3IgZW11bGF0b3Igc3RhcnR1cC4gSW50ZXJtZWRpYXRlIGVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgd2FpdE1zOiB0aW1lb3V0TXMsXG4gICAgICBpbnRlcnZhbE1zOiAzMDAwLFxuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKHNlcnZpY2VzKSB7XG4gICAgICBsb2cuZGVidWcoYFJlY2VudGx5IGxpc3RlZCBzZXJ2aWNlczpcXG4ke3NlcnZpY2VzfWApO1xuICAgIH1cbiAgICBjb25zdCBtaXNzaW5nU2VydmljZXMgPSBfLnppcChSRVFVSVJFRF9TRVJWSUNFUywgcmVxdWlyZWRTZXJ2aWNlc1JlKVxuICAgICAgLmZpbHRlcigoWywgcGF0dGVybl0pID0+ICFwYXR0ZXJuLnRlc3Qoc2VydmljZXMpKVxuICAgICAgLm1hcCgoW25hbWVdKSA9PiBuYW1lKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVtdWxhdG9yIGlzIG5vdCByZWFkeSB3aXRoaW4gJHt0aW1lb3V0TXN9bXMgYCArXG4gICAgICBgKCR7bWlzc2luZ1NlcnZpY2VzfSBzZXJ2aWNlJHttaXNzaW5nU2VydmljZXMubGVuZ3RoID09PSAxID8gJyBpcycgOiAncyBhcmUnfSBub3QgcnVubmluZylgKTtcbiAgfVxufTtcblxuLyoqXG4gKiBDaGVjayBpZiB0aGUgY3VycmVudCBkZXZpY2UgaXMgcmVhZHkgdG8gYWNjZXB0IGZ1cnRoZXIgY29tbWFuZHMgKGJvb3RpbmcgY29tcGxldGVkKS5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gYXBwRGV2aWNlUmVhZHlUaW1lb3V0IFszMF0gLSBUaGUgbWF4aW11bSBudW1iZXIgb2Ygc2Vjb25kcyB0byB3YWl0LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBkZXZpY2UgaXMgbm90IHJlYWR5IHdpdGhpbiB0aGUgZ2l2ZW4gdGltZW91dC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMud2FpdEZvckRldmljZSA9IGFzeW5jIGZ1bmN0aW9uIHdhaXRGb3JEZXZpY2UgKGFwcERldmljZVJlYWR5VGltZW91dCA9IDMwKSB7XG4gIHRoaXMuYXBwRGV2aWNlUmVhZHlUaW1lb3V0ID0gYXBwRGV2aWNlUmVhZHlUaW1lb3V0O1xuICBjb25zdCByZXRyaWVzID0gMztcbiAgY29uc3QgdGltZW91dCA9IHBhcnNlSW50KHRoaXMuYXBwRGV2aWNlUmVhZHlUaW1lb3V0LCAxMCkgKiAxMDAwIC8gcmV0cmllcztcbiAgYXdhaXQgcmV0cnkocmV0cmllcywgYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmFkYkV4ZWMoJ3dhaXQtZm9yLWRldmljZScsIHt0aW1lb3V0fSk7XG4gICAgICBhd2FpdCB0aGlzLnBpbmcoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLnJlY29ubmVjdCgpO1xuICAgICAgfSBjYXRjaCAoaWduKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVzdGFydEFkYigpO1xuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5nZXRDb25uZWN0ZWREZXZpY2VzKCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIHdhaXRpbmcgZm9yIHRoZSBkZXZpY2UgdG8gYmUgYXZhaWxhYmxlLiBPcmlnaW5hbCBlcnJvcjogJyR7ZS5tZXNzYWdlfSdgKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBSZWJvb3QgdGhlIGN1cnJlbnQgZGV2aWNlIGFuZCB3YWl0IHVudGlsIGl0IGlzIGNvbXBsZXRlZC5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gcmV0cmllcyBbREVGQVVMVF9BREJfUkVCT09UX1JFVFJJRVNdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIHJlYm9vdCByZXRyaWVzLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBkZXZpY2UgZmFpbGVkIHRvIHJlYm9vdCBhbmQgbnVtYmVyIG9mIHJldHJpZXMgaXMgZXhjZWVkZWQuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLnJlYm9vdCA9IGFzeW5jIGZ1bmN0aW9uIHJlYm9vdCAocmV0cmllcyA9IERFRkFVTFRfQURCX1JFQk9PVF9SRVRSSUVTKSB7XG4gIC8vIEdldCByb290IGFjY2VzcyBzbyB3ZSBjYW4gcnVuIHRoZSBuZXh0IHNoZWxsIGNvbW1hbmRzIHdoaWNoIHJlcXVpcmUgcm9vdCBhY2Nlc3NcbiAgY29uc3QgeyB3YXNBbHJlYWR5Um9vdGVkIH0gPSBhd2FpdCB0aGlzLnJvb3QoKTtcbiAgdHJ5IHtcbiAgICAvLyBTdG9wIGFuZCByZS1zdGFydCB0aGUgZGV2aWNlXG4gICAgYXdhaXQgdGhpcy5zaGVsbChbJ3N0b3AnXSk7XG4gICAgYXdhaXQgQi5kZWxheSgyMDAwKTsgLy8gbGV0IHRoZSBlbXUgZmluaXNoIHN0b3BwaW5nO1xuICAgIGF3YWl0IHRoaXMuc2V0RGV2aWNlUHJvcGVydHkoJ3N5cy5ib290X2NvbXBsZXRlZCcsIDAsIHtcbiAgICAgIHByaXZpbGVnZWQ6IGZhbHNlIC8vIG5vIG5lZWQgdG8gc2V0IHByaXZpbGVnZWQgdHJ1ZSBiZWNhdXNlIGRldmljZSBhbHJlYWR5IHJvb3RlZFxuICAgIH0pO1xuICAgIGF3YWl0IHRoaXMuc2hlbGwoWydzdGFydCddKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnN0IHttZXNzYWdlfSA9IGU7XG5cbiAgICAvLyBwcm92aWRlIGEgaGVscGZ1bCBlcnJvciBtZXNzYWdlIGlmIHRoZSByZWFzb24gcmVib290IGZhaWxlZCB3YXMgYmVjYXVzZSBBREIgY291bGRuJ3QgZ2FpbiByb290IGFjY2Vzc1xuICAgIGlmIChtZXNzYWdlLmluY2x1ZGVzKCdtdXN0IGJlIHJvb3QnKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgcmVib290IGRldmljZS4gUmVib290aW5nIHJlcXVpcmVzIHJvb3QgYWNjZXNzIGFuZCBgICtcbiAgICAgICAgYGF0dGVtcHQgdG8gZ2V0IHJvb3QgYWNjZXNzIG9uIGRldmljZSBmYWlsZWQgd2l0aCBlcnJvcjogJyR7bWVzc2FnZX0nYCk7XG4gICAgfVxuICAgIHRocm93IGU7XG4gIH0gZmluYWxseSB7XG4gICAgLy8gUmV0dXJuIHJvb3Qgc3RhdGUgdG8gd2hhdCBpdCB3YXMgYmVmb3JlXG4gICAgaWYgKCF3YXNBbHJlYWR5Um9vdGVkKSB7XG4gICAgICBhd2FpdCB0aGlzLnVucm9vdCgpO1xuICAgIH1cbiAgfVxuICBjb25zdCB0aW1lciA9IG5ldyB0aW1pbmcuVGltZXIoKS5zdGFydCgpO1xuICBhd2FpdCByZXRyeUludGVydmFsKHJldHJpZXMsIDEwMDAsIGFzeW5jICgpID0+IHtcbiAgICBpZiAoKGF3YWl0IHRoaXMuZ2V0RGV2aWNlUHJvcGVydHkoJ3N5cy5ib290X2NvbXBsZXRlZCcpKSA9PT0gJzEnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIHdlIGRvbid0IHdhbnQgdGhlIHN0YWNrIHRyYWNlLCBzbyBubyBsb2cuZXJyb3JBbmRUaHJvd1xuICAgIGNvbnN0IG1zZyA9IGBSZWJvb3QgaXMgbm90IGNvbXBsZXRlZCBhZnRlciAke3RpbWVyLmdldER1cmF0aW9uKCkuYXNNaWxsaVNlY29uZHMudG9GaXhlZCgwKX1tc2A7XG4gICAgbG9nLmRlYnVnKG1zZyk7XG4gICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSByb290UmVzdWx0XG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGlzU3VjY2Vzc2Z1bCBUcnVlIGlmIHRoZSBjYWxsIHRvIHJvb3QvdW5yb290IHdhcyBzdWNjZXNzZnVsXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHdhc0FscmVhZHlSb290ZWQgVHJ1ZSBpZiB0aGUgZGV2aWNlIHdhcyBhbHJlYWR5IHJvb3RlZFxuICovXG5cbi8qKlxuICogU3dpdGNoIGFkYiBzZXJ2ZXIgcm9vdCBwcml2aWxlZ2VzLlxuICogQHBhcmFtIHtib29sZWFufSBpc0VsZXZhdGVkIC0gU2hvdWxkIHdlIGVsZXZhdGUgdG8gdG8gcm9vdCBvciB1bnJvb3Q/IChkZWZhdWx0IHRydWUpXG4gKiBAcmV0dXJuIHtyb290UmVzdWx0fVxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5jaGFuZ2VVc2VyUHJpdmlsZWdlcyA9IGFzeW5jIGZ1bmN0aW9uIGNoYW5nZVVzZXJQcml2aWxlZ2VzIChpc0VsZXZhdGVkKSB7XG4gIGNvbnN0IGNtZCA9IGlzRWxldmF0ZWQgPyAncm9vdCcgOiAndW5yb290JztcblxuICBjb25zdCByZXRyeUlmT2ZmbGluZSA9IGFzeW5jIChjbWRGdW5jKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCBjbWRGdW5jKCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBDaGVjayB0aGUgb3V0cHV0IG9mIHRoZSBzdGRFcnIgdG8gc2VlIGlmIHRoZXJlJ3MgYW55IGNsdWVzIHRoYXQgc2hvdyB0aGF0IHRoZSBkZXZpY2Ugd2VudCBvZmZsaW5lXG4gICAgICAvLyBhbmQgaWYgaXQgZGlkIGdvIG9mZmxpbmUsIHJlc3RhcnQgQURCXG4gICAgICBpZiAoWydjbG9zZWQnLCAnZGV2aWNlIG9mZmxpbmUnLCAndGltZW91dCBleHBpcmVkJ11cbiAgICAgICAgICAuc29tZSgoeCkgPT4gKGVyci5zdGRlcnIgfHwgJycpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoeCkpKSB7XG4gICAgICAgIGxvZy53YXJuKGBBdHRlbXB0IHRvICR7Y21kfSBjYXVzZWQgQURCIHRvIHRoaW5rIHRoZSBkZXZpY2Ugd2VudCBvZmZsaW5lYCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWNvbm5lY3QoKTtcbiAgICAgICAgfSBjYXRjaCAoaWduKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZXN0YXJ0QWRiKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IGNtZEZ1bmMoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy8gSWYgaXQncyBhbHJlYWR5IHJvb3RlZCwgb3VyIGpvYiBpcyBkb25lLiBObyBuZWVkIHRvIHJvb3QgaXQgYWdhaW4uXG4gIGNvbnN0IGlzUm9vdCA9IGF3YWl0IHJldHJ5SWZPZmZsaW5lKGFzeW5jICgpID0+IGF3YWl0IHRoaXMuaXNSb290KCkpO1xuICBpZiAoKGlzUm9vdCAmJiBpc0VsZXZhdGVkKSB8fCAoIWlzUm9vdCAmJiAhaXNFbGV2YXRlZCkpIHtcbiAgICByZXR1cm4ge2lzU3VjY2Vzc2Z1bDogdHJ1ZSwgd2FzQWxyZWFkeVJvb3RlZDogaXNSb290fTtcbiAgfVxuXG4gIGxldCB3YXNBbHJlYWR5Um9vdGVkID0gaXNSb290O1xuICB0cnkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgcmV0cnlJZk9mZmxpbmUoYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5hZGJFeGVjKFtjbWRdKSk7XG4gICAgbG9nLmRlYnVnKHN0ZG91dCk7XG5cbiAgICAvLyBvbiByZWFsIGRldmljZXMgaW4gc29tZSBzaXR1YXRpb25zIHdlIGdldCBhbiBlcnJvciBpbiB0aGUgc3Rkb3V0XG4gICAgaWYgKHN0ZG91dCkge1xuICAgICAgaWYgKHN0ZG91dC5pbmNsdWRlcygnYWRiZCBjYW5ub3QgcnVuIGFzIHJvb3QnKSkge1xuICAgICAgICByZXR1cm4ge2lzU3VjY2Vzc2Z1bDogZmFsc2UsIHdhc0FscmVhZHlSb290ZWR9O1xuICAgICAgfVxuICAgICAgLy8gaWYgdGhlIGRldmljZSB3YXMgYWxyZWFkeSByb290ZWQsIHJldHVybiB0aGF0IGluIHRoZSByZXN1bHRcbiAgICAgIGlmIChzdGRvdXQuaW5jbHVkZXMoJ2FscmVhZHkgcnVubmluZyBhcyByb290JykpIHtcbiAgICAgICAgd2FzQWxyZWFkeVJvb3RlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7aXNTdWNjZXNzZnVsOiB0cnVlLCB3YXNBbHJlYWR5Um9vdGVkfTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc3Qge3N0ZGVyciA9ICcnLCBtZXNzYWdlfSA9IGVycjtcbiAgICBsb2cud2FybihgVW5hYmxlIHRvICR7Y21kfSBhZGIgZGFlbW9uLiBPcmlnaW5hbCBlcnJvcjogJyR7bWVzc2FnZX0nLiBTdGRlcnI6ICcke3N0ZGVycn0nLiBDb250aW51aW5nLmApO1xuICAgIHJldHVybiB7aXNTdWNjZXNzZnVsOiBmYWxzZSwgd2FzQWxyZWFkeVJvb3RlZH07XG4gIH1cbn07XG5cbi8qKlxuICogU3dpdGNoIGFkYiBzZXJ2ZXIgdG8gcm9vdCBtb2RlXG4gKiBAcmV0dXJuIHtyb290UmVzdWx0fVxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5yb290ID0gYXN5bmMgZnVuY3Rpb24gcm9vdCAoKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmNoYW5nZVVzZXJQcml2aWxlZ2VzKHRydWUpO1xufTtcblxuLyoqXG4gKiBTd2l0Y2ggYWRiIHNlcnZlciB0byBub24tcm9vdCBtb2RlLlxuICpcbiAqIEByZXR1cm4ge3Jvb3RSZXN1bHR9XG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLnVucm9vdCA9IGFzeW5jIGZ1bmN0aW9uIHVucm9vdCAoKSB7XG4gIHJldHVybiBhd2FpdCB0aGlzLmNoYW5nZVVzZXJQcml2aWxlZ2VzKGZhbHNlKTtcbn07XG5cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIGN1cnJlbnQgdXNlciBpcyByb290XG4gKlxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgdXNlciBpcyByb290XG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGlkZW50aWZ5aW5nXG4gKiB0aGUgdXNlci5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuaXNSb290ID0gYXN5bmMgZnVuY3Rpb24gaXNSb290ICgpIHtcbiAgcmV0dXJuIChhd2FpdCB0aGlzLnNoZWxsKFsnd2hvYW1pJ10pKS50cmltKCkgPT09ICdyb290Jztcbn07XG5cbi8qKlxuICogVmVyaWZ5IHdoZXRoZXIgYSByZW1vdGUgcGF0aCBleGlzdHMgb24gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSByZW1vdGVQYXRoIC0gVGhlIHJlbW90ZSBwYXRoIHRvIHZlcmlmeS5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIGdpdmVuIHBhdGggZXhpc3RzIG9uIHRoZSBkZXZpY2UuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmZpbGVFeGlzdHMgPSBhc3luYyBmdW5jdGlvbiBmaWxlRXhpc3RzIChyZW1vdGVQYXRoKSB7XG4gIGNvbnN0IHBhc3NGbGFnID0gJ19fUEFTU19fJztcbiAgY29uc3QgY2hlY2tDbWQgPSBgWyAtZSAnJHtyZW1vdGVQYXRoLnJlcGxhY2UoLycvZywgYFxcXFwnYCl9JyBdICYmIGVjaG8gJHtwYXNzRmxhZ31gO1xuICB0cnkge1xuICAgIHJldHVybiBfLmluY2x1ZGVzKGF3YWl0IHRoaXMuc2hlbGwoW2NoZWNrQ21kXSksIHBhc3NGbGFnKTtcbiAgfSBjYXRjaCAoaWduKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG4vKipcbiAqIEdldCB0aGUgb3V0cHV0IG9mIF9sc18gY29tbWFuZCBvbiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHJlbW90ZVBhdGggLSBUaGUgcmVtb3RlIHBhdGggKHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGUgX2xzXyBjb21tYW5kKS5cbiAqIEBwYXJhbSB7QXJyYXkuPFN0cmluZz59IG9wdHMgW1tdXSAtIEFkZGl0aW9uYWwgX2xzXyBvcHRpb25zLlxuICogQHJldHVybiB7QXJyYXkuPFN0cmluZz59IFRoZSBfbHNfIG91dHB1dCBhcyBhbiBhcnJheSBvZiBzcGxpdCBsaW5lcy5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBBbiBlbXB0eSBhcnJheSBpcyByZXR1cm5lZCBvZiB0aGUgZ2l2ZW4gX3JlbW90ZVBhdGhfXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9lcyBub3QgZXhpc3QuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmxzID0gYXN5bmMgZnVuY3Rpb24gbHMgKHJlbW90ZVBhdGgsIG9wdHMgPSBbXSkge1xuICB0cnkge1xuICAgIGxldCBhcmdzID0gWydscycsIC4uLm9wdHMsIHJlbW90ZVBhdGhdO1xuICAgIGxldCBzdGRvdXQgPSBhd2FpdCB0aGlzLnNoZWxsKGFyZ3MpO1xuICAgIGxldCBsaW5lcyA9IHN0ZG91dC5zcGxpdCgnXFxuJyk7XG4gICAgcmV0dXJuIGxpbmVzLm1hcCgobCkgPT4gbC50cmltKCkpXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAuZmlsdGVyKChsKSA9PiBsLmluZGV4T2YoJ05vIHN1Y2ggZmlsZScpID09PSAtMSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChlcnIubWVzc2FnZS5pbmRleE9mKCdObyBzdWNoIGZpbGUgb3IgZGlyZWN0b3J5JykgPT09IC0xKSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIHJldHVybiBbXTtcbiAgfVxufTtcblxuLyoqXG4gKiBHZXQgdGhlIHNpemUgb2YgdGhlIHBhcnRpY3VsYXIgZmlsZSBsb2NhdGVkIG9uIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVtb3RlUGF0aCAtIFRoZSByZW1vdGUgcGF0aCB0byB0aGUgZmlsZS5cbiAqIEByZXR1cm4ge251bWJlcn0gRmlsZSBzaXplIGluIGJ5dGVzLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBnZXR0aW5nIHRoZSBzaXplIG9mIHRoZSBnaXZlbiBmaWxlLlxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5maWxlU2l6ZSA9IGFzeW5jIGZ1bmN0aW9uIGZpbGVTaXplIChyZW1vdGVQYXRoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgZmlsZXMgPSBhd2FpdCB0aGlzLmxzKHJlbW90ZVBhdGgsIFsnLWxhJ10pO1xuICAgIGlmIChmaWxlcy5sZW5ndGggIT09IDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUmVtb3RlIHBhdGggaXMgbm90IGEgZmlsZWApO1xuICAgIH1cbiAgICAvLyBodHRwczovL3JlZ2V4MTAxLmNvbS9yL2ZPczRQNC84XG4gICAgY29uc3QgbWF0Y2ggPSAvW3J3eHNTdFRcXC0rXXsxMH1bXFxzXFxkXSpcXHNbXlxcc10rXFxzK1teXFxzXStcXHMrKFxcZCspLy5leGVjKGZpbGVzWzBdKTtcbiAgICBpZiAoIW1hdGNoIHx8IF8uaXNOYU4ocGFyc2VJbnQobWF0Y2hbMV0sIDEwKSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIHBhcnNlIHNpemUgZnJvbSBsaXN0IG91dHB1dDogJyR7ZmlsZXNbMF19J2ApO1xuICAgIH1cbiAgICByZXR1cm4gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gZ2V0IGZpbGUgc2l6ZSBmb3IgJyR7cmVtb3RlUGF0aH0nOiAke2Vyci5tZXNzYWdlfWApO1xuICB9XG59O1xuXG4vKipcbiAqIEluc3RhbGxzIHRoZSBnaXZlbiBjZXJ0aWZpY2F0ZSBvbiBhIHJvb3RlZCByZWFsIGRldmljZSBvclxuICogYW4gZW11bGF0b3IuIFRoZSBlbXVsYXRvciBtdXN0IGJlIGV4ZWN1dGVkIHdpdGggYC13cml0YWJsZS1zeXN0ZW1gXG4gKiBjb21tYW5kIGxpbmUgb3B0aW9uIGFuZCBhZGIgZGFlbW9uIHNob3VsZCBiZSBydW5uaW5nIGluIHJvb3RcbiAqIG1vZGUgZm9yIHRoaXMgbWV0aG9kIHRvIHdvcmsgcHJvcGVybHkuIFRoZSBtZXRob2QgYWxzbyByZXF1aXJlc1xuICogb3BlbnNzbCB0b29sIHRvIGJlIGF2YWlsYWJsZSBvbiB0aGUgZGVzdGluYXRpb24gc3lzdGVtLlxuICogUmVhZCBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9pc3N1ZXMvMTA5NjRcbiAqIGZvciBtb3JlIGRldGFpbHMgb24gdGhpcyB0b3BpY1xuICpcbiAqIEBwYXJhbSB7QnVmZmVyfHN0cmluZ30gY2VydCAtIGJhc2U2NC1kZWNvZGVkIGNvbnRlbnQgb2YgdGhlIGFjdHVhbCBjZXJ0aWZpY2F0ZVxuICogcmVwcmVzZW50ZWQgYXMgYSBzdHJpbmcgb3IgYSBidWZmZXJcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBvcGVuc3NsIHRvb2wgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgZGVzdGluYXRpb24gc3lzdGVtXG4gKiBvciBpZiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgaW5zdGFsbGluZyB0aGUgY2VydGlmaWNhdGVcbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuaW5zdGFsbE1pdG1DZXJ0aWZpY2F0ZSA9IGFzeW5jIGZ1bmN0aW9uIGluc3RhbGxNaXRtQ2VydGlmaWNhdGUgKGNlcnQpIHtcbiAgY29uc3Qgb3BlblNzbCA9IGF3YWl0IGdldE9wZW5Tc2xGb3JPcygpO1xuXG4gIGlmICghXy5pc0J1ZmZlcihjZXJ0KSkge1xuICAgIGNlcnQgPSBCdWZmZXIuZnJvbShjZXJ0LCAnYmFzZTY0Jyk7XG4gIH1cblxuICBjb25zdCB0bXBSb290ID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3JjQ2VydCA9IHBhdGgucmVzb2x2ZSh0bXBSb290LCAnc291cmNlLmNlcicpO1xuICAgIGF3YWl0IGZzLndyaXRlRmlsZShzcmNDZXJ0LCBjZXJ0KTtcbiAgICBsZXQge3N0ZG91dH0gPSBhd2FpdCBleGVjKG9wZW5Tc2wsIFsneDUwOScsICctbm9vdXQnLCAnLWhhc2gnLCAnLWluJywgc3JjQ2VydF0pO1xuICAgIGNvbnN0IGNlcnRIYXNoID0gc3Rkb3V0LnRyaW0oKTtcbiAgICBsb2cuZGVidWcoYEdvdCBjZXJ0aWZpY2F0ZSBoYXNoOiAke2NlcnRIYXNofWApO1xuICAgIGxvZy5kZWJ1ZygnUHJlcGFyaW5nIGNlcnRpZmljYXRlIGNvbnRlbnQnKTtcbiAgICAoe3N0ZG91dH0gPSBhd2FpdCBleGVjKG9wZW5Tc2wsIFsneDUwOScsICctaW4nLCBzcmNDZXJ0XSwge2lzQnVmZmVyOiB0cnVlfSkpO1xuICAgIGxldCBkc3RDZXJ0Q29udGVudCA9IHN0ZG91dDtcbiAgICAoe3N0ZG91dH0gPSBhd2FpdCBleGVjKG9wZW5Tc2wsIFsneDUwOScsXG4gICAgICAnLWluJywgc3JjQ2VydCxcbiAgICAgICctdGV4dCcsXG4gICAgICAnLWZpbmdlcnByaW50JyxcbiAgICAgICctbm9vdXQnXSwge2lzQnVmZmVyOiB0cnVlfSkpO1xuICAgIGRzdENlcnRDb250ZW50ID0gQnVmZmVyLmNvbmNhdChbZHN0Q2VydENvbnRlbnQsIHN0ZG91dF0pO1xuICAgIGNvbnN0IGRzdENlcnQgPSBwYXRoLnJlc29sdmUodG1wUm9vdCwgYCR7Y2VydEhhc2h9LjBgKTtcbiAgICBhd2FpdCBmcy53cml0ZUZpbGUoZHN0Q2VydCwgZHN0Q2VydENvbnRlbnQpO1xuICAgIGxvZy5kZWJ1ZygnUmVtb3VudGluZyAvc3lzdGVtIGluIHJ3IG1vZGUnKTtcbiAgICAvLyBTb21ldGltZXMgZW11bGF0b3IgcmVib290IGlzIHN0aWxsIG5vdCBmdWxseSBmaW5pc2hlZCBvbiB0aGlzIHN0YWdlLCBzbyByZXRyeVxuICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwoNSwgMjAwMCwgYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5hZGJFeGVjKFsncmVtb3VudCddKSk7XG4gICAgbG9nLmRlYnVnKGBVcGxvYWRpbmcgdGhlIGdlbmVyYXRlZCBjZXJ0aWZpY2F0ZSBmcm9tICcke2RzdENlcnR9JyB0byAnJHtDRVJUU19ST09UfSdgKTtcbiAgICBhd2FpdCB0aGlzLnB1c2goZHN0Q2VydCwgQ0VSVFNfUk9PVCk7XG4gICAgbG9nLmRlYnVnKCdSZW1vdW50aW5nIC9zeXN0ZW0gdG8gY29uZmlybSBjaGFuZ2VzJyk7XG4gICAgYXdhaXQgdGhpcy5hZGJFeGVjKFsncmVtb3VudCddKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgaW5qZWN0IHRoZSBjdXN0b20gY2VydGlmaWNhdGUuIGAgK1xuICAgICAgICAgICAgICAgICAgICBgSXMgdGhlIGNlcnRpZmljYXRlIHByb3Blcmx5IGVuY29kZWQgaW50byBiYXNlNjQtc3RyaW5nPyBgICtcbiAgICAgICAgICAgICAgICAgICAgYERvIHlvdSBoYXZlIHJvb3QgcGVybWlzc2lvbnMgb24gdGhlIGRldmljZT8gYCArXG4gICAgICAgICAgICAgICAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBmcy5yaW1yYWYodG1wUm9vdCk7XG4gIH1cbn07XG5cbi8qKlxuICogVmVyaWZpZXMgaWYgdGhlIGdpdmVuIHJvb3QgY2VydGlmaWNhdGUgaXMgYWxyZWFkeSBpbnN0YWxsZWQgb24gdGhlIGRldmljZS5cbiAqXG4gKiBAcGFyYW0ge0J1ZmZlcnxzdHJpbmd9IGNlcnQgLSBiYXNlNjQtZGVjb2RlZCBjb250ZW50IG9mIHRoZSBhY3R1YWwgY2VydGlmaWNhdGVcbiAqIHJlcHJlc2VudGVkIGFzIGEgc3RyaW5nIG9yIGEgYnVmZmVyXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgb3BlbnNzbCB0b29sIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIGRlc3RpbmF0aW9uIHN5c3RlbVxuICogb3IgaWYgdGhlcmUgd2FzIGFuIGVycm9yIHdoaWxlIGNoZWNraW5nIHRoZSBjZXJ0aWZpY2F0ZVxuICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgdGhlIGdpdmVuIGNlcnRpZmljYXRlIGlzIGFscmVhZHkgaW5zdGFsbGVkXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmlzTWl0bUNlcnRpZmljYXRlSW5zdGFsbGVkID0gYXN5bmMgZnVuY3Rpb24gaXNNaXRtQ2VydGlmaWNhdGVJbnN0YWxsZWQgKGNlcnQpIHtcbiAgY29uc3Qgb3BlblNzbCA9IGF3YWl0IGdldE9wZW5Tc2xGb3JPcygpO1xuXG4gIGlmICghXy5pc0J1ZmZlcihjZXJ0KSkge1xuICAgIGNlcnQgPSBCdWZmZXIuZnJvbShjZXJ0LCAnYmFzZTY0Jyk7XG4gIH1cblxuICBjb25zdCB0bXBSb290ID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gIGxldCBjZXJ0SGFzaDtcbiAgdHJ5IHtcbiAgICBjb25zdCB0bXBDZXJ0ID0gcGF0aC5yZXNvbHZlKHRtcFJvb3QsICdzb3VyY2UuY2VyJyk7XG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKHRtcENlcnQsIGNlcnQpO1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyhvcGVuU3NsLCBbJ3g1MDknLCAnLW5vb3V0JywgJy1oYXNoJywgJy1pbicsIHRtcENlcnRdKTtcbiAgICBjZXJ0SGFzaCA9IHN0ZG91dC50cmltKCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHJldHJpZXZlIHRoZSBjZXJ0aWZpY2F0ZSBoYXNoLiBgICtcbiAgICAgICAgICAgICAgICAgICAgYElzIHRoZSBjZXJ0aWZpY2F0ZSBwcm9wZXJseSBlbmNvZGVkIGludG8gYmFzZTY0LXN0cmluZz8gYCArXG4gICAgICAgICAgICAgICAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBmcy5yaW1yYWYodG1wUm9vdCk7XG4gIH1cbiAgY29uc3QgZHN0UGF0aCA9IHBhdGgucG9zaXgucmVzb2x2ZShDRVJUU19ST09ULCBgJHtjZXJ0SGFzaH0uMGApO1xuICBsb2cuZGVidWcoYENoZWNraW5nIGlmIHRoZSBjZXJ0aWZpY2F0ZSBpcyBhbHJlYWR5IGluc3RhbGxlZCBhdCAnJHtkc3RQYXRofSdgKTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuZmlsZUV4aXN0cyhkc3RQYXRoKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHN5c3RlbUNhbGxNZXRob2RzO1xuZXhwb3J0IHsgREVGQVVMVF9BREJfRVhFQ19USU1FT1VULCBnZXRBbmRyb2lkQmluYXJ5UGF0aCB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFB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