{"version":3,"file":"android-helpers.js","names":["MOCK_APP_IDS_STORE","PACKAGE_INSTALL_TIMEOUT","CHROME_BROWSER_PACKAGE_ACTIVITY","chrome","pkg","activity","chromium","chromebeta","browser","default","SETTINGS_HELPER_PKG_ID","EMULATOR_PATTERN","APP_STATE","Object","freeze","NOT_INSTALLED","NOT_RUNNING","RUNNING_IN_BACKGROUND","RUNNING_IN_FOREGROUND","ensureNetworkSpeed","adb","networkSpeed","_","values","NETWORK_SPEED","includes","logger","warn","FULL","prepareAvdArgs","opts","isHeadless","avdArgs","result","isArray","push","util","shellParse","toCredentialType","unlockType","PIN_UNLOCK","PIN_UNLOCK_KEY_EVENT","PASSWORD_UNLOCK","PATTERN_UNLOCK","Error","helpers","createBaseADB","adbPort","suppressKillServer","remoteAdbHost","clearDeviceLogsOnStart","adbExecTimeout","useKeystore","keystorePath","keystorePassword","keyAlias","keyPassword","remoteAppsCacheLimit","buildToolsVersion","allowOfflineDevices","allowDelayAdb","ADB","createADB","prepareEmulator","avd","avdEnv","env","language","locale","country","avdLaunchTimeout","launchTimeout","avdReadyTimeout","readyTimeout","avdName","replace","isEmulatorRunning","getRunningAVDWithRetry","e","debug","message","args","killEmulator","launchAVD","ensureDeviceLocale","script","isString","setDeviceLanguageCountry","ensureCurrentLocale","getDeviceInfoFromCaps","udid","emPort","curDeviceId","emulatorPort","info","devices","getDevicesWithRetry","map","errorAndThrow","getPortFromEmulatorString","platformVersion","trim","semver","coerce","availDevices","partialMatchCandidate","device","setDeviceId","rawDeviceOS","getPlatformVersion","deviceOS","bothVersionsCanBeCoerced","valid","bothVersionsAreStrings","version","toLower","major","minor","gt","keys","join","setEmulatorPort","validatePackageActivityNames","key","name","match","exec","index","substring","getLaunchInfo","app","appPackage","appActivity","appWaitPackage","appWaitActivity","apkPackage","apkActivity","packageAndLaunchActivityFromManifest","resetApp","fastReset","fullReset","androidInstallTimeout","autoGrantPermissions","allowTestPackages","isInstalled","isAppInstalled","forceStop","ign","output","clear","toLowerCase","grantAllPermissions","error","uninstallApk","install","grantPermissions","timeout","installApk","enforceAppInstall","appState","wasUninstalled","installOrUpgrade","enforceCurrentBuild","isInstalledOverExistingApp","APP_INSTALL_STATE","installOtherApks","otherApps","B","all","otherApp","uninstallOtherPackages","appPackages","filterPackages","getThirdPartyPackages","packagesString","shell","appPackagesArray","split","EOL","difference","err","initUnicodeKeyboard","defaultIME","appiumIME","enableIME","setIME","setMockLocationApp","getApiLevel","pkgIds","fileExists","JSON","parse","tmpRoot","tempDir","openDir","srcPath","path","posix","basename","fs","writeFile","stringify","rimraf","resetMockLocation","thirdPartyPkgIdsPromise","thirdPartyPkgIds","resultPkgs","intersection","size","pkgId","installHelperApp","apkPath","packageId","retry","retryInstallHelperApp","pushSettingsApp","throwError","settingsApkPath","processExists","apiLevel","perms","x","requireRunningSettingsApp","isEmulator","pushStrings","remoteDir","stringsJson","remoteFile","resolve","pullApk","tmpDir","isEmpty","exists","stringsTmpDir","apkStrings","localPath","extractStringsFromApk","unlock","driver","capabilities","isScreenLocked","unlockKey","dismissKeyguard","unlockStrategy","unlockSuccessTimeout","unlocker","validateUnlockCapabilities","FINGERPRINT_UNLOCK","isNil","isLockManagementSupported","fastUnlock","credential","credentialType","unlockMethod","pinUnlock","pinUnlockWithKeyEvent","passwordUnlock","patternUnlock","fingerprintUnlock","verifyUnlock","timeoutMs","waitForCondition","waitMs","intervalMs","initDevice","skipDeviceInitialization","localeScript","unicodeKeyboard","disableWindowAnimation","skipUnlock","mockLocationApp","skipLogcatCapture","logcatFormat","logcatFilterSpecs","waitForDevice","shouldThrowError","isUndefined","startLogcat","format","filterSpecs","removeNullProperties","obj","isNull","truncateDecimals","number","digits","multiplier","Math","pow","adjustedNum","truncatedNum","isChromeBrowser","getChromePkg","removeAllSessionWebSocketHandlers","server","sessionId","isFunction","getWebSocketHandlers","activeHandlers","pathname","removeWebSocketHandler","parseArray","cap","parsedCaps","validateDesiredCaps","caps","browserName","adjustBrowserSessionCaps","possibleNames","some","test","bootstrap","Bootstrap"],"sources":["../../lib/android-helpers.js"],"sourcesContent":["import _ from 'lodash';\nimport path from 'path';\nimport { retry, waitForCondition } from 'asyncbox';\nimport logger from './logger';\nimport { fs, util, tempDir } from '@appium/support';\nimport { path as settingsApkPath } from 'io.appium.settings';\nimport Bootstrap from './bootstrap';\nimport B from 'bluebird';\nimport ADB from 'appium-adb';\nimport {\n  default as unlocker, PIN_UNLOCK, PIN_UNLOCK_KEY_EVENT,\n  PASSWORD_UNLOCK, PATTERN_UNLOCK, FINGERPRINT_UNLOCK\n} from './unlock-helpers';\nimport { EOL } from 'os';\nimport semver from 'semver';\n\nconst MOCK_APP_IDS_STORE = '/data/local/tmp/mock_apps.json';\nconst PACKAGE_INSTALL_TIMEOUT = 90000; // milliseconds\n// https://cs.chromium.org/chromium/src/chrome/browser/devtools/device/android_device_info_query.cc\nconst CHROME_BROWSER_PACKAGE_ACTIVITY = {\n  chrome: {\n    pkg: 'com.android.chrome',\n    activity: 'com.google.android.apps.chrome.Main',\n  },\n  chromium: {\n    pkg: 'org.chromium.chrome.shell',\n    activity: '.ChromeShellActivity',\n  },\n  chromebeta: {\n    pkg: 'com.chrome.beta',\n    activity: 'com.google.android.apps.chrome.Main',\n  },\n  browser: {\n    pkg: 'com.android.browser',\n    activity: 'com.android.browser.BrowserActivity',\n  },\n  'chromium-browser': {\n    pkg: 'org.chromium.chrome',\n    activity: 'com.google.android.apps.chrome.Main',\n  },\n  'chromium-webview': {\n    pkg: 'org.chromium.webview_shell',\n    activity: 'org.chromium.webview_shell.WebViewBrowserActivity',\n  },\n  default: {\n    pkg: 'com.android.chrome',\n    activity: 'com.google.android.apps.chrome.Main',\n  },\n};\nconst SETTINGS_HELPER_PKG_ID = 'io.appium.settings';\nconst EMULATOR_PATTERN = /\\bemulator\\b/i;\n// These constants are in sync with\n// https://developer.apple.com/documentation/xctest/xcuiapplicationstate/xcuiapplicationstaterunningbackground?language=objc\nconst APP_STATE = Object.freeze({\n  NOT_INSTALLED: 0,\n  NOT_RUNNING: 1,\n  RUNNING_IN_BACKGROUND: 3,\n  RUNNING_IN_FOREGROUND: 4\n});\n\n\nfunction ensureNetworkSpeed (adb, networkSpeed) {\n  if (_.values(adb.NETWORK_SPEED).includes(networkSpeed)) {\n    return networkSpeed;\n  }\n  logger.warn(`Wrong network speed param '${networkSpeed}', using default: ${adb.NETWORK_SPEED.FULL}. ` +\n    `Supported values: ${_.values(adb.NETWORK_SPEED)}`);\n  return adb.NETWORK_SPEED.FULL;\n}\n\nfunction prepareAvdArgs (adb, opts) {\n  const {\n    networkSpeed,\n    isHeadless,\n    avdArgs,\n  } = opts;\n  const result = [];\n  if (avdArgs) {\n    if (_.isArray(avdArgs)) {\n      result.push(...avdArgs);\n    } else {\n      result.push(...(util.shellParse(`${avdArgs}`)));\n    }\n  }\n  if (networkSpeed) {\n    result.push('-netspeed', ensureNetworkSpeed(adb, networkSpeed));\n  }\n  if (isHeadless) {\n    result.push('-no-window');\n  }\n  return result;\n}\n\nfunction toCredentialType (unlockType) {\n  const result = {\n    [PIN_UNLOCK]: 'pin',\n    [PIN_UNLOCK_KEY_EVENT]: 'pin',\n    [PASSWORD_UNLOCK]: 'password',\n    [PATTERN_UNLOCK]: 'pattern',\n  }[unlockType];\n  if (result) {\n    return result;\n  }\n  throw new Error(`Unlock type '${unlockType}' is not known`);\n}\n\n\nconst helpers = {};\n\nhelpers.createBaseADB = async function createBaseADB (opts = {}) {\n  // filter out any unwanted options sent in\n  // this list should be updated as ADB takes more arguments\n  const {\n    adbPort,\n    suppressKillServer,\n    remoteAdbHost,\n    clearDeviceLogsOnStart,\n    adbExecTimeout,\n    useKeystore,\n    keystorePath,\n    keystorePassword,\n    keyAlias,\n    keyPassword,\n    remoteAppsCacheLimit,\n    buildToolsVersion,\n    allowOfflineDevices,\n    allowDelayAdb,\n  } = opts;\n  return await ADB.createADB({\n    adbPort,\n    suppressKillServer,\n    remoteAdbHost,\n    clearDeviceLogsOnStart,\n    adbExecTimeout,\n    useKeystore,\n    keystorePath,\n    keystorePassword,\n    keyAlias,\n    keyPassword,\n    remoteAppsCacheLimit,\n    buildToolsVersion,\n    allowOfflineDevices,\n    allowDelayAdb,\n  });\n};\n\nhelpers.prepareEmulator = async function prepareEmulator (adb, opts) {\n  const {\n    avd,\n    avdEnv: env,\n    language,\n    locale: country,\n    avdLaunchTimeout: launchTimeout,\n    avdReadyTimeout: readyTimeout,\n  } = opts;\n  if (!avd) {\n    throw new Error('Cannot launch AVD without AVD name');\n  }\n\n  const avdName = avd.replace('@', '');\n  let isEmulatorRunning = true;\n  try {\n    await adb.getRunningAVDWithRetry(avdName, 5000);\n  } catch (e) {\n    logger.debug(`Emulator '${avdName}' is not running: ${e.message}`);\n    isEmulatorRunning = false;\n  }\n  const args = prepareAvdArgs(adb, opts);\n  if (isEmulatorRunning) {\n    if (args.includes('-wipe-data')) {\n      logger.debug(`Killing '${avdName}' because it needs to be wiped at start.`);\n      await adb.killEmulator(avdName);\n    } else {\n      logger.debug('Not launching AVD because it is already running.');\n      return;\n    }\n  }\n  await adb.launchAVD(avd, {\n    args,\n    env,\n    language,\n    country,\n    launchTimeout,\n    readyTimeout,\n  });\n};\n\n/**\n * Set and ensure the locale name of the device under test.\n *\n * @param {Object} adb - The adb module instance.\n * @param {string} language - Language. The language field is case insensitive, but Locale always canonicalizes to lower case.\n *                            format: [a-zA-Z]{2,8}. e.g. en, ja : https://developer.android.com/reference/java/util/Locale.html\n * @param {string} country - Country. The country (region) field is case insensitive, but Locale always canonicalizes to upper case.\n *                            format: [a-zA-Z]{2} | [0-9]{3}. e.g. US, JP : https://developer.android.com/reference/java/util/Locale.html\n * @param {?string} script - Script. The script field is case insensitive but Locale always canonicalizes to title case.\n *                            format: [a-zA-Z]{4}. e.g. Hans in zh-Hans-CN : https://developer.android.com/reference/java/util/Locale.html\n * @throws {Error} If it failed to set locale properly\n */\nhelpers.ensureDeviceLocale = async function ensureDeviceLocale (adb, language, country, script = null) {\n  if (!_.isString(language) && !_.isString(country)) {\n    logger.warn(`setDeviceLanguageCountry requires language or country.`);\n    logger.warn(`Got language: '${language}' and country: '${country}'`);\n    return;\n  }\n\n  await adb.setDeviceLanguageCountry(language, country, script);\n\n  if (!await adb.ensureCurrentLocale(language, country, script)) {\n    const message = script ? `language: ${language}, country: ${country} and script: ${script}` : `language: ${language} and country: ${country}`;\n    throw new Error(`Failed to set ${message}`);\n  }\n};\n\nhelpers.getDeviceInfoFromCaps = async function getDeviceInfoFromCaps (opts = {}) {\n  // we can create a throwaway ADB instance here, so there is no dependency\n  // on instantiating on earlier (at this point, we have no udid)\n  // we can only use this ADB object for commands that would not be confused\n  // if multiple devices are connected\n  const adb = await helpers.createBaseADB(opts);\n  let udid = opts.udid;\n  let emPort = null;\n\n  // a specific avd name was given. try to initialize with that\n  if (opts.avd) {\n    await helpers.prepareEmulator(adb, opts);\n    udid = adb.curDeviceId;\n    emPort = adb.emulatorPort;\n  } else {\n    // no avd given. lets try whatever's plugged in devices/emulators\n    logger.info('Retrieving device list');\n    let devices = await adb.getDevicesWithRetry();\n\n    // udid was given, lets try to init with that device\n    if (udid) {\n      if (!_.includes(_.map(devices, 'udid'), udid)) {\n        logger.errorAndThrow(`Device ${udid} was not in the list of connected devices`);\n      }\n      emPort = adb.getPortFromEmulatorString(udid);\n    } else if (opts.platformVersion) {\n      opts.platformVersion = `${opts.platformVersion}`.trim();\n\n      // a platform version was given. lets try to find a device with the same os\n      const platformVersion = semver.coerce(opts.platformVersion) || opts.platformVersion;\n      logger.info(`Looking for a device with Android '${platformVersion}'`);\n\n      // in case we fail to find something, give the user a useful log that has\n      // the device udids and os versions so they know what's available\n      const availDevices = [];\n      let partialMatchCandidate = null;\n      // first try started devices/emulators\n      for (const device of devices) {\n        // direct adb calls to the specific device\n        await adb.setDeviceId(device.udid);\n        const rawDeviceOS = await adb.getPlatformVersion();\n        // The device OS could either be a number, like `6.0`\n        // or an abbreviation, like `R`\n        availDevices.push(`${device.udid} (${rawDeviceOS})`);\n        const deviceOS = semver.coerce(rawDeviceOS) || rawDeviceOS;\n        if (!deviceOS) {\n          continue;\n        }\n\n        const bothVersionsCanBeCoerced = semver.valid(deviceOS) && semver.valid(platformVersion);\n        const bothVersionsAreStrings = _.isString(deviceOS) && _.isString(platformVersion);\n        if (bothVersionsCanBeCoerced && deviceOS.version === platformVersion.version\n            || bothVersionsAreStrings && _.toLower(deviceOS) === _.toLower(platformVersion)) {\n          // Got an exact match - proceed immediately\n          udid = device.udid;\n          break;\n        } else if (!bothVersionsCanBeCoerced) {\n          // There is no point to check for partial match if either of version numbers is not coercible\n          continue;\n        }\n\n        if ((!_.includes(opts.platformVersion, '.') && platformVersion.major === deviceOS.major\n            || platformVersion.major === deviceOS.major && platformVersion.minor === deviceOS.minor)\n            // Got a partial match - make sure we consider the most recent\n            // device version available on the host system\n            && (partialMatchCandidate && semver.gt(deviceOS, _.values(partialMatchCandidate)[0])\n                || !partialMatchCandidate)) {\n          partialMatchCandidate = {[device.udid]: deviceOS};\n        }\n      }\n      if (!udid && partialMatchCandidate) {\n        udid = _.keys(partialMatchCandidate)[0];\n        await adb.setDeviceId(udid);\n      }\n\n      if (!udid) {\n        // we couldn't find anything! quit\n        logger.errorAndThrow(`Unable to find an active device or emulator ` +\n          `with OS ${opts.platformVersion}. The following are available: ` +\n          availDevices.join(', '));\n      }\n\n      emPort = adb.getPortFromEmulatorString(udid);\n    } else {\n      // a udid was not given, grab the first device we see\n      udid = devices[0].udid;\n      emPort = adb.getPortFromEmulatorString(udid);\n    }\n  }\n\n  logger.info(`Using device: ${udid}`);\n  return {udid, emPort};\n};\n\n// returns a new adb instance with deviceId set\nhelpers.createADB = async function createADB (opts = {}) {\n  const {udid, emPort} = opts;\n  const adb = await helpers.createBaseADB(opts);\n  adb.setDeviceId(udid);\n  if (emPort) {\n    adb.setEmulatorPort(emPort);\n  }\n\n  return adb;\n};\n\nhelpers.validatePackageActivityNames = function validatePackageActivityNames (opts) {\n  for (const key of ['appPackage', 'appActivity', 'appWaitPackage', 'appWaitActivity']) {\n    const name = opts[key];\n    if (!name) {\n      continue;\n    }\n\n    const match = /([^\\w.*,])+/.exec(name);\n    if (!match) {\n      continue;\n    }\n\n    logger.warn(`Capability '${key}' is expected to only include latin letters, digits, underscore, dot, comma and asterisk characters.`);\n    logger.warn(`Current value '${name}' has non-matching character at index ${match.index}: '${name.substring(0, match.index + 1)}'`);\n  }\n};\n\nhelpers.getLaunchInfo = async function getLaunchInfo (adb, opts) {\n  let {app, appPackage, appActivity, appWaitPackage, appWaitActivity} = opts;\n  if (!app) {\n    logger.warn('No app sent in, not parsing package/activity');\n    return;\n  }\n\n  this.validatePackageActivityNames(opts);\n\n  if (appPackage && appActivity) {\n    return;\n  }\n\n  logger.debug('Parsing package and activity from app manifest');\n  let {apkPackage, apkActivity} =\n    await adb.packageAndLaunchActivityFromManifest(app);\n  if (apkPackage && !appPackage) {\n    appPackage = apkPackage;\n  }\n  if (!appWaitPackage) {\n    appWaitPackage = appPackage;\n  }\n  if (apkActivity && !appActivity) {\n    appActivity = apkActivity;\n  }\n  if (!appWaitActivity) {\n    appWaitActivity = appActivity;\n  }\n  logger.debug(`Parsed package and activity are: ${apkPackage}/${apkActivity}`);\n  return {appPackage, appWaitPackage, appActivity, appWaitActivity};\n};\n\nhelpers.resetApp = async function resetApp (adb, opts = {}) {\n  const {\n    app,\n    appPackage,\n    fastReset,\n    fullReset,\n    androidInstallTimeout = PACKAGE_INSTALL_TIMEOUT,\n    autoGrantPermissions,\n    allowTestPackages\n  } = opts;\n\n  if (!appPackage) {\n    throw new Error(\"'appPackage' option is required\");\n  }\n\n  const isInstalled = await adb.isAppInstalled(appPackage);\n\n  if (isInstalled) {\n    try {\n      await adb.forceStop(appPackage);\n    } catch (ign) {}\n    // fullReset has priority over fastReset\n    if (!fullReset && fastReset) {\n      const output = await adb.clear(appPackage);\n      if (_.isString(output) && output.toLowerCase().includes('failed')) {\n        throw new Error(`Cannot clear the application data of '${appPackage}'. Original error: ${output}`);\n      }\n      // executing `shell pm clear` resets previously assigned application permissions as well\n      if (autoGrantPermissions) {\n        try {\n          await adb.grantAllPermissions(appPackage);\n        } catch (error) {\n          logger.error(`Unable to grant permissions requested. Original error: ${error.message}`);\n        }\n      }\n      logger.debug(`Performed fast reset on the installed '${appPackage}' application (stop and clear)`);\n      return;\n    }\n  }\n\n  if (!app) {\n    throw new Error(`Either provide 'app' option to install '${appPackage}' or ` +\n      `consider setting 'noReset' to 'true' if '${appPackage}' is supposed to be preinstalled.`);\n  }\n\n  logger.debug(`Running full reset on '${appPackage}' (reinstall)`);\n  if (isInstalled) {\n    await adb.uninstallApk(appPackage);\n  }\n  await adb.install(app, {\n    grantPermissions: autoGrantPermissions,\n    timeout: androidInstallTimeout,\n    allowTestPackages,\n  });\n};\n\nhelpers.installApk = async function installApk (adb, opts = {}) {\n  const {\n    app,\n    appPackage,\n    fastReset,\n    fullReset,\n    androidInstallTimeout = PACKAGE_INSTALL_TIMEOUT,\n    autoGrantPermissions,\n    allowTestPackages,\n    enforceAppInstall,\n  } = opts;\n\n  if (!app || !appPackage) {\n    throw new Error(\"'app' and 'appPackage' options are required\");\n  }\n\n  if (fullReset) {\n    await this.resetApp(adb, opts);\n    return;\n  }\n\n  const {\n    appState,\n    wasUninstalled\n  } = await adb.installOrUpgrade(app, appPackage, {\n    grantPermissions: autoGrantPermissions,\n    timeout: androidInstallTimeout,\n    allowTestPackages,\n    enforceCurrentBuild: enforceAppInstall,\n  });\n\n  // There is no need to reset the newly installed app\n  const isInstalledOverExistingApp = !wasUninstalled\n    && appState !== adb.APP_INSTALL_STATE.NOT_INSTALLED;\n  if (fastReset && isInstalledOverExistingApp) {\n    logger.info(`Performing fast reset on '${appPackage}'`);\n    await this.resetApp(adb, opts);\n  }\n};\n\n/**\n * Installs an array of apks\n * @param {ADB} adb Instance of Appium ADB object\n * @param {Object} opts Opts defined in driver.js\n */\nhelpers.installOtherApks = async function installOtherApks (otherApps, adb, opts) {\n  let {\n    androidInstallTimeout = PACKAGE_INSTALL_TIMEOUT,\n    autoGrantPermissions,\n    allowTestPackages\n  } = opts;\n\n  // Install all of the APK's asynchronously\n  await B.all(otherApps.map((otherApp) => {\n    logger.debug(`Installing app: ${otherApp}`);\n    return adb.installOrUpgrade(otherApp, null, {\n      grantPermissions: autoGrantPermissions,\n      timeout: androidInstallTimeout,\n      allowTestPackages,\n    });\n  }));\n};\n\n/**\n * Uninstall an array of packages\n * @param {ADB} adb Instance of Appium ADB object\n * @param {Array<string>} appPackages An array of package names to uninstall. If this includes `'*'`, uninstall all of 3rd party apps\n * @param {Array<string>} filterPackages An array of packages does not uninstall when `*` is provided as `appPackages`\n */\nhelpers.uninstallOtherPackages = async function uninstallOtherPackages (adb, appPackages, filterPackages = []) {\n  if (appPackages.includes('*')) {\n    logger.debug('Uninstall third party packages');\n    appPackages = await this.getThirdPartyPackages(adb, filterPackages);\n  }\n\n  logger.debug(`Uninstalling packages: ${appPackages}`);\n  await B.all(appPackages.map((appPackage) => adb.uninstallApk(appPackage)));\n};\n\n/**\n * Get third party packages filtered with `filterPackages`\n * @param {ADB} adb Instance of Appium ADB object\n * @param {Array<string>} filterPackages An array of packages does not uninstall when `*` is provided as `appPackages`\n * @returns {Array<string>} An array of installed third pary packages\n */\nhelpers.getThirdPartyPackages = async function getThirdPartyPackages (adb, filterPackages = []) {\n  try {\n    const packagesString = await adb.shell(['pm', 'list', 'packages', '-3']);\n    const appPackagesArray = packagesString.trim().replace(/package:/g, '').split(EOL);\n    logger.debug(`'${appPackagesArray}' filtered with '${filterPackages}'`);\n    return _.difference(appPackagesArray, filterPackages);\n  } catch (err) {\n    logger.warn(`Unable to get packages with 'adb shell pm list packages -3': ${err.message}`);\n    return [];\n  }\n};\n\nhelpers.initUnicodeKeyboard = async function initUnicodeKeyboard (adb) {\n  logger.debug('Enabling Unicode keyboard support');\n\n  // get the default IME so we can return back to it later if we want\n  let defaultIME = await adb.defaultIME();\n\n  logger.debug(`Unsetting previous IME ${defaultIME}`);\n  const appiumIME = `${SETTINGS_HELPER_PKG_ID}/.UnicodeIME`;\n  logger.debug(`Setting IME to '${appiumIME}'`);\n  await adb.enableIME(appiumIME);\n  await adb.setIME(appiumIME);\n  return defaultIME;\n};\n\nhelpers.setMockLocationApp = async function setMockLocationApp (adb, app) {\n  try {\n    if (await adb.getApiLevel() < 23) {\n      await adb.shell(['settings', 'put', 'secure', 'mock_location', '1']);\n    } else {\n      await adb.shell(['appops', 'set', app, 'android:mock_location', 'allow']);\n    }\n  } catch (err) {\n    logger.warn(`Unable to set mock location for app '${app}': ${err.message}`);\n    return;\n  }\n  try {\n    let pkgIds = [];\n    if (await adb.fileExists(MOCK_APP_IDS_STORE)) {\n      try {\n        pkgIds = JSON.parse(await adb.shell(['cat', MOCK_APP_IDS_STORE]));\n      } catch (ign) {}\n    }\n    if (pkgIds.includes(app)) {\n      return;\n    }\n    pkgIds.push(app);\n    const tmpRoot = await tempDir.openDir();\n    const srcPath = path.posix.join(tmpRoot, path.posix.basename(MOCK_APP_IDS_STORE));\n    try {\n      await fs.writeFile(srcPath, JSON.stringify(pkgIds), 'utf8');\n      await adb.push(srcPath, MOCK_APP_IDS_STORE);\n    } finally {\n      await fs.rimraf(tmpRoot);\n    }\n  } catch (e) {\n    logger.warn(`Unable to persist mock location app id '${app}': ${e.message}`);\n  }\n};\n\nhelpers.resetMockLocation = async function resetMockLocation (adb) {\n  try {\n    if (await adb.getApiLevel() < 23) {\n      await adb.shell(['settings', 'put', 'secure', 'mock_location', '0']);\n      return;\n    }\n\n    const thirdPartyPkgIdsPromise = helpers.getThirdPartyPackages(adb);\n    let pkgIds = [];\n    if (await adb.fileExists(MOCK_APP_IDS_STORE)) {\n      try {\n        pkgIds = JSON.parse(await adb.shell(['cat', MOCK_APP_IDS_STORE]));\n      } catch (ign) {}\n    }\n    const thirdPartyPkgIds = await thirdPartyPkgIdsPromise;\n    // Only include currently installed packages\n    const resultPkgs = _.intersection(pkgIds, thirdPartyPkgIds);\n    if (_.size(resultPkgs) <= 1) {\n      await adb.shell(['appops', 'set', resultPkgs[0] ?? SETTINGS_HELPER_PKG_ID, 'android:mock_location', 'deny']);\n      return;\n    }\n\n    logger.debug(`Resetting mock_location permission for the following apps: ${resultPkgs}`);\n    await B.all(resultPkgs.map((pkgId) => (async () => {\n      try {\n        await adb.shell(['appops', 'set', pkgId, 'android:mock_location', 'deny']);\n      } catch (ign) {}\n    })()));\n  } catch (err) {\n    logger.warn(`Unable to reset mock location: ${err.message}`);\n  }\n};\n\nhelpers.installHelperApp = async function installHelperApp (adb, apkPath, packageId) {\n  // Sometimes adb push or adb instal take more time than expected to install an app\n  // e.g. https://github.com/appium/io.appium.settings/issues/40#issuecomment-476593174\n  await retry(2, async function retryInstallHelperApp () {\n    await adb.installOrUpgrade(apkPath, packageId, {grantPermissions: true});\n  });\n};\n\n/**\n * Pushes and installs io.appium.settings app.\n * Throws an error if the setting app is required\n *\n * @param {Adb} adb - The adb module instance.\n * @param {Object} opts - Driver options dictionary.\n * @param {boolean} throwError [false] - Whether throw an error if Settings app fails to start\n * @throws {Error} If throwError is true and something happens in installation step\n */\nhelpers.pushSettingsApp = async function pushSettingsApp (adb, throwError = false, opts = {}) {\n  logger.debug('Pushing settings apk to device...');\n\n  try {\n    await helpers.installHelperApp(adb, settingsApkPath, SETTINGS_HELPER_PKG_ID, throwError);\n  } catch (err) {\n    if (throwError) {\n      throw err;\n    }\n\n    logger.warn(`Ignored error while installing '${settingsApkPath}': ` +\n                `'${err.message}'. Features that rely on this helper ` +\n                'require the apk such as toggle WiFi and getting location ' +\n                'will raise an error if you try to use them.');\n  }\n\n  // Reinstall would stop the settings helper process anyway, so\n  // there is no need to continue if the application is still running\n  if (await adb.processExists(SETTINGS_HELPER_PKG_ID)) {\n    logger.debug(`${SETTINGS_HELPER_PKG_ID} is already running. ` +\n      `There is no need to reset its permissions.`);\n    return;\n  }\n\n  const apiLevel = await adb.getApiLevel();\n  if (apiLevel >= 29) {\n    // https://github.com/appium/io.appium.settings#internal-audio--video-recording\n    try {\n      await adb.shell(['appops', 'set', SETTINGS_HELPER_PKG_ID, 'PROJECT_MEDIA', 'allow']);\n    } catch (err) {\n      logger.debug(err);\n    }\n  }\n  if (apiLevel <= 23) { // Android 6- devices should have granted permissions\n    // https://github.com/appium/appium/pull/11640#issuecomment-438260477\n    const perms = ['SET_ANIMATION_SCALE', 'CHANGE_CONFIGURATION', 'ACCESS_FINE_LOCATION'];\n    logger.info(`Granting permissions ${perms} to '${SETTINGS_HELPER_PKG_ID}'`);\n    await adb.grantPermissions(SETTINGS_HELPER_PKG_ID, perms.map((x) => `android.permission.${x}`));\n  }\n\n  // launch io.appium.settings app due to settings failing to be set\n  // if the app is not launched prior to start the session on android 7+\n  // see https://github.com/appium/appium/issues/8957\n  try {\n    await adb.requireRunningSettingsApp({\n      timeout: helpers.isEmulator(adb, opts) ? 30000 : 5000\n    });\n  } catch (err) {\n    logger.debug(err);\n    if (throwError) {\n      throw err;\n    }\n  }\n};\n\n/**\n * Extracts string.xml and converts it to string.json and pushes\n * it to /data/local/tmp/string.json on for use of bootstrap\n * If app is not present to extract string.xml it deletes remote strings.json\n * If app does not have strings.xml we push an empty json object to remote\n *\n * @param {?string} language - Language abbreviation, for example 'fr'. The default language\n * is used if this argument is not defined.\n * @param {Object} adb - The adb module instance.\n * @param {Object} opts - Driver options dictionary.\n * @returns {Object} The dictionary, where string resource identifiers are keys\n * along with their corresponding values for the given language or an empty object\n * if no matching resources were extracted.\n */\nhelpers.pushStrings = async function pushStrings (language, adb, opts) {\n  const remoteDir = '/data/local/tmp';\n  const stringsJson = 'strings.json';\n  const remoteFile = path.posix.resolve(remoteDir, stringsJson);\n\n  // clean up remote string.json if present\n  await adb.rimraf(remoteFile);\n\n  let app;\n  try {\n    app = opts.app || await adb.pullApk(opts.appPackage, opts.tmpDir);\n  } catch (err) {\n    logger.info(`Failed to pull an apk from '${opts.appPackage}' to '${opts.tmpDir}'. Original error: ${err.message}`);\n  }\n\n  if (_.isEmpty(opts.appPackage) || !(await fs.exists(app))) {\n    logger.debug(`No app or package specified. Returning empty strings`);\n    return {};\n  }\n\n  const stringsTmpDir = path.resolve(opts.tmpDir, opts.appPackage);\n  try {\n    logger.debug('Extracting strings from apk', app, language, stringsTmpDir);\n    const {apkStrings, localPath} = await adb.extractStringsFromApk(app, language, stringsTmpDir);\n    await adb.push(localPath, remoteDir);\n    return apkStrings;\n  } catch (err) {\n    logger.warn(`Could not get strings, continuing anyway. Original error: ${err.message}`);\n    await adb.shell('echo', [`'{}' > ${remoteFile}`]);\n  } finally {\n    await fs.rimraf(stringsTmpDir);\n  }\n  return {};\n};\n\nhelpers.unlock = async function unlock (driver, adb, capabilities) {\n  if (!(await adb.isScreenLocked())) {\n    logger.info('Screen already unlocked, doing nothing');\n    return;\n  }\n\n  logger.debug('Screen is locked, trying to unlock');\n  if (!capabilities.unlockType && !capabilities.unlockKey) {\n    logger.info(`Neither 'unlockType' nor 'unlockKey' capability is provided. ` +\n      `Assuming the device is locked with a simple lock screen.`);\n    await adb.dismissKeyguard();\n    return;\n  }\n\n  const {\n    unlockType,\n    unlockKey,\n    unlockStrategy,\n    unlockSuccessTimeout,\n  } = unlocker.validateUnlockCapabilities(capabilities);\n  if (unlockKey && unlockType !== FINGERPRINT_UNLOCK\n      && (_.isNil(unlockStrategy) || _.toLower(unlockStrategy) === 'locksettings')\n      && await adb.isLockManagementSupported()) {\n    await unlocker.fastUnlock(adb, {\n      credential: unlockKey,\n      credentialType: toCredentialType(unlockType),\n    });\n  } else {\n    const unlockMethod = {\n      [PIN_UNLOCK]: unlocker.pinUnlock,\n      [PIN_UNLOCK_KEY_EVENT]: unlocker.pinUnlockWithKeyEvent,\n      [PASSWORD_UNLOCK]: unlocker.passwordUnlock,\n      [PATTERN_UNLOCK]: unlocker.patternUnlock,\n      [FINGERPRINT_UNLOCK]: unlocker.fingerprintUnlock,\n    }[unlockType];\n    await unlockMethod(adb, driver, capabilities);\n  }\n  await helpers.verifyUnlock(adb, unlockSuccessTimeout);\n};\n\nhelpers.verifyUnlock = async function verifyUnlock (adb, timeoutMs = null) {\n  try {\n    await waitForCondition(async () => !(await adb.isScreenLocked()), {\n      waitMs: timeoutMs ?? 2000,\n      intervalMs: 500,\n    });\n  } catch (ign) {\n    throw new Error('The device has failed to be unlocked');\n  }\n  logger.info('The device has been successfully unlocked');\n};\n\nhelpers.initDevice = async function initDevice (adb, opts) {\n  const {\n    skipDeviceInitialization,\n    locale,\n    language,\n    localeScript,\n    unicodeKeyboard,\n    disableWindowAnimation,\n    skipUnlock,\n    mockLocationApp,\n    skipLogcatCapture,\n    logcatFormat,\n    logcatFilterSpecs,\n  } = opts;\n\n  if (skipDeviceInitialization) {\n    logger.info(`'skipDeviceInitialization' is set. Skipping device initialization.`);\n  } else {\n    await adb.waitForDevice();\n    // pushSettingsApp required before calling ensureDeviceLocale for API Level 24+\n\n    // Some feature such as location/wifi are not necessary for all users,\n    // but they require the settings app. So, try to configure it while Appium\n    // does not throw error even if they fail.\n    const shouldThrowError = language\n      || locale\n      || localeScript\n      || unicodeKeyboard\n      || disableWindowAnimation\n      || !skipUnlock;\n    await helpers.pushSettingsApp(adb, shouldThrowError, opts);\n  }\n\n  if (!helpers.isEmulator(adb, opts)) {\n    if (mockLocationApp || _.isUndefined(mockLocationApp)) {\n      await helpers.setMockLocationApp(adb, mockLocationApp || SETTINGS_HELPER_PKG_ID);\n    } else {\n      await helpers.resetMockLocation(adb);\n    }\n  }\n\n  if (language || locale) {\n    await helpers.ensureDeviceLocale(adb, language, locale, localeScript);\n  }\n\n  if (skipLogcatCapture) {\n    logger.info(`'skipLogcatCapture' is set. Skipping starting logcat capture.`);\n  } else {\n    await adb.startLogcat({\n      format: logcatFormat,\n      filterSpecs: logcatFilterSpecs,\n    });\n  }\n\n  if (unicodeKeyboard) {\n    return await helpers.initUnicodeKeyboard(adb);\n  }\n};\n\nhelpers.removeNullProperties = function removeNullProperties (obj) {\n  for (let key of _.keys(obj)) {\n    if (_.isNull(obj[key]) || _.isUndefined(obj[key])) {\n      delete obj[key];\n    }\n  }\n};\n\nhelpers.truncateDecimals = function truncateDecimals (number, digits) {\n  let multiplier = Math.pow(10, digits),\n      adjustedNum = number * multiplier,\n      truncatedNum = Math[adjustedNum < 0 ? 'ceil' : 'floor'](adjustedNum);\n\n  return truncatedNum / multiplier;\n};\n\nhelpers.isChromeBrowser = function isChromeBrowser (browser) {\n  return _.includes(Object.keys(CHROME_BROWSER_PACKAGE_ACTIVITY), (browser || '').toLowerCase());\n};\n\nhelpers.getChromePkg = function getChromePkg (browser) {\n  return CHROME_BROWSER_PACKAGE_ACTIVITY[browser.toLowerCase()] || CHROME_BROWSER_PACKAGE_ACTIVITY.default;\n};\n\nhelpers.removeAllSessionWebSocketHandlers = async function removeAllSessionWebSocketHandlers (server, sessionId) {\n  if (!server || !_.isFunction(server.getWebSocketHandlers)) {\n    return;\n  }\n\n  const activeHandlers = await server.getWebSocketHandlers(sessionId);\n  for (const pathname of _.keys(activeHandlers)) {\n    await server.removeWebSocketHandler(pathname);\n  }\n};\n\n/**\n * Takes a desired capability and tries to JSON.parse it as an array,\n * and either returns the parsed array or a singleton array.\n *\n * @param {any} cap A desired capability\n */\nhelpers.parseArray = function parseArray (cap) {\n  let parsedCaps;\n  try {\n    parsedCaps = JSON.parse(cap);\n  } catch (ign) { }\n\n  if (_.isArray(parsedCaps)) {\n    return parsedCaps;\n  } else if (_.isString(cap)) {\n    return [cap];\n  }\n\n  throw new Error(`must provide a string or JSON Array; received ${cap}`);\n};\n\n/**\n * Validate desired capabilities. Returns true if capability is valid\n *\n * @param {*} cap A desired capability\n * @return {boolean} Returns true if the capability is valid\n * @throws {Error} If the caps has invalid capability\n */\nhelpers.validateDesiredCaps = function validateDesiredCaps (caps) {\n  if (caps.browserName) {\n    if (caps.app) {\n      // warn if the capabilities have both `app` and `browser, although this is common with selenium grid\n      logger.warn(`The desired capabilities should generally not include both an 'app' and a 'browserName'`);\n    }\n    if (caps.appPackage) {\n      logger.errorAndThrow(`The desired should not include both of an 'appPackage' and a 'browserName'`);\n    }\n  }\n\n  if (caps.uninstallOtherPackages) {\n    try {\n      this.parseArray(caps.uninstallOtherPackages);\n    } catch (e) {\n      logger.errorAndThrow(`Could not parse \"uninstallOtherPackages\" capability: ${e.message}`);\n    }\n  }\n\n  return true;\n};\n\n/**\n * Adjust the capabilities for a browser session\n *\n * @param {Object} caps - Current capabilities object\n * !!! The object is mutated by this method call !!!\n * @returns {Object} The same possibly mutated `opts` instance.\n * No mutation is happening is the current session if\n * appPackage/appActivity caps have already been provided.\n */\nhelpers.adjustBrowserSessionCaps = function adjustBrowserSessionCaps (caps = {}) {\n  const { browserName } = caps;\n  logger.info(`The current session is considered browser-based`);\n  logger.info(`Supported browser names: ${JSON.stringify(_.keys(CHROME_BROWSER_PACKAGE_ACTIVITY))}`);\n  if (caps.appPackage || caps.appActivity) {\n    logger.info(`Not overriding appPackage/appActivity capability values for '${browserName}' ` +\n      'because some of them have been already provided');\n    return caps;\n  }\n\n  const {pkg, activity} = this.getChromePkg(browserName);\n  caps.appPackage = pkg;\n  caps.appActivity = activity;\n  logger.info(`appPackage/appActivity capabilities have been automatically set to ${pkg}/${activity} ` +\n    `for '${browserName}'`);\n  logger.info(`Consider changing the browserName to the one from the list of supported browser names ` +\n    `or provide custom appPackage/appActivity capability values if the automatically assigned ones do ` +\n    `not make sense`);\n  return caps;\n};\n\n/**\n * Checks whether the current device under test is an emulator\n *\n * @param {ADB} adb - appium-adb instance\n * @param {Object} opts - driver options mapping\n * @returns {boolean} `true` if the device is an Android emulator\n */\nhelpers.isEmulator = function isEmulator (adb, opts) {\n  const possibleNames = [opts.udid, adb?.curDeviceId];\n  return !!opts.avd || possibleNames.some((x) => EMULATOR_PATTERN.test(x));\n};\n\nhelpers.bootstrap = Bootstrap;\nhelpers.unlocker = unlocker;\n\nexport { helpers, SETTINGS_HELPER_PKG_ID, APP_STATE, prepareAvdArgs, ensureNetworkSpeed };\nexport default helpers;\n"],"mappings":"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"}