"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ExecuteMixin = void 0;
const lodash_1 = __importDefault(require("lodash"));
const protocol_1 = require("../../protocol");
/**
 * @template {Constraints} C
 * @param {import('./session').SessionBase<C>} Base
 * @returns {ExecuteBase<C>}
 */
function ExecuteMixin(Base) {
    /**
     * @implements {IExecuteCommands}
     */
    class ExecuteCommands extends Base {
        /**
         * @param {string} script
         * @param {[Record<string, any>]|[]} protoArgs
         */
        async executeMethod(script, protoArgs) {
            const Driver = /** @type {DriverClass} */ (this.constructor);
            const commandMetadata = { ...Driver.executeMethodMap?.[script] };
            if (!commandMetadata.command) {
                const availableScripts = lodash_1.default.keys(Driver.executeMethodMap);
                throw new protocol_1.errors.UnsupportedOperationError(`Unsupported execute method '${script}'. Available methods ` +
                    `are: ${availableScripts.join(', ')}`);
            }
            const args = (0, protocol_1.validateExecuteMethodParams)(protoArgs, commandMetadata.params);
            return await this[commandMetadata.command](...args);
        }
    }
    return ExecuteCommands;
}
exports.ExecuteMixin = ExecuteMixin;
/**
 * @typedef {import('@appium/types').IExecuteCommands} IExecuteCommands
 * @typedef {import('@appium/types').Driver} Driver
 * @typedef {import('@appium/types').DriverClass} DriverClass
 * @typedef {import('@appium/types').Constraints} Constraints
 */
/**
 * @template {Constraints} C
 * @typedef {import('../driver').BaseDriverBase<C, import('@appium/types').ITimeoutCommands & import('@appium/types').IEventCommands & import('@appium/types').IFindCommands & import('@appium/types').ILogCommands<C> & import('@appium/types').ISettingsCommands & import('@appium/types').ISessionCommands & IExecuteCommands>} ExecuteBase
 */
//# sourceMappingURL=execute.js.map